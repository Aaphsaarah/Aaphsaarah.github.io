<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Analysis and Prediction of Heart Disease</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/table1-1.0/table1_defaults.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Author</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Blog
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="blog.html">Waffle Plot!</a>
    </li>
    <li>
      <a href="birthweight.html">Baby birthweight matters!</a>
    </li>
    <li>
      <a href="heart_disease.html">Analysis and Prediction of Heart Disease</a>
    </li>
    <li>
      <a href="IMDB.html">IMDB and TMDB Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="mailto:&lt;apsarah.rahman@gmail.com&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/Aaphsaarah">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/aaphsaarah">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.facebook.com/apsarah.rahman">
    <span class="fa fa-facebook fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/aaphsaarah-rahman/">
    <span class="fa fa-linkedin fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Analysis and Prediction of Heart Disease</h1>

</div>


<div id="author-aaphsaarah-rahman" class="section level4">
<h4><em>Author: Aaphsaarah Rahman</em></h4>
</div>
<div id="abstract" class="section level2 tabset">
<h2>Abstract</h2>
<p>In the United States, cardiovascular diseases are the leading cause of death in adults. It is the first leading cause of death across the world as well. World Health Organization has estimated that the mortality rate caused by heart diseases will mount to 23 million cases by 2030. Hence, the use of data mining algorithms could be useful in predicting coronary artery diseases. Therefore this research aims to predict whether a person is having cardiovascular disease or not based on their medical tests, age, gender in the selected hospital.</p>
</div>
<div id="objective" class="section level2 tabset">
<h2>Objective</h2>
<p>The objective of this research is to build classifiers to predict whether a person has cardiovascular disease based on their medical test, age, and gender. To identify which test is more reliable in determining cardiovascular disease.</p>
</div>
<div id="method" class="section level2 tabset">
<h2>Method</h2>
<p>Collected patient data from four national hospital. Two from hospital in USA and two from Europe. The data set HD.xlsx includes the patients age, gender, 11 test results, and final diagnosis.</p>
<p>Firstly, extracted the data from excel. There were 4 data tables. Looked through all there summarized data individually and enquired if there was any missing data. There was none.<br />
Secondly categorized all the suitable variables. Then renamed them into suitable meaningful names for better understanding.<br />
Thirdly, produced a correlation plot for each 4 hospitals and evaluated there correlation and association with each other.<br />
Fourth, produced a table with heart diagnosis, with all 5 types. 0 means no heart disease (HD) and increasing numbers (1-4) are the number of major vessels that are greater than 50% diameter narrowing. For better understanding, dichotomized the severity of HD into 2 categories having “No Heart Disease” and “Present Heart Disease.”</p>
<p>Fifth, created a Summary table, which runs t-test and chisq-test for numeric data and categorical data respectively. It summarizes and compares the variables with individuals with heart disease and those who do not have heart disease(dichotomized model). The table is produced for each 4 hospitals and also for combined hospital data as well. The level of significance was 0.05. Any p-value above 0.05 was considered insignificant.</p>
<p>Then, created a visual representation of each categorical and numerical variable grouped with/without heart disease using bar plot and histogram.<br />
Furthermore, made a generalized linear model and calculated there odds ratio with 95% confidence interval, did the model selection process using backward selection. Then finally come to a conclusive dichotomized model for each hospital and combined as well. Also did a GLM with the severity of heart disease as a response variable with overall combined hospital data.<br />
With the GLM build a ROC curve as a graphical presentation for the connection/trade-off between sensitivity and specificity for every possible cut-off for models.</p>
<p>Dataset can be found <a href="HD.xlsx">here</a>.</p>
<pre class="r"><code># library
library(tidyverse)
library(survival)
library(survminer)
library(ggfortify)
library(kableExtra)
library(dotwhisker)
library(data.table)
library(table1)
library(knitr)
library(mlr)
library(gridExtra)
library(compareGroups)
library(readxl)
library(plyr)
library(ggplot2)
library(GGally)
library(flexsurv)
library(corrplot)
library(Hmisc)
library(ggpubr)
library(ROCR)
library(pROC)
library(nnet)

# function to calling all 4 dataset and the dictionary as well.
read_excel_allsheets &lt;- function(filename, tibble = FALSE) {
    # I prefer straight data.frames
    # but if you like tidyverse tibbles (the default with read_excel)
    # then just pass tibble = TRUE
    sheets &lt;- readxl::excel_sheets(filename)
    x &lt;- lapply(sheets, function(X) readxl::read_excel(filename, sheet = X))
    if(!tibble) x &lt;- lapply(x, as.data.frame)
    names(x) &lt;- sheets
    x
}</code></pre>
</div>
<div id="exploratory-data-analysis" class="section level2 tabset">
<h2>Exploratory Data Analysis</h2>
<p>There is no missing data in the dataset. Summary of each hospital is given below.</p>
<div id="data-dictionary" class="section level3">
<h3>Data Dictionary</h3>
<p>‘age’…….Age in years<br />
‘sex’…….1 = Male; 0 = Female<br />
‘cp’……..Chest pain type<br />
………… 1 = Typical angina<br />
………… 2 = Atypical angina<br />
………… 3 = Non-anginal pain<br />
………… 4 = Asymptomatic</p>
<p>‘trestbps’..Resting blood pressure (in mm Hg on admission to the hospital)</p>
<p>‘fbs’…….(Fasting blood sugar &gt; 120 mg/dl) (1 = true; 0 = false)</p>
<p>‘restecg’…Resting electrocardiographic results<br />
………… 0 = Normal<br />
………… 1 = Having ST-T wave abnormality (T wave inversions and/or ST elevation or depression of &gt; 0.05 mV)<br />
………… 2= Showing probable or definite left ventricular hypertrophy by Estes’ criteria</p>
<p>‘thalach’…Maximum heart rate achieved</p>
<p>‘exang’…..Exercise induced angina (1 = yes; 0 = no)</p>
<p>‘oldpeak’…ST depression induced by exercise relative to rest</p>
<p>‘slope’…..Slope of the peak exercise ST segment<br />
………… 1 = upsloping; 2 = flat; 3 = downsloping</p>
<p>‘ca’………Number of major vessels (0-3) colored by flourosopy</p>
<p>‘thal’…….3 = normal; 6 = fixed defect; 7 = reversable defect</p>
<p>‘diag’……0: No presense of heart disease<br />
………… 1-4: Number of major vessels that &gt; 50% diameter narrowing</p>
</div>
<div id="cost-of-tests" class="section level3">
<h3>Cost of tests</h3>
<p>Test Cost<br />
cp……..Immediate results, no additional cost<br />
thestbps..Immediate results, no additional cost<br />
fbs…….$5.20, need one day laboratory work<br />
restecg…$15.50, need one day laboratory work<br />
thalach…$102.90, need one day laboratory work<br />
exang…..$87.30, need one day laboratory work<br />
oldpeak…$87.30, need one day laboratory work<br />
slope…..$87.30, need one day laboratory work<br />
ca……..$100.90, need one day laboratory work<br />
thal……$102.90, need one day laboratory work</p>
</div>
<div id="missing-data" class="section level3">
<h3>Missing Data</h3>
<pre class="r"><code>HD &lt;- read_excel_allsheets(&quot;HD.xlsx&quot;)

# Check missing data
# There is no missing data

U1=colSums(is.na(HD$US1))
U2=colSums(is.na(HD$US2))
E1=colSums(is.na(HD$EU1))
E2=colSums(is.na(HD$EU2))

list(&#39;U1&#39;=U1,&#39;U2&#39;=U2,&#39;E1&#39;=E1,&#39;E2&#39;=E2) %&gt;% knitr::kable(col.names = &quot;HD&quot;, caption =  &#39;Checking for missing data in HD data set&#39;) %&gt;%kable_styling(full_width = F, fixed_thead = T)</code></pre>
<table class="kable_wrapper table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Checking for missing data in HD data set
</caption>
<tbody>
<tr>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HD
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
cp
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
trestbps
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
fbs
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
restecg
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
thalach
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
exang
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
oldpeak
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
slope
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ca
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
thal
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
diag
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HD
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
cp
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
trestbps
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
fbs
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
restecg
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
thalach
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
exang
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
oldpeak
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
slope
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ca
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
thal
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
diag
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HD
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
cp
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
trestbps
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
fbs
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
restecg
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
thalach
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
exang
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
oldpeak
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
slope
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ca
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
thal
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
diag
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HD
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
cp
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
trestbps
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
fbs
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
restecg
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
thalach
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
exang
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
oldpeak
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
slope
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ca
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
thal
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
diag
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<div id="raw-us1" class="section level3">
<h3>RAW US1</h3>
<pre class="r"><code>summarizeColumns(HD$US1) %&gt;% knitr::kable( caption =  &#39;Feature Summary of US1 data before Data Preprocessing&#39;)%&gt;%kable_styling(full_width = F, fixed_thead = T)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Feature Summary of US1 data before Data Preprocessing
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
type
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
na
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
disp
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
median
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mad
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
min
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
max
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
nlevs
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
54.4389439
</td>
<td style="text-align:right;">
9.0386624
</td>
<td style="text-align:right;">
56.0
</td>
<td style="text-align:right;">
8.89560
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
77.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.6798680
</td>
<td style="text-align:right;">
0.4672988
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
cp
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3.1584158
</td>
<td style="text-align:right;">
0.9601256
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
1.48260
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
trestbps
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
131.6897690
</td>
<td style="text-align:right;">
17.5997477
</td>
<td style="text-align:right;">
130.0
</td>
<td style="text-align:right;">
14.82600
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
200.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
fbs
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1485149
</td>
<td style="text-align:right;">
0.3561979
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
restecg
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.9900990
</td>
<td style="text-align:right;">
0.9949713
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1.48260
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
thalach
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
149.6072607
</td>
<td style="text-align:right;">
22.8750033
</td>
<td style="text-align:right;">
153.0
</td>
<td style="text-align:right;">
22.23900
</td>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
202.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
exang
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.3267327
</td>
<td style="text-align:right;">
0.4697945
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
oldpeak
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0396040
</td>
<td style="text-align:right;">
1.1610750
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
1.18608
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6.2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
slope
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.6006601
</td>
<td style="text-align:right;">
0.6162261
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
1.48260
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ca
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.6732673
</td>
<td style="text-align:right;">
0.9431760
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
thal
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.7326733
</td>
<td style="text-align:right;">
1.9372153
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
7.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
diag
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.9372937
</td>
<td style="text-align:right;">
1.2285357
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
<div id="raw-us2" class="section level3">
<h3>Raw US2</h3>
<pre class="r"><code>summarizeColumns(HD$US2) %&gt;% knitr::kable( caption =  &#39;Feature Summary of US2 data before Data Preprocessing&#39;) %&gt;%kable_styling(full_width = F, fixed_thead = T)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Feature Summary of US2 data before Data Preprocessing
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
type
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
na
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
disp
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
median
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mad
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
min
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
max
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
nlevs
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
59.350
</td>
<td style="text-align:right;">
7.8116972
</td>
<td style="text-align:right;">
60.0
</td>
<td style="text-align:right;">
5.93040
</td>
<td style="text-align:right;">
35.0
</td>
<td style="text-align:right;">
77
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.970
</td>
<td style="text-align:right;">
0.1710153
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
cp
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3.505
</td>
<td style="text-align:right;">
0.7957014
</td>
<td style="text-align:right;">
4.0
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
trestbps
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
132.450
</td>
<td style="text-align:right;">
20.7123758
</td>
<td style="text-align:right;">
130.0
</td>
<td style="text-align:right;">
14.82600
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
190
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
fbs
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.340
</td>
<td style="text-align:right;">
0.4748975
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
restecg
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.735
</td>
<td style="text-align:right;">
0.6834549
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1.48260
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
thalach
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
122.360
</td>
<td style="text-align:right;">
22.4519677
</td>
<td style="text-align:right;">
120.0
</td>
<td style="text-align:right;">
24.46290
</td>
<td style="text-align:right;">
69.0
</td>
<td style="text-align:right;">
180
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
exang
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.630
</td>
<td style="text-align:right;">
0.4840159
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
oldpeak
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.216
</td>
<td style="text-align:right;">
1.1050110
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
1.33434
</td>
<td style="text-align:right;">
-0.5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
slope
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2.120
</td>
<td style="text-align:right;">
0.6840612
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ca
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.945
</td>
<td style="text-align:right;">
1.0618913
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1.48260
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
thal
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5.660
</td>
<td style="text-align:right;">
1.8112990
</td>
<td style="text-align:right;">
7.0
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
diag
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.520
</td>
<td style="text-align:right;">
1.2194405
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1.48260
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
<div id="raw-eu1" class="section level3">
<h3>Raw EU1</h3>
<pre class="r"><code>summarizeColumns(HD$EU1) %&gt;% knitr::kable( caption =  &#39;Feature Summary of EU1 data before Data Preprocessing&#39;) %&gt;%kable_styling(full_width = F, fixed_thead = T)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Feature Summary of EU1 data before Data Preprocessing
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
type
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
na
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
disp
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
median
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mad
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
min
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
max
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
nlevs
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
47.8265306
</td>
<td style="text-align:right;">
7.8118124
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
8.1543
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.7244898
</td>
<td style="text-align:right;">
0.4475328
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
cp
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2.9829932
</td>
<td style="text-align:right;">
0.9651168
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1.4826
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
trestbps
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
132.6088435
</td>
<td style="text-align:right;">
17.6017779
</td>
<td style="text-align:right;">
130
</td>
<td style="text-align:right;">
14.8260
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
fbs
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0714286
</td>
<td style="text-align:right;">
0.2579785
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
restecg
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.2210884
</td>
<td style="text-align:right;">
0.4623329
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
thalach
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
139.0306122
</td>
<td style="text-align:right;">
23.6106591
</td>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
23.7216
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
190
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
exang
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.3027211
</td>
<td style="text-align:right;">
0.4602189
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
oldpeak
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5860544
</td>
<td style="text-align:right;">
0.9086479
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
slope
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.6292517
</td>
<td style="text-align:right;">
0.5309160
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ca
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.6122449
</td>
<td style="text-align:right;">
0.9380030
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
thal
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.5578231
</td>
<td style="text-align:right;">
1.8844767
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
diag
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.7925170
</td>
<td style="text-align:right;">
1.2370055
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
<div id="raw-eu2" class="section level3">
<h3>Raw EU2</h3>
<pre class="r"><code>summarizeColumns(HD$EU2) %&gt;% knitr::kable( caption =  &#39;Feature Summary of EU2 data before Data Preprocessing&#39;) %&gt;%kable_styling(full_width = F, fixed_thead = T)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Feature Summary of EU2 data before Data Preprocessing
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
type
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
na
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
disp
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
median
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mad
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
min
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
max
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
nlevs
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
55.3170732
</td>
<td style="text-align:right;">
9.0321076
</td>
<td style="text-align:right;">
56.0
</td>
<td style="text-align:right;">
7.41300
</td>
<td style="text-align:right;">
32.0
</td>
<td style="text-align:right;">
74.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.9186992
</td>
<td style="text-align:right;">
0.2744143
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
cp
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3.6991870
</td>
<td style="text-align:right;">
0.6887261
</td>
<td style="text-align:right;">
4.0
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
4.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
trestbps
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
130.3658537
</td>
<td style="text-align:right;">
22.4901685
</td>
<td style="text-align:right;">
125.0
</td>
<td style="text-align:right;">
22.23900
</td>
<td style="text-align:right;">
80.0
</td>
<td style="text-align:right;">
200.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
fbs
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1138211
</td>
<td style="text-align:right;">
0.3188929
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
restecg
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.3577236
</td>
<td style="text-align:right;">
0.5885531
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
thalach
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
121.1138211
</td>
<td style="text-align:right;">
26.3342958
</td>
<td style="text-align:right;">
121.0
</td>
<td style="text-align:right;">
28.16940
</td>
<td style="text-align:right;">
60.0
</td>
<td style="text-align:right;">
182.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
exang
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.4390244
</td>
<td style="text-align:right;">
0.4982978
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
oldpeak
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.6471545
</td>
<td style="text-align:right;">
1.0611875
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:right;">
0.59304
</td>
<td style="text-align:right;">
-2.6
</td>
<td style="text-align:right;">
3.7
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
slope
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.8048780
</td>
<td style="text-align:right;">
0.6357974
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ca
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0813008
</td>
<td style="text-align:right;">
0.9546564
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1.48260
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
thal
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5.7642276
</td>
<td style="text-align:right;">
1.7181829
</td>
<td style="text-align:right;">
7.0
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
7.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
diag
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.8048780
</td>
<td style="text-align:right;">
1.0135034
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
1.48260
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
4.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>#categorizing suitable variable and changed there column names into suitable names for further data analysis.


HD$US1$sex= as.factor(HD$US1$sex)
HD$US1$cp= as.factor(HD$US1$cp)
HD$US1$fbs= as.factor(HD$US1$fbs)
HD$US1$restecg= as.factor(HD$US1$restecg)
HD$US1$exang= as.factor(HD$US1$exang)
HD$US1$slope= as.factor(HD$US1$slope)
HD$US1$thal = as.factor(HD$US1$thal)
HD$US1$diag = as.factor(HD$US1$diag)
HD$US1$ca = as.factor(HD$US1$ca)


HD$US2$sex= as.factor(HD$US2$sex)
HD$US2$cp= as.factor(HD$US2$cp)
HD$US2$fbs= as.factor(HD$US2$fbs)
HD$US2$restecg= as.factor(HD$US2$restecg)
HD$US2$exang= as.factor(HD$US2$exang)
HD$US2$slope= as.factor(HD$US2$slope)
HD$US2$thal = as.factor(HD$US2$thal)
HD$US2$diag = as.factor(HD$US2$diag)
HD$US2$ca = as.factor(HD$US2$ca)




HD$EU1$sex= as.factor(HD$EU1$sex)
HD$EU1$cp= as.factor(HD$EU1$cp)
HD$EU1$fbs= as.factor(HD$EU1$fbs)
HD$EU1$restecg= as.factor(HD$EU1$restecg)
HD$EU1$exang= as.factor(HD$EU1$exang)
HD$EU1$slope= as.factor(HD$EU1$slope)
HD$EU1$thal = as.factor(HD$EU1$thal)
HD$EU1$diag = as.factor(HD$EU1$diag)
HD$EU1$ca = as.factor(HD$EU1$ca)


HD$EU2$sex= as.factor(HD$EU2$sex)
HD$EU2$cp= as.factor(HD$EU2$cp)
HD$EU2$fbs= as.factor(HD$EU2$fbs)
HD$EU2$restecg= as.factor(HD$EU2$restecg)
HD$EU2$exang= as.factor(HD$EU2$exang)
HD$EU2$slope= as.factor(HD$EU2$slope)
HD$EU2$thal = as.factor(HD$EU2$thal)
HD$EU2$diag = as.factor(HD$EU2$diag)
HD$EU2$ca = as.factor(HD$EU2$ca)



# Rename two variable names
colnames(HD$US1)[colnames(HD$US1)      
                   %in% c(&quot;age&quot;, &quot;sex&quot;,&quot;cp&quot;,&quot;trestbps&quot;,&quot;fbs&quot;,&quot;restecg&quot;,&quot;thalach&quot;,&quot;exang&quot;, &quot;oldpeak&quot;,&quot;slope&quot;,&quot;ca&quot;,&quot;thal&quot;,&quot;diag&quot; )] &lt;- c(&quot;Age&quot;, &quot;Sex&quot;,&quot;Chest_Pain_Type&quot;,
&quot;Resting_Blood_Pressure&quot;,&quot;Fasting_Blood_Sugar&quot;,&quot;Resting_ECG&quot;, &quot;Max_Heart_Rate_Achieved&quot;, &quot;Exercise_Induced_Angina&quot;,
 &quot;ST_Depression_Exercise&quot;,&quot;Slope_Peak_Exercise_ST&quot;, &quot;Num_Major_Vessels&quot;, &quot;Thalassemia&quot;, &quot;Diagnosis&quot;)


colnames(HD$US2)[colnames(HD$US2)      
                   %in% c(&quot;age&quot;, &quot;sex&quot;,&quot;cp&quot;,&quot;trestbps&quot;,&quot;fbs&quot;,&quot;restecg&quot;,&quot;thalach&quot;,&quot;exang&quot;, &quot;oldpeak&quot;,&quot;slope&quot;,&quot;ca&quot;,&quot;thal&quot;,&quot;diag&quot; )] &lt;- c(&quot;Age&quot;, &quot;Sex&quot;,&quot;Chest_Pain_Type&quot;,
&quot;Resting_Blood_Pressure&quot;,&quot;Fasting_Blood_Sugar&quot;,&quot;Resting_ECG&quot;, &quot;Max_Heart_Rate_Achieved&quot;, &quot;Exercise_Induced_Angina&quot;,
 &quot;ST_Depression_Exercise&quot;,&quot;Slope_Peak_Exercise_ST&quot;, &quot;Num_Major_Vessels&quot;, &quot;Thalassemia&quot;, &quot;Diagnosis&quot;)


colnames(HD$EU1)[colnames(HD$EU1)      
                   %in% c(&quot;age&quot;, &quot;sex&quot;,&quot;cp&quot;,&quot;trestbps&quot;,&quot;fbs&quot;,&quot;restecg&quot;,&quot;thalach&quot;,&quot;exang&quot;, &quot;oldpeak&quot;,&quot;slope&quot;,&quot;ca&quot;,&quot;thal&quot;,&quot;diag&quot; )] &lt;- c(&quot;Age&quot;, &quot;Sex&quot;,&quot;Chest_Pain_Type&quot;,
&quot;Resting_Blood_Pressure&quot;,&quot;Fasting_Blood_Sugar&quot;,&quot;Resting_ECG&quot;, &quot;Max_Heart_Rate_Achieved&quot;, &quot;Exercise_Induced_Angina&quot;,
 &quot;ST_Depression_Exercise&quot;,&quot;Slope_Peak_Exercise_ST&quot;, &quot;Num_Major_Vessels&quot;, &quot;Thalassemia&quot;, &quot;Diagnosis&quot;)


colnames(HD$EU2)[colnames(HD$EU2)      
                   %in% c(&quot;age&quot;, &quot;sex&quot;,&quot;cp&quot;,&quot;trestbps&quot;,&quot;fbs&quot;,&quot;restecg&quot;,&quot;thalach&quot;,&quot;exang&quot;, &quot;oldpeak&quot;,&quot;slope&quot;,&quot;ca&quot;,&quot;thal&quot;,&quot;diag&quot; )] &lt;- c(&quot;Age&quot;, &quot;Sex&quot;,&quot;Chest_Pain_Type&quot;,
&quot;Resting_Blood_Pressure&quot;,&quot;Fasting_Blood_Sugar&quot;,&quot;Resting_ECG&quot;, &quot;Max_Heart_Rate_Achieved&quot;, &quot;Exercise_Induced_Angina&quot;,
 &quot;ST_Depression_Exercise&quot;,&quot;Slope_Peak_Exercise_ST&quot;, &quot;Num_Major_Vessels&quot;, &quot;Thalassemia&quot;, &quot;Diagnosis&quot;)

HD_all&lt;-  rbind(HD$US1,HD$US2,HD$EU1,HD$EU2)
#head(HD)
#head(HD$US1)</code></pre>
</div>
</div>
<div id="tables-of-diagnosis" class="section level2 tabset">
<h2>Tables of Diagnosis</h2>
<p>In diagnosis:-<br />
0: No presense of heart disease<br />
1-4: Number of major vessels that &gt; 50% diameter narrowing<br />
The modified table is the dicotomized version. These tables showes the no. of patients with there severity in heart disease</p>
<div id="raw-data-hd" class="section level3">
<h3>Raw data HD</h3>
<p>US1 and EU1 has most patients. US1 has most patients with heart disease. EU2 has smallest no. of patients with small amount of patients with heart disease. Lower no. of patients have 4 major vessels &gt; 50% diameter narrowing.</p>
<pre class="r"><code>a=addmargins(table(US1 = HD$US1$Diagnosis)) 

b=addmargins(table(US2= HD$US2$Diagnosis))

c=addmargins(table(EU1= HD$EU1$Diagnosis))

d=addmargins(table(EU2 = HD$EU2$Diagnosis))

a1= addmargins(table(All = HD_all$Diagnosis))

list(a,b,c,d, a1) %&gt;% kable(caption = &#39;Frequency of Heart Disease in All Hospital(raw data)&#39;)%&gt;%
  kable_styling(full_width = F, fixed_thead = T)</code></pre>
<table class="kable_wrapper table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Frequency of Heart Disease in All Hospital(raw data)
</caption>
<tbody>
<tr>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
US1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
164
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
55
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
36
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
35
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
13
</td>
</tr>
<tr>
<td style="text-align:left;">
Sum
</td>
<td style="text-align:right;">
303
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
US2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
51
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
56
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
41
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
42
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
Sum
</td>
<td style="text-align:right;">
200
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
EU1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
188
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
37
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
26
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
28
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
Sum
</td>
<td style="text-align:right;">
294
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
EU2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
48
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
32
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
30
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
Sum
</td>
<td style="text-align:right;">
123
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
All
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
411
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
196
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
135
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
135
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
43
</td>
</tr>
<tr>
<td style="text-align:left;">
Sum
</td>
<td style="text-align:right;">
920
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<div id="modified-hd" class="section level3">
<h3>Modified HD</h3>
<p>This gives us a better visualization of people with and without heart disease in each hospital.<br />
Hospital US1, EU1 have higher no. of patients with no heart disease as diagnosis.<br />
Hoepital US2, EU2 have higher no. of patients with heart disease as diagnosis comparatively.<br />
Overall patients coming to hospital are diagnosed with having heart disease.</p>
<pre class="r"><code>#converting heart diagnosis above 0 into 1, as 0 means heart disease absent and above 0 means present.
# Hospital us2,su2 is in bad position.
HD$US1$diag_hd =mapvalues(HD$US1$Diagnosis, from = c(0,1,2,3,4), to = c(0,1,1,1,1))
e=addmargins(table(US1= HD$US1$diag_hd)) 

HD$US2$diag_hd =mapvalues(HD$US2$Diagnosis, from = c(0,1,2,3,4), to = c(0,1,1,1,1))
f=addmargins(table(US2= HD$US2$diag_hd)) 

HD$EU1$diag_hd =mapvalues(HD$EU1$Diagnosis, from = c(0,1,2,3,4), to = c(0,1,1,1,1))
g=addmargins(table(EU1= HD$EU1$diag_hd))

    
HD$EU2$diag_hd =mapvalues(HD$EU2$Diagnosis, from = c(0,1,2,3,4), to = c(0,1,1,1,1))
h=addmargins(table(EU2= HD$EU2$diag_hd)) 

HD_all$diag_hd =mapvalues(HD_all$Diagnosis, from = c(0,1,2,3,4), to = c(0,1,1,1,1))
a2= addmargins(table(All= HD_all$diag_hd)) 

list(e,f,g,h, a2) %&gt;% kable(caption = &#39;Frequency of Heart Disease in All Hospital (binary)&#39;)%&gt;%
  kable_styling(full_width = F, fixed_thead = T)</code></pre>
<table class="kable_wrapper table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Frequency of Heart Disease in All Hospital (binary)
</caption>
<tbody>
<tr>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
US1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
164
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
139
</td>
</tr>
<tr>
<td style="text-align:left;">
Sum
</td>
<td style="text-align:right;">
303
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
US2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
51
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
149
</td>
</tr>
<tr>
<td style="text-align:left;">
Sum
</td>
<td style="text-align:right;">
200
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
EU1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
188
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
106
</td>
</tr>
<tr>
<td style="text-align:left;">
Sum
</td>
<td style="text-align:right;">
294
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
EU2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
115
</td>
</tr>
<tr>
<td style="text-align:left;">
Sum
</td>
<td style="text-align:right;">
123
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
All
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
411
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
509
</td>
</tr>
<tr>
<td style="text-align:left;">
Sum
</td>
<td style="text-align:right;">
920
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="corrolation-plot" class="section level2 tabset">
<h2>Corrolation plot</h2>
<p>This plots gives the visual representation of corrolation. Higher the magnitude stronger the relation / corrolation.</p>
<div id="us1" class="section level3">
<h3>US1</h3>
<p>Corrplot suggest there is a strong association between-<br />
Diagnosis -thal<br />
Diagnosis -ca<br />
Diagnosis -oldpeak<br />
slope -oldpeak</p>
<pre class="r"><code>HD1 &lt;- read_excel_allsheets(&quot;HD.xlsx&quot;)


ggcorr(HD1$US1, method = c(&quot;everything&quot;, &quot;pearson&quot;), nbreaks = 6, label = TRUE) </code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="us2" class="section level3">
<h3>US2</h3>
<p>There is strong correlation between-<br />
Diag-thal<br />
Diag- ca<br />
Diag-oldpeak<br />
Diag- exang</p>
<pre class="r"><code>ggcorr(HD1$US2, method = c(&quot;everything&quot;, &quot;pearson&quot;), nbreaks = 6,  label = TRUE,  label_color = &quot;white&quot;)</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="eu1" class="section level3">
<h3>EU1</h3>
<p>There is strong correlation between-<br />
Diag-thal<br />
Diag-ca<br />
Diag-oldpeak<br />
Diag-exang<br />
Oldpeak-exang<br />
Exang-cp<br />
Thalach-age</p>
<pre class="r"><code>ggcorr(HD1$EU1, method = c(&quot;everything&quot;, &quot;pearson&quot;), nbreaks = 6,  label = TRUE, label_color = &quot;white&quot;)</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="eu2" class="section level3">
<h3>EU2</h3>
<p>Here the corrolation is bit different from other hospitals<br />
There is strong correlation only between-<br />
Diag-ca<br />
Diag-fbs</p>
<pre class="r"><code>#ggpairs(HD1$EU2, upper = list(continuous = wrap(&quot;cor&quot;, size=2.5))) + theme_bw()  

ggcorr(HD1$EU2, method = c(&quot;everything&quot;, &quot;pearson&quot;), nbreaks = 6, label = TRUE, label_size = 3, label_color = &quot;white&quot;)</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="all" class="section level3">
<h3>All</h3>
<p>Overall Diag with thal, ca, oldpeak are strongly correlated.</p>
<pre class="r"><code>HD1_all&lt;-  rbind(HD1$US1,HD1$US2,HD1$EU1,HD1$EU2)

ggcorr(HD1_all, method = c(&quot;everything&quot;, &quot;pearson&quot;), nbreaks = 6,  label = TRUE, label_color = &quot;white&quot;)</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="summary-tables" class="section level2 tabset">
<h2>Summary tables</h2>
<p>Carried t-test with numeric variables and chisq test with the categorical variable.<br />
Dichotomized the heart diagnosis to present and absent and carried the test. Results show that except in a few hospitals, the majority of them have shown fasting blood sugar, resting ECG are an insignificant test.</p>
<p>Similarity among heart disease patients are:- • Most of them were male.<br />
• Aged between 49 to 60.<br />
• Have asymptomatic chest pain. • The fasting glucose test was irrelevant. • Resting ECG test also seemed insignificant. • Most of them had exercise-induced angina present (absent in non-HD patients ).<br />
• They got ‘Flat’ slope in ST-segment exercises but in a few hospitals, it seemed not significant. (have mixed result of non-HD patient)<br />
• Most of the patients with HD get ‘reversible defect’ in the Thalassemia test.<br />
• Have high blood pressure around (mean)134 bp. Non-HD have lower bp comparatively.<br />
• There mas heart rate achieved on the Thallium stress test is around 127(mean, SD=24.1). It’s usually much lower than non-HD patients. • They have higher results (mean =1.26) in ST depression exercise compared to non-HD patients. It’s usually higher than 1 unit. • Colored vessel by fluoroscopy test is significant, if the patient has heart disease then 70% of the time it will be found through this. Only 30% of heart disease did not have colored vessels in the test.</p>
<div id="us1-1" class="section level3">
<h3>US1</h3>
<p>In US1 hospital patient with heart disease are comparatively older with median age=58, mostly male seems to higher chance in having it, most common chest pain is asymptomatiic (75% common). Most of the time patient tend to have LV hypertrophy 58% or normal ECG 40% in there resting ECG test as result. Exercise Induced Angina is significant but ‘no’, ‘yes’ outcome is similar, 45% and 55% respectively. Cannot predect heart disease through Exercise Induced Angina. In Slope Peak Exercise 65% of them get Flat. 64% of the patiens get reversible defect in Thalassemia test. Mean of Resting_Blood_Pressure is 135 among them. Mean of Max_Heart_Rate_Achieved is 139. Mean of ST depression induced by exercise relative to rest is 1.57.</p>
<p>And patient with <strong>no heart disease</strong> are younger, have similar distribution in gender, 43% female, 56% male. Most common chesst pain among them is non-aniginal pain. Although atypical and asymptomatic are also seen in them. Patient get normal ECG in there diagnose around 58% of the times. 64% get upsloping in Slope Peak Exercisetest. 79% get normal in Thalassemia test. Mean of Resting_Blood_Pressure is 129 among them. Mean of Max_Heart_Rate_Achieved is 158. Most patients get 0 major vesseled coloured. Mean of ST depression induced by exercise relative to rest is 0.59.</p>
<p>Fasting blood sugar is not a significant measure of heart disease, as p-value&gt;0.05. If the patient have heart disease the Exercise engina test ie not suitable as its outcome is not differential from non heart patient.. Here mostly all the test is recomended here except Fasting blood sugar.</p>
<pre class="r"><code>table_names&lt;- HD$US1  %&gt;%
  select(Sex,
         Chest_Pain_Type,
         Fasting_Blood_Sugar,
         Resting_ECG,
         Exercise_Induced_Angina,
         Slope_Peak_Exercise_ST,
         Thalassemia,
         Age,
         Resting_Blood_Pressure,
         Max_Heart_Rate_Achieved,
         ST_Depression_Exercise,
         Num_Major_Vessels,
         diag_hd) %&gt;%
  mutate(Sex = recode_factor(Sex, `0` = &quot;female&quot;, 
                                  `1` = &quot;male&quot; ),
         Chest_Pain_Type = recode_factor(Chest_Pain_Type, `1` = &quot;typical angina&quot;,   
                                                          `2` = &quot;atypical angina&quot;,
                                                          `3` = &quot;non-anginal pain&quot;, 
                                                          `4` = &quot;asymptomatic&quot;),
         Fasting_Blood_Sugar = recode_factor(Fasting_Blood_Sugar, `0` = &quot;&lt;= 120 mg/dl&quot;, 
                                                                  `1` = &quot;&gt; 120 mg/dl&quot;),
         Resting_ECG = recode_factor(Resting_ECG, `0` = &quot;normal&quot;,
                                                  `1` = &quot;ST-T abnormality&quot;,
                                                  `2` = &quot;LV hypertrophy&quot;),
         Exercise_Induced_Angina = recode_factor(Exercise_Induced_Angina, `0` = &quot;no&quot;,
                                                                          `1` = &quot;yes&quot;),
         Slope_Peak_Exercise_ST = recode_factor(Slope_Peak_Exercise_ST, `1` = &quot;up sloping&quot;,
                                                                            `2` = &quot;flat&quot;,
                                                                            `3` = &quot;down sloping&quot;),
         Thalassemia = recode_factor(Thalassemia, `3` = &quot;normal&quot;,
                                                  `6` = &quot;fixed defect&quot;,
                                                  `7` = &quot;reversible defect&quot;) ,
         diag_hd = ifelse(is.na(diag_hd), NA,
                        ifelse(diag_hd == 1, &quot;Heart disease&quot;,
                               ifelse(diag_hd == 0, &quot;No Heart disease&quot;, &quot;error&quot;))) %&gt;%
           factor(levels = c(&quot;Heart disease&quot;, &quot;No Heart disease&quot;, &quot;P-value&quot;)))


rndr &lt;- function(x, name, ...) {
    if (length(x) == 0) {
        y &lt;- table_names[[name]]
        s &lt;- rep(&quot;&quot;, length(render.default(x=y, name=name, ...)))
        if (is.numeric(y)) {
            p &lt;- t.test(y ~ table_names$diag_hd)$p.value
        } else {
            p &lt;- chisq.test(table(y, droplevels(table_names$diag_hd)))$p.value
        }
        s[2] &lt;- sub(&quot;&lt;&quot;, &quot;&amp;lt;&quot;, format.pval(p, digits=3, eps=0.001))
        s
    } else {
        render.default(x=x, name=name, ...)
    }
}


rndr.strat &lt;- function(label, n, ...) {
    ifelse(n==0, label, render.strat.default(label, n, ...))
}
table1(~ Age+
         
         Sex+
         Chest_Pain_Type+
         Fasting_Blood_Sugar+
         Resting_ECG+
         Exercise_Induced_Angina+
         Slope_Peak_Exercise_ST+
         Thalassemia+
         Resting_Blood_Pressure+
         Max_Heart_Rate_Achieved+
         ST_Depression_Exercise+
         Num_Major_Vessels|diag_hd, 
       data = table_names,
       droplevels = F,
       render = rndr,
       render.strat = rndr.strat,
       overall = F)</code></pre>
<div class="Rtable1"><table class="Rtable1">
<thead>
<tr>
<th class='rowlabel firstrow lastrow'></th>
<th class='firstrow lastrow'><span class='stratlabel'>Heart disease<br><span class='stratn'>(N=139)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>No Heart disease<br><span class='stratn'>(N=164)</span></span></th>
<th class='firstrow lastrow'>P-value</th>
</tr>
</thead>
<tbody>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Age</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>56.6 (7.94)</td>
<td>52.6 (9.51)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>58.0 [35.0, 77.0]</td>
<td class='lastrow'>52.0 [29.0, 76.0]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Sex</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>female</td>
<td>25 (18.0%)</td>
<td>72 (43.9%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>male</td>
<td class='lastrow'>114 (82.0%)</td>
<td class='lastrow'>92 (56.1%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Chest_Pain_Type</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>typical angina</td>
<td>7 (5.0%)</td>
<td>16 (9.8%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel'>atypical angina</td>
<td>9 (6.5%)</td>
<td>41 (25.0%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel'>non-anginal pain</td>
<td>18 (12.9%)</td>
<td>68 (41.5%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>asymptomatic</td>
<td class='lastrow'>105 (75.5%)</td>
<td class='lastrow'>39 (23.8%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Fasting_Blood_Sugar</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'><= 120 mg/dl</td>
<td>117 (84.2%)</td>
<td>141 (86.0%)</td>
<td>0.781</td>
</tr>
<tr>
<td class='rowlabel lastrow'>> 120 mg/dl</td>
<td class='lastrow'>22 (15.8%)</td>
<td class='lastrow'>23 (14.0%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Resting_ECG</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>normal</td>
<td>56 (40.3%)</td>
<td>95 (57.9%)</td>
<td>0.007</td>
</tr>
<tr>
<td class='rowlabel'>ST-T abnormality</td>
<td>3 (2.2%)</td>
<td>1 (0.6%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>LV hypertrophy</td>
<td class='lastrow'>80 (57.6%)</td>
<td class='lastrow'>68 (41.5%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Exercise_Induced_Angina</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>no</td>
<td>63 (45.3%)</td>
<td>141 (86.0%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>yes</td>
<td class='lastrow'>76 (54.7%)</td>
<td class='lastrow'>23 (14.0%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Slope_Peak_Exercise_ST</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>up sloping</td>
<td>36 (25.9%)</td>
<td>106 (64.6%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel'>flat</td>
<td>91 (65.5%)</td>
<td>49 (29.9%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>down sloping</td>
<td class='lastrow'>12 (8.6%)</td>
<td class='lastrow'>9 (5.5%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Thalassemia</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>normal</td>
<td>37 (26.6%)</td>
<td>130 (79.3%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel'>fixed defect</td>
<td>13 (9.4%)</td>
<td>6 (3.7%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>reversible defect</td>
<td class='lastrow'>89 (64.0%)</td>
<td class='lastrow'>28 (17.1%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Resting_Blood_Pressure</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>135 (18.8)</td>
<td>129 (16.2)</td>
<td>0.009</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>130 [100, 200]</td>
<td class='lastrow'>130 [94.0, 180]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Max_Heart_Rate_Achieved</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>139 (22.6)</td>
<td>158 (19.2)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>142 [71.0, 195]</td>
<td class='lastrow'>161 [96.0, 202]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>ST_Depression_Exercise</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>1.57 (1.30)</td>
<td>0.587 (0.782)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>1.40 [0, 6.20]</td>
<td class='lastrow'>0.200 [0, 4.20]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Num_Major_Vessels</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>0</td>
<td>46 (33.1%)</td>
<td>133 (81.1%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel'>1</td>
<td>44 (31.7%)</td>
<td>21 (12.8%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel'>2</td>
<td>31 (22.3%)</td>
<td>7 (4.3%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>3</td>
<td class='lastrow'>18 (12.9%)</td>
<td class='lastrow'>3 (1.8%)</td>
<td class='lastrow'></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="us2-1" class="section level3">
<h3>US2</h3>
<p>For patients in hospital US2 with <strong>heart diesease</strong> tend to be older having mean of 60 years old, who are mostly male. The most common chest pain among them is asymptomatic 72% of then have it. Exercise induced angina is present among most of them. 71% of then have reversible defect in Thalassemia test. There mean Resting Blood Pressure is 134. Mean of ST depression induced by exercise relative to rest is 1.43.</p>
<p>Test like chest pain, exercise induced angina, Thalassemia, (Oldpeak)= ST depression induced by exercise are fesible to test and predict heart disease.</p>
<p>Here Gender, Fasting Blood Sugar test, Resting ECG, Exercise ST segment, Thalach test(Thallium stress test) are not significant in this model.</p>
<pre class="r"><code>table_names&lt;- HD$US2 %&gt;%
  select(Sex,
         Chest_Pain_Type,
         Fasting_Blood_Sugar,
         Resting_ECG,
         Exercise_Induced_Angina,
         Slope_Peak_Exercise_ST,
         Thalassemia,
         Age,
         Resting_Blood_Pressure,
         Max_Heart_Rate_Achieved,
         ST_Depression_Exercise,
         Num_Major_Vessels,
         diag_hd) %&gt;%
  mutate(Sex = recode_factor(Sex, `0` = &quot;female&quot;, 
                                  `1` = &quot;male&quot; ),
         Chest_Pain_Type = recode_factor(Chest_Pain_Type, `1` = &quot;typical angina&quot;,   
                                                          `2` = &quot;atypical angina&quot;,
                                                          `3` = &quot;non-anginal pain&quot;, 
                                                          `4` = &quot;asymptomatic&quot;),
         Fasting_Blood_Sugar = recode_factor(Fasting_Blood_Sugar, `0` = &quot;&lt;= 120 mg/dl&quot;, 
                                                                  `1` = &quot;&gt; 120 mg/dl&quot;),
         Resting_ECG = recode_factor(Resting_ECG, `0` = &quot;normal&quot;,
                                                  `1` = &quot;ST-T abnormality&quot;,
                                                  `2` = &quot;LV hypertrophy&quot;),
         Exercise_Induced_Angina = recode_factor(Exercise_Induced_Angina, `0` = &quot;no&quot;,
                                                                          `1` = &quot;yes&quot;),
         
         Slope_Peak_Exercise_ST = recode_factor(Slope_Peak_Exercise_ST, `1` = &quot;up sloping&quot;,
                                                                        `2` = &quot;flat&quot;,
                                                                        `3` = &quot;down sloping&quot;),
         Thalassemia = recode_factor(Thalassemia, `3` = &quot;normal&quot;,
                                                  `6` = &quot;fixed defect&quot;,
                                                  `7` = &quot;reversible defect&quot;) ,
         diag_hd = ifelse(is.na(diag_hd), NA,
                        ifelse(diag_hd == 1, &quot;Heart disease&quot;,
                               ifelse(diag_hd == 0, &quot;No Heart disease&quot;, &quot;error&quot;))) %&gt;%
           factor(levels = c(&quot;Heart disease&quot;, &quot;No Heart disease&quot;, &quot;P-value&quot;)))


table1(~ Age+
         Sex+
         Chest_Pain_Type+
         Fasting_Blood_Sugar+
         Resting_ECG+
         Exercise_Induced_Angina+
         Slope_Peak_Exercise_ST+
         Thalassemia+
         Resting_Blood_Pressure+
         Max_Heart_Rate_Achieved+
         ST_Depression_Exercise+
         Num_Major_Vessels|diag_hd, 
       data = table_names,
       droplevels = F,
       render = rndr,
       render.strat = rndr.strat,
       overall = F)</code></pre>
<div class="Rtable1"><table class="Rtable1">
<thead>
<tr>
<th class='rowlabel firstrow lastrow'></th>
<th class='firstrow lastrow'><span class='stratlabel'>Heart disease<br><span class='stratn'>(N=149)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>No Heart disease<br><span class='stratn'>(N=51)</span></span></th>
<th class='firstrow lastrow'>P-value</th>
</tr>
</thead>
<tbody>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Age</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>60.2 (7.17)</td>
<td>56.8 (9.05)</td>
<td>0.018</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>60.0 [38.0, 77.0]</td>
<td class='lastrow'>58.0 [35.0, 75.0]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Sex</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>female</td>
<td>3 (2.0%)</td>
<td>3 (5.9%)</td>
<td>0.356</td>
</tr>
<tr>
<td class='rowlabel lastrow'>male</td>
<td class='lastrow'>146 (98.0%)</td>
<td class='lastrow'>48 (94.1%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Chest_Pain_Type</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>typical angina</td>
<td>5 (3.4%)</td>
<td>3 (5.9%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel'>atypical angina</td>
<td>5 (3.4%)</td>
<td>9 (17.6%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel'>non-anginal pain</td>
<td>31 (20.8%)</td>
<td>16 (31.4%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>asymptomatic</td>
<td class='lastrow'>108 (72.5%)</td>
<td class='lastrow'>23 (45.1%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Fasting_Blood_Sugar</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'><= 120 mg/dl</td>
<td>95 (63.8%)</td>
<td>37 (72.5%)</td>
<td>0.331</td>
</tr>
<tr>
<td class='rowlabel lastrow'>> 120 mg/dl</td>
<td class='lastrow'>54 (36.2%)</td>
<td class='lastrow'>14 (27.5%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Resting_ECG</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>normal</td>
<td>62 (41.6%)</td>
<td>18 (35.3%)</td>
<td>0.699</td>
</tr>
<tr>
<td class='rowlabel'>ST-T abnormality</td>
<td>68 (45.6%)</td>
<td>25 (49.0%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>LV hypertrophy</td>
<td class='lastrow'>19 (12.8%)</td>
<td class='lastrow'>8 (15.7%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Exercise_Induced_Angina</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>no</td>
<td>41 (27.5%)</td>
<td>33 (64.7%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>yes</td>
<td class='lastrow'>108 (72.5%)</td>
<td class='lastrow'>18 (35.3%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Slope_Peak_Exercise_ST</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>up sloping</td>
<td>29 (19.5%)</td>
<td>7 (13.7%)</td>
<td>0.337</td>
</tr>
<tr>
<td class='rowlabel'>flat</td>
<td>73 (49.0%)</td>
<td>31 (60.8%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>down sloping</td>
<td class='lastrow'>47 (31.5%)</td>
<td class='lastrow'>13 (25.5%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Thalassemia</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>normal</td>
<td>28 (18.8%)</td>
<td>34 (66.7%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel'>fixed defect</td>
<td>15 (10.1%)</td>
<td>5 (9.8%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>reversible defect</td>
<td class='lastrow'>106 (71.1%)</td>
<td class='lastrow'>12 (23.5%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Resting_Blood_Pressure</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>134 (21.7)</td>
<td>128 (17.0)</td>
<td>0.035</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>130 [0, 190]</td>
<td class='lastrow'>126 [100, 180]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Max_Heart_Rate_Achieved</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>121 (20.4)</td>
<td>125 (27.5)</td>
<td>0.358</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>120 [73.0, 180]</td>
<td class='lastrow'>120 [69.0, 180]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>ST_Depression_Exercise</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>1.43 (1.09)</td>
<td>0.594 (0.891)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>1.50 [0, 4.00]</td>
<td class='lastrow'>0 [-0.500, 3.00]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Num_Major_Vessels</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>0</td>
<td>52 (34.9%)</td>
<td>42 (82.4%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel'>1</td>
<td>44 (29.5%)</td>
<td>3 (5.9%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel'>2</td>
<td>33 (22.1%)</td>
<td>2 (3.9%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>3</td>
<td class='lastrow'>20 (13.4%)</td>
<td class='lastrow'>4 (7.8%)</td>
<td class='lastrow'></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="eu1-1" class="section level3">
<h3>EU1</h3>
<p>In EU1 hospital middle aged men tend to get heart disease. Popular chest pain in asymptomatic around 78% of them have it. Most of them do not ave diabetes. Have excercise induced angina. In ST segment exsrcise most of them get Flat slope. Have reversible defect in Thalassemia test. Have normal blood pressure. Max_Heart_Rate_Achieved from thallium stress test is 129. Patient with no heart disease have higher value of 145.ST depression induced exercise test gives a mean of 1.25.</p>
<p>Patients withou heart disease get zero magor vessel colored by flourosopy test, have 0.21 in STdepression exercise test. Have higher heart rate in thallium stress test</p>
<p>Here only Resting ECG test seems insignificant.</p>
<pre class="r"><code>table_names&lt;- HD$EU1  %&gt;%
  select(Sex,
         Chest_Pain_Type,
         Fasting_Blood_Sugar,
         Resting_ECG,
         Exercise_Induced_Angina,
         Slope_Peak_Exercise_ST,
         Thalassemia,
         Age,
         Resting_Blood_Pressure,
         Max_Heart_Rate_Achieved,
         ST_Depression_Exercise,
         Num_Major_Vessels,
         diag_hd) %&gt;%
  mutate(Sex = recode_factor(Sex, `0` = &quot;female&quot;, 
                                  `1` = &quot;male&quot; ),
         Chest_Pain_Type = recode_factor(Chest_Pain_Type, `1` = &quot;typical angina&quot;,   
                                                          `2` = &quot;atypical angina&quot;,
                                                          `3` = &quot;non-anginal pain&quot;, 
                                                          `4` = &quot;asymptomatic&quot;),
         Fasting_Blood_Sugar = recode_factor(Fasting_Blood_Sugar, `0` = &quot;&lt;= 120 mg/dl&quot;, 
                                                                  `1` = &quot;&gt; 120 mg/dl&quot;),
         Resting_ECG = recode_factor(Resting_ECG, `0` = &quot;normal&quot;,
                                                  `1` = &quot;ST-T abnormality&quot;,
                                                  `2` = &quot;LV hypertrophy&quot;),
         Exercise_Induced_Angina = recode_factor(Exercise_Induced_Angina, `0` = &quot;no&quot;,
                                                                          `1` = &quot;yes&quot;),
         Slope_Peak_Exercise_ST = recode_factor(Slope_Peak_Exercise_ST, `1` = &quot;up sloping&quot;,
                                                                            `2` = &quot;flat&quot;,
                                                                            `3` = &quot;down sloping&quot;),
         Thalassemia = recode_factor(Thalassemia, `3` = &quot;normal&quot;,
                                                  `6` = &quot;fixed defect&quot;,
                                                  `7` = &quot;reversible defect&quot;) ,
         diag_hd = ifelse(is.na(diag_hd), NA,
                        ifelse(diag_hd == 1, &quot;Heart disease&quot;,
                               ifelse(diag_hd == 0, &quot;No Heart disease&quot;, &quot;error&quot;))) %&gt;%
           factor(levels = c(&quot;Heart disease&quot;, &quot;No Heart disease&quot;, &quot;P-value&quot;)))


table1(~ Age+
         Sex+
         Chest_Pain_Type+
         Fasting_Blood_Sugar+
         Resting_ECG+
         Exercise_Induced_Angina+
         Slope_Peak_Exercise_ST+
         Thalassemia+
         Resting_Blood_Pressure+
         Max_Heart_Rate_Achieved+
         ST_Depression_Exercise+
         Num_Major_Vessels|diag_hd, 
       data = table_names,
       droplevels = F,
       render = rndr,
       render.strat = rndr.strat,
       overall = F)</code></pre>
<div class="Rtable1"><table class="Rtable1">
<thead>
<tr>
<th class='rowlabel firstrow lastrow'></th>
<th class='firstrow lastrow'><span class='stratlabel'>Heart disease<br><span class='stratn'>(N=106)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>No Heart disease<br><span class='stratn'>(N=188)</span></span></th>
<th class='firstrow lastrow'>P-value</th>
</tr>
</thead>
<tbody>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Age</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>49.5 (7.49)</td>
<td>46.9 (7.85)</td>
<td>0.006</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>50.0 [31.0, 66.0]</td>
<td class='lastrow'>48.0 [28.0, 62.0]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Sex</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>female</td>
<td>12 (11.3%)</td>
<td>69 (36.7%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>male</td>
<td class='lastrow'>94 (88.7%)</td>
<td class='lastrow'>119 (63.3%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Chest_Pain_Type</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>typical angina</td>
<td>4 (3.8%)</td>
<td>7 (3.7%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel'>atypical angina</td>
<td>8 (7.5%)</td>
<td>98 (52.1%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel'>non-anginal pain</td>
<td>11 (10.4%)</td>
<td>43 (22.9%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>asymptomatic</td>
<td class='lastrow'>83 (78.3%)</td>
<td class='lastrow'>40 (21.3%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Fasting_Blood_Sugar</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'><= 120 mg/dl</td>
<td>92 (86.8%)</td>
<td>181 (96.3%)</td>
<td>0.005</td>
</tr>
<tr>
<td class='rowlabel lastrow'>> 120 mg/dl</td>
<td class='lastrow'>14 (13.2%)</td>
<td class='lastrow'>7 (3.7%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Resting_ECG</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>normal</td>
<td>85 (80.2%)</td>
<td>150 (79.8%)</td>
<td>0.593</td>
</tr>
<tr>
<td class='rowlabel'>ST-T abnormality</td>
<td>20 (18.9%)</td>
<td>33 (17.6%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>LV hypertrophy</td>
<td class='lastrow'>1 (0.9%)</td>
<td class='lastrow'>5 (2.7%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Exercise_Induced_Angina</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>no</td>
<td>36 (34.0%)</td>
<td>169 (89.9%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>yes</td>
<td class='lastrow'>70 (66.0%)</td>
<td class='lastrow'>19 (10.1%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Slope_Peak_Exercise_ST</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>up sloping</td>
<td>9 (8.5%)</td>
<td>107 (56.9%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel'>flat</td>
<td>94 (88.7%)</td>
<td>77 (41.0%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>down sloping</td>
<td class='lastrow'>3 (2.8%)</td>
<td class='lastrow'>4 (2.1%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Thalassemia</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>normal</td>
<td>26 (24.5%)</td>
<td>147 (78.2%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel'>fixed defect</td>
<td>16 (15.1%)</td>
<td>10 (5.3%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>reversible defect</td>
<td class='lastrow'>64 (60.4%)</td>
<td class='lastrow'>31 (16.5%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Resting_Blood_Pressure</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>136 (18.7)</td>
<td>131 (16.7)</td>
<td>0.022</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>135 [92.0, 200]</td>
<td class='lastrow'>130 [98.0, 190]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Max_Heart_Rate_Achieved</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>129 (22.6)</td>
<td>145 (22.2)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>129 [82.0, 180]</td>
<td class='lastrow'>144 [90.0, 190]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>ST_Depression_Exercise</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>1.25 (1.05)</td>
<td>0.214 (0.534)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>1.00 [0, 5.00]</td>
<td class='lastrow'>0 [0, 3.00]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Num_Major_Vessels</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>0</td>
<td>40 (37.7%)</td>
<td>146 (77.7%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel'>1</td>
<td>29 (27.4%)</td>
<td>29 (15.4%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel'>2</td>
<td>17 (16.0%)</td>
<td>11 (5.9%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>3</td>
<td class='lastrow'>20 (18.9%)</td>
<td class='lastrow'>2 (1.1%)</td>
<td class='lastrow'></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="eu2-1" class="section level3">
<h3>EU2</h3>
<p>Here Fasting blood sugar, Resting ECG, Exercise induced angina, St segment slope peak exercise, Thalassemia, Resting Blood pressure measure, Thallium stress test, ST Depression Exercise all these test seems insignificant here.</p>
<p>Only few test like chest pain, Number of major vessels (0-3) colored by flourosopy are signiifcant.</p>
<pre class="r"><code>table_names&lt;- HD$EU2  %&gt;%
  select(Sex,
         Chest_Pain_Type,
         Fasting_Blood_Sugar,
         Resting_ECG,
         Exercise_Induced_Angina,
         Slope_Peak_Exercise_ST,
         Thalassemia,
         Age,
         Resting_Blood_Pressure,
         Max_Heart_Rate_Achieved,
         ST_Depression_Exercise,
         Num_Major_Vessels,
         diag_hd) %&gt;%
  mutate(Sex = recode_factor(Sex, `0` = &quot;female&quot;, 
                                  `1` = &quot;male&quot; ),
         Chest_Pain_Type = recode_factor(Chest_Pain_Type, `1` = &quot;typical angina&quot;,   
                                                          `2` = &quot;atypical angina&quot;,
                                                          `3` = &quot;non-anginal pain&quot;, 
                                                          `4` = &quot;asymptomatic&quot;),
         Fasting_Blood_Sugar = recode_factor(Fasting_Blood_Sugar, `0` = &quot;&lt;= 120 mg/dl&quot;, 
                                                                  `1` = &quot;&gt; 120 mg/dl&quot;),
         Resting_ECG = recode_factor(Resting_ECG, `0` = &quot;normal&quot;,
                                                  `1` = &quot;ST-T abnormality&quot;,
                                                  `2` = &quot;LV hypertrophy&quot;),
         Exercise_Induced_Angina = recode_factor(Exercise_Induced_Angina, `0` = &quot;no&quot;,
                                                                          `1` = &quot;yes&quot;),
         Slope_Peak_Exercise_ST = recode_factor(Slope_Peak_Exercise_ST, `1` = &quot;up sloping&quot;,
                                                                            `2` = &quot;flat&quot;,
                                                                            `3` = &quot;down sloping&quot;),
         Thalassemia = recode_factor(Thalassemia, `3` = &quot;normal&quot;,
                                                  `6` = &quot;fixed defect&quot;,
                                                  `7` = &quot;reversible defect&quot;) ,
         diag_hd = ifelse(is.na(diag_hd), NA,
                        ifelse(diag_hd == 1, &quot;Heart disease&quot;,
                               ifelse(diag_hd == 0, &quot;No Heart disease&quot;, &quot;error&quot;))) %&gt;%
           factor(levels = c(&quot;Heart disease&quot;, &quot;No Heart disease&quot;, &quot;P-value&quot;)))


table1(~ Age+
         Sex+
         Chest_Pain_Type+
         Fasting_Blood_Sugar+
         Resting_ECG+
         Exercise_Induced_Angina+
         Slope_Peak_Exercise_ST+
         Thalassemia+
         Resting_Blood_Pressure+
         Max_Heart_Rate_Achieved+
         ST_Depression_Exercise+
         Num_Major_Vessels|diag_hd, 
       data = table_names,
       droplevels = F,
       render = rndr,
       render.strat = rndr.strat,
       overall = F)</code></pre>
<div class="Rtable1"><table class="Rtable1">
<thead>
<tr>
<th class='rowlabel firstrow lastrow'></th>
<th class='firstrow lastrow'><span class='stratlabel'>Heart disease<br><span class='stratn'>(N=115)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>No Heart disease<br><span class='stratn'>(N=8)</span></span></th>
<th class='firstrow lastrow'>P-value</th>
</tr>
</thead>
<tbody>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Age</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>55.4 (8.97)</td>
<td>54.6 (10.6)</td>
<td>0.852</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>57.0 [32.0, 74.0]</td>
<td class='lastrow'>54.0 [38.0, 72.0]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Sex</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>female</td>
<td>10 (8.7%)</td>
<td>0 (0%)</td>
<td>0.841</td>
</tr>
<tr>
<td class='rowlabel lastrow'>male</td>
<td class='lastrow'>105 (91.3%)</td>
<td class='lastrow'>8 (100%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Chest_Pain_Type</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>typical angina</td>
<td>4 (3.5%)</td>
<td>0 (0%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel'>atypical angina</td>
<td>2 (1.7%)</td>
<td>2 (25.0%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel'>non-anginal pain</td>
<td>13 (11.3%)</td>
<td>4 (50.0%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>asymptomatic</td>
<td class='lastrow'>96 (83.5%)</td>
<td class='lastrow'>2 (25.0%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Fasting_Blood_Sugar</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'><= 120 mg/dl</td>
<td>101 (87.8%)</td>
<td>8 (100%)</td>
<td>0.636</td>
</tr>
<tr>
<td class='rowlabel lastrow'>> 120 mg/dl</td>
<td class='lastrow'>14 (12.2%)</td>
<td class='lastrow'>0 (0%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Resting_ECG</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>normal</td>
<td>81 (70.4%)</td>
<td>5 (62.5%)</td>
<td>0.682</td>
</tr>
<tr>
<td class='rowlabel'>ST-T abnormality</td>
<td>28 (24.3%)</td>
<td>2 (25.0%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>LV hypertrophy</td>
<td class='lastrow'>6 (5.2%)</td>
<td class='lastrow'>1 (12.5%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Exercise_Induced_Angina</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>no</td>
<td>62 (53.9%)</td>
<td>7 (87.5%)</td>
<td>0.138</td>
</tr>
<tr>
<td class='rowlabel lastrow'>yes</td>
<td class='lastrow'>53 (46.1%)</td>
<td class='lastrow'>1 (12.5%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Slope_Peak_Exercise_ST</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>up sloping</td>
<td>35 (30.4%)</td>
<td>4 (50.0%)</td>
<td>0.171</td>
</tr>
<tr>
<td class='rowlabel'>flat</td>
<td>67 (58.3%)</td>
<td>2 (25.0%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>down sloping</td>
<td class='lastrow'>13 (11.3%)</td>
<td class='lastrow'>2 (25.0%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Thalassemia</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>normal</td>
<td>30 (26.1%)</td>
<td>3 (37.5%)</td>
<td>0.406</td>
</tr>
<tr>
<td class='rowlabel'>fixed defect</td>
<td>20 (17.4%)</td>
<td>0 (0%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>reversible defect</td>
<td class='lastrow'>65 (56.5%)</td>
<td class='lastrow'>5 (62.5%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Resting_Blood_Pressure</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>131 (22.2)</td>
<td>124 (27.4)</td>
<td>0.537</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>125 [95.0, 200]</td>
<td class='lastrow'>125 [80.0, 160]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Max_Heart_Rate_Achieved</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>120 (26.1)</td>
<td>137 (25.8)</td>
<td>0.117</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>120 [60.0, 182]</td>
<td class='lastrow'>140 [97.0, 179]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>ST_Depression_Exercise</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>0.655 (1.07)</td>
<td>0.538 (1.00)</td>
<td>0.758</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>0.300 [-2.60, 3.70]</td>
<td class='lastrow'>0.450 [-1.10, 2.00]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Num_Major_Vessels</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>0</td>
<td>35 (30.4%)</td>
<td>6 (75.0%)</td>
<td>0.078</td>
</tr>
<tr>
<td class='rowlabel'>1</td>
<td>40 (34.8%)</td>
<td>1 (12.5%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel'>2</td>
<td>30 (26.1%)</td>
<td>1 (12.5%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>3</td>
<td class='lastrow'>10 (8.7%)</td>
<td class='lastrow'>0 (0%)</td>
<td class='lastrow'></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="all-1" class="section level3">
<h3>All</h3>
<p>Overall all the test seems significant.</p>
<pre class="r"><code>table_names&lt;- HD_all  %&gt;%
  select(Sex,
         Chest_Pain_Type,
         Fasting_Blood_Sugar,
         Resting_ECG,
         Exercise_Induced_Angina,
         Slope_Peak_Exercise_ST,
         Thalassemia,
         Age,
         Resting_Blood_Pressure,
         Max_Heart_Rate_Achieved,
         ST_Depression_Exercise,
         Num_Major_Vessels,
         diag_hd) %&gt;%
  mutate(Sex = recode_factor(Sex, `0` = &quot;female&quot;, 
                                  `1` = &quot;male&quot; ),
         Chest_Pain_Type = recode_factor(Chest_Pain_Type, `1` = &quot;typical angina&quot;,   
                                                          `2` = &quot;atypical angina&quot;,
                                                          `3` = &quot;non-anginal pain&quot;, 
                                                          `4` = &quot;asymptomatic&quot;),
         Fasting_Blood_Sugar = recode_factor(Fasting_Blood_Sugar, `0` = &quot;&lt;= 120 mg/dl&quot;, 
                                                                  `1` = &quot;&gt; 120 mg/dl&quot;),
         Resting_ECG = recode_factor(Resting_ECG, `0` = &quot;normal&quot;,
                                                  `1` = &quot;ST-T abnormality&quot;,
                                                  `2` = &quot;LV hypertrophy&quot;),
         Exercise_Induced_Angina = recode_factor(Exercise_Induced_Angina, `0` = &quot;no&quot;,
                                                                          `1` = &quot;yes&quot;),
         Slope_Peak_Exercise_ST = recode_factor(Slope_Peak_Exercise_ST, `1` = &quot;up sloping&quot;,
                                                                            `2` = &quot;flat&quot;,
                                                                            `3` = &quot;down sloping&quot;),
         Thalassemia = recode_factor(Thalassemia, `3` = &quot;normal&quot;,
                                                  `6` = &quot;fixed defect&quot;,
                                                  `7` = &quot;reversible defect&quot;) ,
         diag_hd = ifelse(is.na(diag_hd), NA,
                        ifelse(diag_hd == 1, &quot;Heart disease&quot;,
                               ifelse(diag_hd == 0, &quot;No Heart disease&quot;, &quot;error&quot;))) %&gt;%
           factor(levels = c(&quot;Heart disease&quot;, &quot;No Heart disease&quot;, &quot;P-value&quot;)))


table1(~ Age+
         Sex+
         Chest_Pain_Type+
         Fasting_Blood_Sugar+
         Resting_ECG+
         Exercise_Induced_Angina+
         Slope_Peak_Exercise_ST+
         Thalassemia+
         Resting_Blood_Pressure+
         Max_Heart_Rate_Achieved+
         ST_Depression_Exercise+
         Num_Major_Vessels|diag_hd, 
       data = table_names,
       droplevels = F,
       render = rndr,
       render.strat = rndr.strat,
       overall = F)</code></pre>
<div class="Rtable1"><table class="Rtable1">
<thead>
<tr>
<th class='rowlabel firstrow lastrow'></th>
<th class='firstrow lastrow'><span class='stratlabel'>Heart disease<br><span class='stratn'>(N=509)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>No Heart disease<br><span class='stratn'>(N=411)</span></span></th>
<th class='firstrow lastrow'>P-value</th>
</tr>
</thead>
<tbody>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Age</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>55.9 (8.72)</td>
<td>50.5 (9.43)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>57.0 [31.0, 77.0]</td>
<td class='lastrow'>51.0 [28.0, 76.0]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Sex</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>female</td>
<td>50 (9.8%)</td>
<td>144 (35.0%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>male</td>
<td class='lastrow'>459 (90.2%)</td>
<td class='lastrow'>267 (65.0%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Chest_Pain_Type</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>typical angina</td>
<td>20 (3.9%)</td>
<td>26 (6.3%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel'>atypical angina</td>
<td>24 (4.7%)</td>
<td>150 (36.5%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel'>non-anginal pain</td>
<td>73 (14.3%)</td>
<td>131 (31.9%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>asymptomatic</td>
<td class='lastrow'>392 (77.0%)</td>
<td class='lastrow'>104 (25.3%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Fasting_Blood_Sugar</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'><= 120 mg/dl</td>
<td>405 (79.6%)</td>
<td>367 (89.3%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>> 120 mg/dl</td>
<td class='lastrow'>104 (20.4%)</td>
<td class='lastrow'>44 (10.7%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Resting_ECG</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>normal</td>
<td>284 (55.8%)</td>
<td>268 (65.2%)</td>
<td>0.003</td>
</tr>
<tr>
<td class='rowlabel'>ST-T abnormality</td>
<td>119 (23.4%)</td>
<td>61 (14.8%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>LV hypertrophy</td>
<td class='lastrow'>106 (20.8%)</td>
<td class='lastrow'>82 (20.0%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Exercise_Induced_Angina</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>no</td>
<td>202 (39.7%)</td>
<td>350 (85.2%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>yes</td>
<td class='lastrow'>307 (60.3%)</td>
<td class='lastrow'>61 (14.8%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Slope_Peak_Exercise_ST</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>up sloping</td>
<td>109 (21.4%)</td>
<td>224 (54.5%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel'>flat</td>
<td>325 (63.9%)</td>
<td>159 (38.7%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>down sloping</td>
<td class='lastrow'>75 (14.7%)</td>
<td class='lastrow'>28 (6.8%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Thalassemia</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>normal</td>
<td>121 (23.8%)</td>
<td>314 (76.4%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel'>fixed defect</td>
<td>64 (12.6%)</td>
<td>21 (5.1%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>reversible defect</td>
<td class='lastrow'>324 (63.7%)</td>
<td class='lastrow'>76 (18.5%)</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Resting_Blood_Pressure</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>134 (20.5)</td>
<td>130 (16.8)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>130 [0, 200]</td>
<td class='lastrow'>130 [80.0, 190]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Max_Heart_Rate_Achieved</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>127 (24.1)</td>
<td>148 (24.3)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>127 [60.0, 195]</td>
<td class='lastrow'>150 [69.0, 202]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>ST_Depression_Exercise</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>1.26 (1.19)</td>
<td>0.416 (0.722)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>1.00 [-2.60, 6.20]</td>
<td class='lastrow'>0 [-1.10, 4.20]</td>
<td class='lastrow'></td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Num_Major_Vessels</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>0</td>
<td>173 (34.0%)</td>
<td>327 (79.6%)</td>
<td>&lt;0.001</td>
</tr>
<tr>
<td class='rowlabel'>1</td>
<td>157 (30.8%)</td>
<td>54 (13.1%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel'>2</td>
<td>111 (21.8%)</td>
<td>21 (5.1%)</td>
<td></td>
</tr>
<tr>
<td class='rowlabel lastrow'>3</td>
<td class='lastrow'>68 (13.4%)</td>
<td class='lastrow'>9 (2.2%)</td>
<td class='lastrow'></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="data-visualisation-of-each-hospital" class="section level2 tabset">
<h2>Data visualisation of each hospital</h2>
<p>Mostly all heart disease patient have as asymptomatic chest pain. Most patient have HD have ecercise induced angina. Most people with HD have flat response in ST segment exercise. ECG is normal in most HD patients.</p>
<div id="us1-2" class="section level3">
<h3>US1</h3>
<pre class="r"><code># graphicar representation of there association.


hd_long_fact_tbl &lt;- HD$US1  %&gt;%
  select(Sex,
         Chest_Pain_Type,
         Fasting_Blood_Sugar ,
         Resting_ECG,
         Exercise_Induced_Angina,
         Slope_Peak_Exercise_ST,
         Thalassemia,Num_Major_Vessels,
         diag_hd) %&gt;%
  mutate(  Sex = recode_factor(Sex, `0` = &quot;female&quot;, 
                                  `1` = &quot;male&quot; ),
         Chest_Pain_Type = recode_factor(Chest_Pain_Type, `1` = &quot;typical&quot;,   
                                                          `2` = &quot;atypical&quot;,
                                                          `3` = &quot;non-anginal&quot;, 
                                                          `4` = &quot;asymptomatic&quot;),
         Fasting_Blood_Sugar = recode_factor(Fasting_Blood_Sugar, `0` = &quot;&lt;= 120 mg/dl&quot;, 
                                                                  `1` = &quot;&gt; 120 mg/dl&quot;),
         Resting_ECG = recode_factor(Resting_ECG, `0` = &quot;normal&quot;,
                                                  `1` = &quot;ST-T abnormality&quot;,
                                                  `2` = &quot;LV hypertrophy&quot;),
         Exercise_Induced_Angina = recode_factor(Exercise_Induced_Angina, `0` = &quot;no&quot;,
                                                                          `1` = &quot;yes&quot;),
         Slope_Peak_Exercise_ST = recode_factor(Slope_Peak_Exercise_ST, `1` = &quot;up sloping&quot;,
                                                                            `2` = &quot;flat&quot;,
                                                                            `3` = &quot;down sloping&quot;),
         Thalassemia = recode_factor(Thalassemia, `3` = &quot;normal&quot;,
                                                  `6` = &quot;fixed defect&quot;,
                                                  `7` = &quot;reversible defect&quot;)) %&gt;%

  gather(key = &quot;key&quot;, value = &quot;value&quot;, -diag_hd)

#Visualize with bar plot
hd_long_fact_tbl %&gt;% 
  ggplot(aes(value)) +
    geom_bar(aes(x        = value, 
                 fill     = diag_hd), 
                 alpha    = .6, 
                 position = &quot;dodge&quot;, 
                 color    = &quot;black&quot;,
                 width    = .8
             ) +
    labs(x = &quot;&quot;,
         y = &quot;&quot;,
         title = &quot;Scaled Effect of Categorical Variables&quot;) +
    theme(
         axis.text.y  = element_blank(),
         axis.ticks.y = element_blank()) +
    facet_wrap(~ key, scales = &quot;free&quot;, nrow = 5) +
    scale_fill_manual(
         values = c(&quot;yellow2&quot;, &quot;firebrick1&quot;),
         name   = &quot;Heart\nDisease&quot;,
         labels = c(&quot;No HD&quot;, &quot;Yes HD&quot;))</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<pre class="r"><code>hd_long_cont_tbl &lt;- HD$US1  %&gt;%
  select(Age,
         Resting_Blood_Pressure,
         Max_Heart_Rate_Achieved,
         ST_Depression_Exercise,
         #Num_Major_Vessels,
         diag_hd) %&gt;% 
  gather(key   = &quot;key&quot;, 
         value = &quot;value&quot;,
         -diag_hd)

#Visualize numeric variables as boxplots
h&lt;-hd_long_cont_tbl %&gt;% 
  ggplot(aes(y = value)) +
       geom_histogram(aes(fill = diag_hd),
                      alpha  = .6) +
        labs(x = &quot;&quot;,
             y = &quot;&quot;,
             title = &quot;Boxplots for Numeric Variables&quot;) +
      scale_fill_manual(
            values = c(&quot;yellow2&quot;, &quot;springgreen3&quot;),
            name   = &quot;Heart\nDisease&quot;,
            labels = c(&quot;No HD&quot;, &quot;Yes HD&quot;)) +
      theme() +
      facet_wrap( ~ key  , 
                scales = &quot;free&quot;, 
                 ncol   = 2) 

h +coord_flip()</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-20-2.png" width="672" /> DGGRGWRGWGWRGV GRWGRWG</p>
</div>
<div id="us2-2" class="section level3">
<h3>US2</h3>
<pre class="r"><code># graphicar representation of there association.
# graphicar representation of there association.
hd_long_fact_tbl &lt;- HD$US2  %&gt;%
  select(Sex,
         Chest_Pain_Type,
         Fasting_Blood_Sugar,
         Resting_ECG,
         Exercise_Induced_Angina,
         Slope_Peak_Exercise_ST,
         Thalassemia,
         Num_Major_Vessels,
         diag_hd)  %&gt;%

  mutate(Sex = recode_factor(Sex, `0` = &quot;female&quot;, 
                                  `1` = &quot;male&quot; ),
         Chest_Pain_Type = recode_factor(Chest_Pain_Type, `1` = &quot;typical &quot;,   
                                                          `2` = &quot;atypical &quot;,
                                                          `3` = &quot;non-anginal &quot;, 
                                                          `4` = &quot;asymptomatic&quot;),
         Fasting_Blood_Sugar = recode_factor(Fasting_Blood_Sugar, `0` = &quot;&lt;= 120 mg/dl&quot;, 
                                                                  `1` = &quot;&gt; 120 mg/dl&quot;),
         Resting_ECG = recode_factor(Resting_ECG, `0` = &quot;normal&quot;,
                                                  `1` = &quot;ST-T abnormality&quot;,
                                                  `2` = &quot;LV hypertrophy&quot;),
         Exercise_Induced_Angina = recode_factor(Exercise_Induced_Angina, `0` = &quot;no&quot;,
                                                                          `1` = &quot;yes&quot;),
         Slope_Peak_Exercise_ST= recode_factor(Slope_Peak_Exercise_ST, `1` = &quot;up sloping&quot;,
                                                                            `2` = &quot;flat&quot;,
                                                                            `3` = &quot;down sloping&quot;),
         Thalassemia = recode_factor(Thalassemia, `3` = &quot;normal&quot;,
                                                  `6` = &quot;fixed defect&quot;,
                                                  `7` = &quot;reversible defect&quot;)) %&gt;%
  gather(key = &quot;key&quot;, value = &quot;value&quot;, -diag_hd)

#Visualize with bar plot
hd_long_fact_tbl %&gt;% 
  ggplot(aes(value)) +
    geom_bar(aes(x        = value, 
                 fill     = diag_hd), 
                 alpha    = .6, 
                 position = &quot;dodge&quot;, 
                 color    = &quot;black&quot;,
                 width    = .8
             ) +
    labs(x = &quot;&quot;,
         y = &quot;&quot;,
         title = &quot;Scaled Effect of Categorical Variables&quot;) +
    theme(
         axis.text.y  = element_blank(),
         axis.ticks.y = element_blank()) +
    facet_wrap(~ key, scales = &quot;free&quot;, nrow = 4) +
    scale_fill_manual(
         values = c(&quot;yellow2&quot;, &quot;firebrick1&quot;),
         name   = &quot;Heart\nDisease&quot;,
         labels = c(&quot;No HD&quot;, &quot;Yes HD&quot;))</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<pre class="r"><code>hd_long_cont_tbl &lt;- HD$US2  %&gt;%
  select(Age,
         Resting_Blood_Pressure,
         Max_Heart_Rate_Achieved,
         ST_Depression_Exercise,
        # Num_Major_Vessels,
         diag_hd) %&gt;% 
  gather(key   = &quot;key&quot;, 
         value = &quot;value&quot;,
         -diag_hd)

#Visualize numeric variables as boxplots
h&lt;-hd_long_cont_tbl %&gt;% 
  ggplot(aes(y = value)) +
       geom_histogram(aes(fill = diag_hd),
                      alpha  = .6) +
        labs(x = &quot;&quot;,
             y = &quot;&quot;,
             title = &quot;Boxplots for Numeric Variables&quot;) +
      scale_fill_manual(
            values = c(&quot;yellow2&quot;, &quot;springgreen3&quot;),
            name   = &quot;Heart\nDisease&quot;,
            labels = c(&quot;No HD&quot;, &quot;Yes HD&quot;)) +
      theme() +
      facet_wrap( ~ key  , 
                scales = &quot;free&quot;, 
                 ncol   = 2) 

h +coord_flip()</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-21-2.png" width="672" /></p>
</div>
<div id="eu1-2" class="section level3">
<h3>EU1</h3>
<pre class="r"><code># graphicar representation of there association.
# graphicar representation of there association.
hd_long_fact_tbl &lt;- HD$EU1  %&gt;%
  select(Sex,
         Chest_Pain_Type,
         Fasting_Blood_Sugar,
         Resting_ECG,
         Exercise_Induced_Angina,
         Slope_Peak_Exercise_ST,
         Thalassemia,
         Num_Major_Vessels,
         diag_hd) %&gt;%
  #rename(Resting_ECG...x=Resting_ECG)%&gt;%
  mutate(Sex = recode_factor(Sex, `0` = &quot;female&quot;, 
                                  `1` = &quot;male&quot; ),
         Chest_Pain_Type = recode_factor(Chest_Pain_Type, `1` = &quot;typical &quot;,   
                                                          `2` = &quot;atypical &quot;,
                                                          `3` = &quot;non-anginal &quot;, 
                                                          `4` = &quot;asymptomatic&quot;),
         Fasting_Blood_Sugar = recode_factor(Fasting_Blood_Sugar, `0` = &quot;&lt;= 120 mg/dl&quot;, 
                                                                  `1` = &quot;&gt; 120 mg/dl&quot;),
         Resting_ECG = recode_factor(Resting_ECG, `0` = &quot;normal&quot;,
                                                  `1` = &quot;ST-T abnormality&quot;,
                                                  `2` = &quot;LV hypertrophy&quot;),
         Exercise_Induced_Angina = recode_factor(Exercise_Induced_Angina, `0` = &quot;no&quot;,
                                                                          `1` = &quot;yes&quot;),
         Slope_Peak_Exercise_ST = recode_factor(Slope_Peak_Exercise_ST, `1` = &quot;up sloping&quot;,
                                                                            `2` = &quot;flat&quot;,
                                                                            `3` = &quot;down sloping&quot;),
         Thalassemia = recode_factor(Thalassemia, `3` = &quot;normal&quot;,
                                                  `6` = &quot;fixed defect&quot;,
                                                  `7` = &quot;reversible defect&quot;)) %&gt;%
  gather(key = &quot;key&quot;, value = &quot;value&quot;, -diag_hd)

#Visualize with bar plot
hd_long_fact_tbl %&gt;% 
  ggplot(aes(value)) +
    geom_bar(aes(x        = value, 
                 fill     = diag_hd), 
                 alpha    = .6, 
                 position = &quot;dodge&quot;, 
                 color    = &quot;black&quot;,
                 width    = .8
             ) +
    labs(x = &quot;&quot;,
         y = &quot;&quot;,
         title = &quot;Scaled Effect of Categorical Variables&quot;) +
    theme(
         axis.text.y  = element_blank(),
         axis.ticks.y = element_blank()) +
    facet_wrap(~ key, scales = &quot;free&quot;, nrow = 4) +
    scale_fill_manual(
         values = c(&quot;yellow2&quot;, &quot;firebrick1&quot;),
         name   = &quot;Heart\nDisease&quot;,
         labels = c(&quot;No HD&quot;, &quot;Yes HD&quot;))</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<pre class="r"><code>hd_long_cont_tbl &lt;- HD$EU1  %&gt;%
  select(Age,
         Resting_Blood_Pressure,
         Max_Heart_Rate_Achieved,
         ST_Depression_Exercise,
        # Num_Major_Vessels,
         diag_hd) %&gt;% 
  gather(key   = &quot;key&quot;, 
         value = &quot;value&quot;,
         -diag_hd)

#Visualize numeric variables as boxplots
h&lt;-hd_long_cont_tbl %&gt;% 
  ggplot(aes(y = value)) +
       geom_histogram(aes(fill = diag_hd),
                      alpha  = .6) +
        labs(x = &quot;&quot;,
             y = &quot;&quot;,
             title = &quot;Boxplots for Numeric Variables&quot;) +
      scale_fill_manual(
            values = c(&quot;yellow2&quot;, &quot;springgreen3&quot;),
            name   = &quot;Heart\nDisease&quot;,
            labels = c(&quot;No HD&quot;, &quot;Yes HD&quot;)) +
      theme() +
      facet_wrap( ~ key  , 
                scales = &quot;free&quot;, 
                 ncol   = 2) 

h +coord_flip()</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-22-2.png" width="672" /></p>
</div>
<div id="eu2-2" class="section level3">
<h3>EU2</h3>
<pre class="r"><code># graphicar representation of there association.
hd_long_fact_tbl &lt;- HD$EU2  %&gt;%
  select(Sex,
         Chest_Pain_Type,
         Fasting_Blood_Sugar,
         Resting_ECG,
         Exercise_Induced_Angina,
         Slope_Peak_Exercise_ST,
         Thalassemia,
         Num_Major_Vessels,
         diag_hd) %&gt;%
  #rename(Fasting_Blood_Sugar...x=Fasting_Blood_Sugar, Resting_ECG...x=Resting_ECG ,Exercise_Induced_Angina...x=Exercise_Induced_Angina , Slope_Peak_Exercise_ST...x=Slope_Peak_Exercise_ST, Thalassemia...x=Thalassemia )%&gt;%
  mutate(Sex = recode_factor(Sex, `0` = &quot;female&quot;, 
                                  `1` = &quot;male&quot; ),
         Chest_Pain_Type = recode_factor(Chest_Pain_Type, `1` = &quot;typical &quot;,   
                                                          `2` = &quot;atypical &quot;,
                                                          `3` = &quot;non-anginal&quot;, 
                                                          `4` = &quot;asymptomatic&quot;),
         Fasting_Blood_Sugar = recode_factor(Fasting_Blood_Sugar, `0` = &quot;&lt;= 120 mg/dl&quot;, 
                                                                  `1` = &quot;&gt; 120 mg/dl&quot;),
         Resting_ECG = recode_factor(Resting_ECG, `0` = &quot;normal&quot;,
                                                  `1` = &quot;ST-T abnormality&quot;,
                                                  `2` = &quot;LV hypertrophy&quot;),
         Exercise_Induced_Angina = recode_factor(Exercise_Induced_Angina, `0` = &quot;no&quot;,
                                                                          `1` = &quot;yes&quot;),
         Slope_Peak_Exercise_ST = recode_factor(Slope_Peak_Exercise_ST, `1` = &quot;up sloping&quot;,
                                                                            `2` = &quot;flat&quot;,
                                                                            `3` = &quot;down sloping&quot;),
         Thalassemia = recode_factor(Thalassemia, `3` = &quot;normal&quot;,
                                                  `6` = &quot;fixed defect&quot;,
                                                  `7` = &quot;reversible defect&quot;)) %&gt;%
  gather(key = &quot;key&quot;, value = &quot;value&quot;, -diag_hd)

#Visualize with bar plot
hd_long_fact_tbl %&gt;% 
  ggplot(aes(value)) +
    geom_bar(aes(x        = value, 
                 fill     = diag_hd), 
                 alpha    = .6, 
                 position = &quot;dodge&quot;, 
                 color    = &quot;black&quot;,
                 width    = .8
             ) +
    labs(x = &quot;&quot;,
         y = &quot;&quot;,
         title = &quot;Scaled Effect of Categorical Variables&quot;) +
    theme(
         axis.text.y  = element_blank(),
         axis.ticks.y = element_blank()) +
    facet_wrap(~ key, scales = &quot;free&quot;, nrow = 4) +
    scale_fill_manual(
         values = c(&quot;yellow2&quot;, &quot;firebrick1&quot;),
         name   = &quot;Heart\nDisease&quot;,
         labels = c(&quot;No HD&quot;, &quot;Yes HD&quot;))</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r"><code>hd_long_cont_tbl &lt;- HD$EU2  %&gt;%
  select(Age,
         Resting_Blood_Pressure,
         Max_Heart_Rate_Achieved,
         ST_Depression_Exercise,
         #Num_Major_Vessels,
         diag_hd) %&gt;% 
 # rename(Resting_Blood_Pressure...x= Resting_Blood_Pressure,
   #      Max_Heart_Rate_Achieved...x= Max_Heart_Rate_Achieved,
     #    ST_Depression_Exercise...x=ST_Depression_Exercise)%&gt;%
  gather(key   = &quot;key&quot;, 
         value = &quot;value&quot;,
         -diag_hd)

#Visualize numeric variables as boxplots
h&lt;-hd_long_cont_tbl %&gt;% 
  ggplot(aes(y = value)) +
       geom_histogram(aes(fill = diag_hd),
                      alpha  = .6) +
        labs(x = &quot;&quot;,
             y = &quot;&quot;,
             title = &quot;Boxplots for Numeric Variables&quot;) +
      scale_fill_manual(
            values = c(&quot;yellow2&quot;, &quot;springgreen3&quot;),
            name   = &quot;Heart\nDisease&quot;,
            labels = c(&quot;No HD&quot;, &quot;Yes HD&quot;)) +
      theme() +
      facet_wrap( ~ key  , 
                scales = &quot;free&quot;, 
                 ncol   = 2) 

h +coord_flip()</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-23-2.png" width="672" /></p>
</div>
<div id="all-dichotomized" class="section level3">
<h3>All dichotomized</h3>
<pre class="r"><code># graphicar representation of there association.
hd_long_fact_tbl &lt;- HD_all  %&gt;%
  select(Sex,
         Chest_Pain_Type,
         Fasting_Blood_Sugar,
         Resting_ECG,
         Exercise_Induced_Angina,
         Slope_Peak_Exercise_ST,
         Thalassemia,
         Num_Major_Vessels,
         diag_hd) %&gt;%
  mutate(Sex = recode_factor(Sex, `0` = &quot;female&quot;, 
                                  `1` = &quot;male&quot; ),
         Chest_Pain_Type = recode_factor(Chest_Pain_Type, `1` = &quot;typical&quot;,   
                                                          `2` = &quot;atypical &quot;,
                                                          `3` = &quot;non-anginal&quot;, 
                                                          `4` = &quot;asymptomatic&quot;),
         Fasting_Blood_Sugar = recode_factor(Fasting_Blood_Sugar, `0` = &quot;&lt;= 120 mg/dl&quot;, 
                                                                  `1` = &quot;&gt; 120 mg/dl&quot;),
         Resting_ECG = recode_factor(Resting_ECG, `0` = &quot;normal&quot;,
                                                  `1` = &quot;ST-T abnormality&quot;,
                                                  `2` = &quot;LV hypertrophy&quot;),
         Exercise_Induced_Angina = recode_factor(Exercise_Induced_Angina, `0` = &quot;no&quot;,
                                                                          `1` = &quot;yes&quot;),
         Slope_Peak_Exercise_ST = recode_factor(Slope_Peak_Exercise_ST, `1` = &quot;up sloping&quot;,
                                                                            `2` = &quot;flat&quot;,
                                                                            `3` = &quot;down sloping&quot;),
         Thalassemia = recode_factor(Thalassemia, `3` = &quot;normal&quot;,
                                                  `6` = &quot;fixed defect&quot;,
                                                  `7` = &quot;reversible defect&quot;)) %&gt;%
  gather(key = &quot;key&quot;, value = &quot;value&quot;, -diag_hd)

#Visualize with bar plot
hd_long_fact_tbl %&gt;% 
  ggplot(aes(value)) +
    geom_bar(aes(x        = value, 
                 fill     = diag_hd), 
                 alpha    = .6, 
                 position = &quot;dodge&quot;, 
                 color    = &quot;black&quot;,
                 width    = .8
             ) +
    labs(x = &quot;&quot;,
         y = &quot;&quot;,
         title = &quot;Scaled Effect of Categorical Variables&quot;) +
    theme(
         axis.text.y  = element_blank(),
         axis.ticks.y = element_blank()) +
    facet_wrap(~ key, scales = &quot;free&quot;, nrow = 4) +
    scale_fill_manual(
         values = c(&quot;yellow2&quot;, &quot;firebrick1&quot;),
         name   = &quot;Heart\nDisease&quot;,
         labels = c(&quot;No HD&quot;, &quot;Yes HD&quot;))</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<pre class="r"><code>hd_long_cont_tbl &lt;- HD_all  %&gt;%
  select(Age,
         Resting_Blood_Pressure,
         Max_Heart_Rate_Achieved,
         ST_Depression_Exercise,
         #Num_Major_Vessels,
         diag_hd) %&gt;% 
  gather(key   = &quot;key&quot;,  value = &quot;value&quot;,  -diag_hd)

#Visualize numeric variables as boxplots
h&lt;-hd_long_cont_tbl %&gt;% 
  ggplot(aes(y = value)) +
       geom_histogram(aes(fill = diag_hd),
                      alpha  = .6) +
        labs(x = &quot;&quot;,
             y = &quot;&quot;,
             title = &quot;Boxplots for Numeric Variables&quot;) +
      scale_fill_manual(
            values = c(&quot;yellow2&quot;, &quot;springgreen3&quot;),
            name   = &quot;Heart\nDisease&quot;,
            labels = c(&quot;No HD&quot;, &quot;Yes HD&quot;)) +
      theme() +
      facet_wrap( ~ key  , 
                scales = &quot;free&quot;, 
                 ncol   = 2) 

h +coord_flip()</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-24-2.png" width="672" /></p>
</div>
<div id="all-not-dichotomized" class="section level3">
<h3>All not dichotomized</h3>
<pre class="r"><code># graphicar representation of there association.
hd_long_fact_tbl &lt;- HD_all  %&gt;%
  select(Sex,
         Chest_Pain_Type,
         Fasting_Blood_Sugar,
         Resting_ECG,
         Exercise_Induced_Angina,
         Slope_Peak_Exercise_ST,
         Thalassemia,
         Num_Major_Vessels,
         Diagnosis) %&gt;%
  mutate(Sex = recode_factor(Sex, `0` = &quot;female&quot;, 
                                  `1` = &quot;male&quot; ),
         Chest_Pain_Type = recode_factor(Chest_Pain_Type, `1` = &quot;typical&quot;,   
                                                          `2` = &quot;atypical &quot;,
                                                          `3` = &quot;non-anginal&quot;, 
                                                          `4` = &quot;asymptomatic&quot;),
         Fasting_Blood_Sugar = recode_factor(Fasting_Blood_Sugar, `0` = &quot;&lt;= 120 mg/dl&quot;, 
                                                                  `1` = &quot;&gt; 120 mg/dl&quot;),
         Resting_ECG = recode_factor(Resting_ECG, `0` = &quot;normal&quot;,
                                                  `1` = &quot;ST-T abnormality&quot;,
                                                  `2` = &quot;LV hypertrophy&quot;),
         Exercise_Induced_Angina = recode_factor(Exercise_Induced_Angina, `0` = &quot;no&quot;,
                                                                          `1` = &quot;yes&quot;),
         Slope_Peak_Exercise_ST = recode_factor(Slope_Peak_Exercise_ST, `1` = &quot;up sloping&quot;,
                                                                            `2` = &quot;flat&quot;,
                                                                            `3` = &quot;down sloping&quot;),
         Thalassemia = recode_factor(Thalassemia, `3` = &quot;normal&quot;,
                                                  `6` = &quot;fixed defect&quot;,
                                                  `7` = &quot;reversible defect&quot;)) %&gt;%
  gather(key = &quot;key&quot;, value = &quot;value&quot;, -Diagnosis )

#Visualize with bar plot
hd_long_fact_tbl %&gt;% 
  ggplot(aes(value)) +
    geom_bar(aes(x        = value, 
                 fill     = Diagnosis), 
                 alpha    = .6, 
                 position = &quot;dodge&quot;, 
                 color    = &quot;black&quot;,
                 width    = .8
             ) +
    labs(x = &quot;&quot;,
         y = &quot;&quot;,
         title = &quot;Scaled Effect of Categorical Variables&quot;) +
    theme(
         axis.text.y  = element_blank(),
         axis.ticks.y = element_blank()) +
    facet_wrap(~ key, scales = &quot;free&quot;, nrow = 4) +
    scale_fill_manual(
         values = c(&quot;yellow2&quot;, &quot;firebrick1&quot;, &quot;firebrick2&quot;, &quot;firebrick3&quot;,&quot;firebrick4&quot;),
         name   = &quot;Heart\nDisease&quot;,
         labels = c(&quot;No HD&quot;, &quot;1-HD&quot;,&quot;2-HD&quot;,&quot;3-HD&quot;,&quot;4-HD&quot;))</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<pre class="r"><code>hd_long_cont_tbl &lt;- HD_all  %&gt;%
  select(Age,
         Resting_Blood_Pressure,
         Max_Heart_Rate_Achieved,
         ST_Depression_Exercise,
         #Num_Major_Vessels,
         Diagnosis) %&gt;% 
  gather(key   = &quot;key&quot;,  value = &quot;value&quot;,  -Diagnosis)

#Visualize numeric variables as boxplots
h&lt;-hd_long_cont_tbl %&gt;% 
  ggplot(aes(y = value)) +
       geom_histogram(aes(fill = Diagnosis),
                      alpha  = .6) +
        labs(x = &quot;&quot;,
             y = &quot;&quot;,
             title = &quot;Boxplots for Numeric Variables&quot;) +
      scale_fill_manual(
            values = c(&quot;yellow2&quot;, &quot;springgreen1&quot;, &quot;springgreen2&quot;, &quot;springgreen3&quot;, &quot;seagreen&quot;),
            name   = &quot;Heart\nDisease&quot;,
            labels = c(&quot;No HD&quot;, &quot;1-HD&quot;,&quot;2-HD&quot;,&quot;3-HD&quot;,&quot;4-HD&quot;)) +
      theme() +
      facet_wrap( ~ key  , 
                scales = &quot;free&quot;, 
                 ncol   = 2) 

h +coord_flip()</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-25-2.png" width="672" /></p>
</div>
</div>
<div id="initial-generalized-regression-models" class="section level2 tabset">
<h2>Initial Generalized Regression Models</h2>
<div id="us1-3" class="section level3">
<h3>US1</h3>
<p>Signiﬁcant predictors are -<strong>[Male, Chest_Pain_Type4=asymptomatic, Resting_Blood_Pressure, Slope_Peak_Exercise_ST2 = flat,Num_Major_Vessels= 1,2,3 , Thalassemia7=‘reversible defect’]</strong> for having p-value &lt;0.05, nd for not having 1.0 inside confidence interval. And there odds ratio is closer to higher than 1.0. There are in favour of having heart disease.<br />
So being a male, and having asymptomatic- chest pain, having high blood pressure, having flat slope in ST segment excercise test, have colured major blood vessel by flourosopy and having result -reversible defect in Thalassemia test <strong>favoures in having heart disease</strong>.</p>
<pre class="r"><code>HD$US1$diag_hd = relevel(factor(HD$US1$diag_hd), ref = 1) #likelihood of having hd as reference 

lm_US1&lt;- glm(diag_hd~ . -Diagnosis  , data=HD$US1, family = binomial(link = &quot;logit&quot;))
summary(lm_US1)</code></pre>
<pre><code>## 
## Call:
## glm(formula = diag_hd ~ . - Diagnosis, family = binomial(link = &quot;logit&quot;), 
##     data = HD$US1)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.9543  -0.4626  -0.1347   0.3000   2.9613  
## 
## Coefficients:
##                           Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)              -5.781938   2.873894  -2.012 0.044232 *  
## Age                      -0.020130   0.024597  -0.818 0.413152    
## Sex1                      1.482588   0.527083   2.813 0.004911 ** 
## Chest_Pain_Type2          1.368730   0.795877   1.720 0.085473 .  
## Chest_Pain_Type3          0.393063   0.692830   0.567 0.570490    
## Chest_Pain_Type4          2.428216   0.703295   3.453 0.000555 ***
## Resting_Blood_Pressure    0.027310   0.011695   2.335 0.019538 *  
## Fasting_Blood_Sugar1     -0.386083   0.570987  -0.676 0.498934    
## Resting_ECG1              0.986093   2.437582   0.405 0.685818    
## Resting_ECG2              0.564759   0.387625   1.457 0.145124    
## Max_Heart_Rate_Achieved  -0.016244   0.011346  -1.432 0.152210    
## Exercise_Induced_Angina1  0.718742   0.440869   1.630 0.103041    
## ST_Depression_Exercise    0.423175   0.238064   1.778 0.075475 .  
## Slope_Peak_Exercise_ST2   1.284526   0.480089   2.676 0.007460 ** 
## Slope_Peak_Exercise_ST3   0.485802   0.945243   0.514 0.607291    
## Num_Major_Vessels1        2.220978   0.509554   4.359 1.31e-05 ***
## Num_Major_Vessels2        3.200013   0.782107   4.092 4.29e-05 ***
## Num_Major_Vessels3        2.165452   0.899637   2.407 0.016083 *  
## Thalassemia6              0.003896   0.788351   0.005 0.996057    
## Thalassemia7              1.411668   0.437822   3.224 0.001263 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 417.98  on 302  degrees of freedom
## Residual deviance: 187.24  on 283  degrees of freedom
## AIC: 227.24
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<pre class="r"><code>round(exp(cbind(Odds_ratio = coef(lm_US1), confint(lm_US1,level = 0.95))), 3)%&gt;% 
  
  kable(caption = &#39;Odds ratio in US1 hospital (dicotomized)&#39;)%&gt;%
  kable_styling(full_width = F, fixed_thead = T)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Odds ratio in US1 hospital (dicotomized)
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Odds_ratio
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.759
</td>
</tr>
<tr>
<td style="text-align:left;">
Age
</td>
<td style="text-align:right;">
0.980
</td>
<td style="text-align:right;">
0.933
</td>
<td style="text-align:right;">
1.028
</td>
</tr>
<tr>
<td style="text-align:left;">
Sex1
</td>
<td style="text-align:right;">
4.404
</td>
<td style="text-align:right;">
1.613
</td>
<td style="text-align:right;">
12.909
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type2
</td>
<td style="text-align:right;">
3.930
</td>
<td style="text-align:right;">
0.840
</td>
<td style="text-align:right;">
19.547
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type3
</td>
<td style="text-align:right;">
1.482
</td>
<td style="text-align:right;">
0.388
</td>
<td style="text-align:right;">
6.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type4
</td>
<td style="text-align:right;">
11.339
</td>
<td style="text-align:right;">
3.021
</td>
<td style="text-align:right;">
48.624
</td>
</tr>
<tr>
<td style="text-align:left;">
Resting_Blood_Pressure
</td>
<td style="text-align:right;">
1.028
</td>
<td style="text-align:right;">
1.005
</td>
<td style="text-align:right;">
1.052
</td>
</tr>
<tr>
<td style="text-align:left;">
Fasting_Blood_Sugar1
</td>
<td style="text-align:right;">
0.680
</td>
<td style="text-align:right;">
0.217
</td>
<td style="text-align:right;">
2.053
</td>
</tr>
<tr>
<td style="text-align:left;">
Resting_ECG1
</td>
<td style="text-align:right;">
2.681
</td>
<td style="text-align:right;">
0.056
</td>
<td style="text-align:right;">
236.022
</td>
</tr>
<tr>
<td style="text-align:left;">
Resting_ECG2
</td>
<td style="text-align:right;">
1.759
</td>
<td style="text-align:right;">
0.828
</td>
<td style="text-align:right;">
3.815
</td>
</tr>
<tr>
<td style="text-align:left;">
Max_Heart_Rate_Achieved
</td>
<td style="text-align:right;">
0.984
</td>
<td style="text-align:right;">
0.961
</td>
<td style="text-align:right;">
1.006
</td>
</tr>
<tr>
<td style="text-align:left;">
Exercise_Induced_Angina1
</td>
<td style="text-align:right;">
2.052
</td>
<td style="text-align:right;">
0.861
</td>
<td style="text-align:right;">
4.891
</td>
</tr>
<tr>
<td style="text-align:left;">
ST_Depression_Exercise
</td>
<td style="text-align:right;">
1.527
</td>
<td style="text-align:right;">
0.968
</td>
<td style="text-align:right;">
2.474
</td>
</tr>
<tr>
<td style="text-align:left;">
Slope_Peak_Exercise_ST2
</td>
<td style="text-align:right;">
3.613
</td>
<td style="text-align:right;">
1.431
</td>
<td style="text-align:right;">
9.506
</td>
</tr>
<tr>
<td style="text-align:left;">
Slope_Peak_Exercise_ST3
</td>
<td style="text-align:right;">
1.625
</td>
<td style="text-align:right;">
0.235
</td>
<td style="text-align:right;">
9.869
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels1
</td>
<td style="text-align:right;">
9.216
</td>
<td style="text-align:right;">
3.498
</td>
<td style="text-align:right;">
26.080
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels2
</td>
<td style="text-align:right;">
24.533
</td>
<td style="text-align:right;">
5.684
</td>
<td style="text-align:right;">
123.642
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels3
</td>
<td style="text-align:right;">
8.719
</td>
<td style="text-align:right;">
1.707
</td>
<td style="text-align:right;">
61.852
</td>
</tr>
<tr>
<td style="text-align:left;">
Thalassemia6
</td>
<td style="text-align:right;">
1.004
</td>
<td style="text-align:right;">
0.215
</td>
<td style="text-align:right;">
4.890
</td>
</tr>
<tr>
<td style="text-align:left;">
Thalassemia7
</td>
<td style="text-align:right;">
4.103
</td>
<td style="text-align:right;">
1.762
</td>
<td style="text-align:right;">
9.899
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>HD$US1$Age_a = NULL
HD$US1$Age_a [HD$US1$Age &lt;45] = &quot;mid_40s&quot;
HD$US1$Age_a [HD$US1$Age &gt;=45 &amp; HD$US1$Age &lt;= 59] = &quot;late _40-50&quot;
HD$US1$Age_a [HD$US1$Age &gt; 59] = &quot;elderly&quot;
HD$US1$Age_a = factor(HD$US1$Age_a)
HD$US1$Age_a  = relevel(factor(HD$US1$Age_a), ref = &quot;mid_40s&quot;)

table(HD$US1$Age_a )</code></pre>
<pre><code>## 
##     mid_40s     elderly late _40-50 
##          55          91         157</code></pre>
<pre class="r"><code>lm2_US1&lt;- glm(diag_hd~ . -Diagnosis -Age  , data=HD$US1, family = binomial(link = &quot;logit&quot;))
summary(lm2_US1)</code></pre>
<pre><code>## 
## Call:
## glm(formula = diag_hd ~ . - Diagnosis - Age, family = binomial(link = &quot;logit&quot;), 
##     data = HD$US1)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.9536  -0.4745  -0.1266   0.2968   2.9891  
## 
## Coefficients:
##                           Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)              -6.832430   2.538680  -2.691 0.007117 ** 
## Sex1                      1.500438   0.526028   2.852 0.004339 ** 
## Chest_Pain_Type2          1.361290   0.797675   1.707 0.087902 .  
## Chest_Pain_Type3          0.393236   0.694694   0.566 0.571355    
## Chest_Pain_Type4          2.435579   0.700611   3.476 0.000508 ***
## Resting_Blood_Pressure    0.025328   0.011494   2.204 0.027552 *  
## Fasting_Blood_Sugar1     -0.382319   0.573349  -0.667 0.504889    
## Resting_ECG1              0.874282   2.280638   0.383 0.701460    
## Resting_ECG2              0.549693   0.387688   1.418 0.156227    
## Max_Heart_Rate_Achieved  -0.013913   0.011230  -1.239 0.215384    
## Exercise_Induced_Angina1  0.728084   0.440563   1.653 0.098408 .  
## ST_Depression_Exercise    0.435237   0.238585   1.824 0.068116 .  
## Slope_Peak_Exercise_ST2   1.265606   0.480023   2.637 0.008375 ** 
## Slope_Peak_Exercise_ST3   0.480011   0.950295   0.505 0.613476    
## Num_Major_Vessels1        2.163143   0.502139   4.308 1.65e-05 ***
## Num_Major_Vessels2        3.070982   0.772998   3.973 7.10e-05 ***
## Num_Major_Vessels3        2.099731   0.907315   2.314 0.020655 *  
## Thalassemia6             -0.004259   0.792081  -0.005 0.995709    
## Thalassemia7              1.405255   0.438046   3.208 0.001337 ** 
## Age_aelderly             -0.184885   0.657578  -0.281 0.778587    
## Age_alate _40-50         -0.137890   0.546917  -0.252 0.800946    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 417.98  on 302  degrees of freedom
## Residual deviance: 187.83  on 282  degrees of freedom
## AIC: 229.83
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<pre class="r"><code>fit_backward = step(lm2_US1, direction = &quot;backward&quot;)</code></pre>
<pre><code>## Start:  AIC=229.83
## diag_hd ~ (Age + Sex + Chest_Pain_Type + Resting_Blood_Pressure + 
##     Fasting_Blood_Sugar + Resting_ECG + Max_Heart_Rate_Achieved + 
##     Exercise_Induced_Angina + ST_Depression_Exercise + Slope_Peak_Exercise_ST + 
##     Num_Major_Vessels + Thalassemia + Diagnosis + Age_a) - Diagnosis - 
##     Age
## 
##                           Df Deviance    AIC
## - Age_a                    2   187.91 225.91
## - Resting_ECG              2   189.94 227.94
## - Fasting_Blood_Sugar      1   188.28 228.28
## - Max_Heart_Rate_Achieved  1   189.40 229.40
## &lt;none&gt;                         187.83 229.83
## - Exercise_Induced_Angina  1   190.54 230.54
## - ST_Depression_Exercise   1   191.31 231.31
## - Resting_Blood_Pressure   1   192.92 232.92
## - Slope_Peak_Exercise_ST   2   195.41 233.41
## - Sex                      1   196.58 236.58
## - Thalassemia              2   199.97 237.97
## - Chest_Pain_Type          3   210.99 246.99
## - Num_Major_Vessels        3   223.24 259.24
## 
## Step:  AIC=225.91
## diag_hd ~ Sex + Chest_Pain_Type + Resting_Blood_Pressure + Fasting_Blood_Sugar + 
##     Resting_ECG + Max_Heart_Rate_Achieved + Exercise_Induced_Angina + 
##     ST_Depression_Exercise + Slope_Peak_Exercise_ST + Num_Major_Vessels + 
##     Thalassemia
## 
##                           Df Deviance    AIC
## - Resting_ECG              2   189.97 223.97
## - Fasting_Blood_Sugar      1   188.40 224.40
## - Max_Heart_Rate_Achieved  1   189.45 225.45
## &lt;none&gt;                         187.91 225.91
## - Exercise_Induced_Angina  1   190.61 226.61
## - ST_Depression_Exercise   1   191.51 227.51
## - Resting_Blood_Pressure   1   193.02 229.02
## - Slope_Peak_Exercise_ST   2   195.41 229.41
## - Sex                      1   197.00 233.00
## - Thalassemia              2   200.09 234.09
## - Chest_Pain_Type          3   211.35 243.35
## - Num_Major_Vessels        3   224.92 256.92
## 
## Step:  AIC=223.97
## diag_hd ~ Sex + Chest_Pain_Type + Resting_Blood_Pressure + Fasting_Blood_Sugar + 
##     Max_Heart_Rate_Achieved + Exercise_Induced_Angina + ST_Depression_Exercise + 
##     Slope_Peak_Exercise_ST + Num_Major_Vessels + Thalassemia
## 
##                           Df Deviance    AIC
## - Fasting_Blood_Sugar      1   190.47 222.47
## - Max_Heart_Rate_Achieved  1   191.51 223.51
## &lt;none&gt;                         189.97 223.97
## - Exercise_Induced_Angina  1   192.69 224.69
## - ST_Depression_Exercise   1   193.67 225.67
## - Resting_Blood_Pressure   1   196.08 228.08
## - Slope_Peak_Exercise_ST   2   198.19 228.19
## - Thalassemia              2   201.49 231.49
## - Sex                      1   199.51 231.51
## - Chest_Pain_Type          3   213.47 241.47
## - Num_Major_Vessels        3   228.81 256.81
## 
## Step:  AIC=222.47
## diag_hd ~ Sex + Chest_Pain_Type + Resting_Blood_Pressure + Max_Heart_Rate_Achieved + 
##     Exercise_Induced_Angina + ST_Depression_Exercise + Slope_Peak_Exercise_ST + 
##     Num_Major_Vessels + Thalassemia
## 
##                           Df Deviance    AIC
## - Max_Heart_Rate_Achieved  1   192.10 222.10
## &lt;none&gt;                         190.47 222.47
## - Exercise_Induced_Angina  1   192.99 222.99
## - ST_Depression_Exercise   1   194.48 224.48
## - Resting_Blood_Pressure   1   196.22 226.22
## - Slope_Peak_Exercise_ST   2   198.47 226.47
## - Sex                      1   199.79 229.79
## - Thalassemia              2   202.37 230.37
## - Chest_Pain_Type          3   215.94 241.94
## - Num_Major_Vessels        3   228.86 254.86
## 
## Step:  AIC=222.1
## diag_hd ~ Sex + Chest_Pain_Type + Resting_Blood_Pressure + Exercise_Induced_Angina + 
##     ST_Depression_Exercise + Slope_Peak_Exercise_ST + Num_Major_Vessels + 
##     Thalassemia
## 
##                           Df Deviance    AIC
## &lt;none&gt;                         192.10 222.10
## - Exercise_Induced_Angina  1   195.32 223.32
## - ST_Depression_Exercise   1   196.71 224.71
## - Resting_Blood_Pressure   1   197.36 225.36
## - Sex                      1   200.62 228.62
## - Slope_Peak_Exercise_ST   2   203.01 229.01
## - Thalassemia              2   204.45 230.45
## - Chest_Pain_Type          3   220.65 244.65
## - Num_Major_Vessels        3   233.93 257.93</code></pre>
</div>
<div id="us2-3" class="section level3">
<h3>US2</h3>
<p>Age,Num_Major_Vessels1 ,Num_Major_Vessels3 , Thalassemia7 are significant.</p>
<pre class="r"><code>HD$US2$diag_hd = relevel(factor(HD$US2$diag_hd), ref = 1) #likelihood of having hd as reference 

lm_US2&lt;- glm(diag_hd~ . -Diagnosis , data=HD$US2, family = binomial(link = &quot;logit&quot;))
summary(lm_US2)</code></pre>
<pre><code>## 
## Call:
## glm(formula = diag_hd ~ . - Diagnosis, family = binomial(link = &quot;logit&quot;), 
##     data = HD$US2)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.2782  -0.2381   0.2276   0.4363   2.0383  
## 
## Coefficients:
##                          Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)              -8.33236    3.07554  -2.709  0.00674 ** 
## Age                       0.08265    0.03123   2.647  0.00813 ** 
## Sex1                      1.89266    1.20177   1.575  0.11528    
## Chest_Pain_Type2         -1.14186    1.32003  -0.865  0.38702    
## Chest_Pain_Type3         -0.22039    1.11353  -0.198  0.84311    
## Chest_Pain_Type4          0.80715    1.06946   0.755  0.45041    
## Resting_Blood_Pressure   -0.01020    0.01336  -0.764  0.44516    
## Fasting_Blood_Sugar1      0.33977    0.52413   0.648  0.51683    
## Resting_ECG1              0.07689    0.53111   0.145  0.88489    
## Resting_ECG2             -0.12965    0.72166  -0.180  0.85743    
## Max_Heart_Rate_Achieved   0.01100    0.01128   0.975  0.32949    
## Exercise_Induced_Angina1  0.94539    0.53640   1.762  0.07799 .  
## ST_Depression_Exercise    0.37088    0.23792   1.559  0.11903    
## Slope_Peak_Exercise_ST2  -0.59874    0.70370  -0.851  0.39485    
## Slope_Peak_Exercise_ST3  -0.46413    0.77673  -0.598  0.55015    
## Num_Major_Vessels1        2.34536    0.75483   3.107  0.00189 ** 
## Num_Major_Vessels2        1.54270    0.89089   1.732  0.08334 .  
## Num_Major_Vessels3        1.73489    0.78483   2.211  0.02707 *  
## Thalassemia6              1.07249    0.86379   1.242  0.21438    
## Thalassemia7              2.09753    0.53647   3.910 9.24e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 227.10  on 199  degrees of freedom
## Residual deviance: 128.97  on 180  degrees of freedom
## AIC: 168.97
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<pre class="r"><code>round(exp(cbind(Odds_ratio = coef(lm_US2), confint(lm_US2,level = 0.95))), 3)</code></pre>
<pre><code>##                          Odds_ratio 2.5 % 97.5 %
## (Intercept)                   0.000 0.000  0.085
## Age                           1.086 1.024  1.158
## Sex1                          6.637 0.605 76.891
## Chest_Pain_Type2              0.319 0.021  3.998
## Chest_Pain_Type3              0.802 0.083  6.796
## Chest_Pain_Type4              2.242 0.253 17.719
## Resting_Blood_Pressure        0.990 0.964  1.015
## Fasting_Blood_Sugar1          1.405 0.506  4.030
## Resting_ECG1                  1.080 0.379  3.096
## Resting_ECG2                  0.878 0.217  3.765
## Max_Heart_Rate_Achieved       1.011 0.989  1.034
## Exercise_Induced_Angina1      2.574 0.907  7.553
## ST_Depression_Exercise        1.449 0.915  2.348
## Slope_Peak_Exercise_ST2       0.550 0.129  2.084
## Slope_Peak_Exercise_ST3       0.629 0.128  2.786
## Num_Major_Vessels1           10.437 2.710 55.939
## Num_Major_Vessels2            4.677 0.962 36.154
## Num_Major_Vessels3            5.668 1.318 29.562
## Thalassemia6                  2.923 0.554 17.000
## Thalassemia7                  8.146 2.949 24.594</code></pre>
<pre class="r"><code>HD$US2$Age_a = NULL
HD$US2$Age_a [HD$US2$Age &lt;45] = &quot;mid_40s&quot;
HD$US2$Age_a [HD$US2$Age &gt;=45 &amp; HD$US2$Age &lt;= 59] = &quot;late _40-50&quot;
HD$US2$Age_a [HD$US2$Age &gt; 59] = &quot;elderly&quot;
HD$US2$Age_a = factor(HD$US2$Age_a)
HD$US2$Age_a  = relevel(factor(HD$US2$Age_a), ref = &quot;mid_40s&quot;)

table(HD$US2$Age_a )</code></pre>
<pre><code>## 
##     mid_40s     elderly late _40-50 
##          10         105          85</code></pre>
<pre class="r"><code>lm2_US2&lt;- glm(diag_hd~ . -Diagnosis -Age  , data=HD$US2, family = binomial(link = &quot;logit&quot;))
summary(lm2_US2)</code></pre>
<pre><code>## 
## Call:
## glm(formula = diag_hd ~ . - Diagnosis - Age, family = binomial(link = &quot;logit&quot;), 
##     data = HD$US2)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.0217  -0.1412   0.2214   0.4245   1.9508  
## 
## Coefficients:
##                          Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)              -7.19863    2.84086  -2.534  0.01128 *  
## Sex1                      2.23440    1.24090   1.801  0.07176 .  
## Chest_Pain_Type2         -1.47491    1.35510  -1.088  0.27641    
## Chest_Pain_Type3         -0.07324    1.14110  -0.064  0.94883    
## Chest_Pain_Type4          0.88689    1.10279   0.804  0.42127    
## Resting_Blood_Pressure   -0.01284    0.01418  -0.905  0.36542    
## Fasting_Blood_Sugar1      0.37637    0.52881   0.712  0.47663    
## Resting_ECG1             -0.21310    0.55572  -0.383  0.70138    
## Resting_ECG2             -0.29335    0.75047  -0.391  0.69588    
## Max_Heart_Rate_Achieved   0.01450    0.01172   1.237  0.21601    
## Exercise_Induced_Angina1  0.80305    0.53752   1.494  0.13518    
## ST_Depression_Exercise    0.31869    0.24205   1.317  0.18797    
## Slope_Peak_Exercise_ST2  -0.41519    0.70347  -0.590  0.55506    
## Slope_Peak_Exercise_ST3  -0.15003    0.77651  -0.193  0.84680    
## Num_Major_Vessels1        2.53050    0.79763   3.173  0.00151 ** 
## Num_Major_Vessels2        1.30385    0.88658   1.471  0.14139    
## Num_Major_Vessels3        1.76204    0.80026   2.202  0.02768 *  
## Thalassemia6              1.14825    0.87628   1.310  0.19007    
## Thalassemia7              2.38008    0.57861   4.113  3.9e-05 ***
## Age_aelderly              3.71125    1.29171   2.873  0.00406 ** 
## Age_alate _40-50          3.04015    1.27191   2.390  0.01684 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 227.10  on 199  degrees of freedom
## Residual deviance: 125.62  on 179  degrees of freedom
## AIC: 167.62
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<pre class="r"><code>fit_backward = step(lm2_US2, direction = &quot;backward&quot;)</code></pre>
<pre><code>## Start:  AIC=167.62
## diag_hd ~ (Age + Sex + Chest_Pain_Type + Resting_Blood_Pressure + 
##     Fasting_Blood_Sugar + Resting_ECG + Max_Heart_Rate_Achieved + 
##     Exercise_Induced_Angina + ST_Depression_Exercise + Slope_Peak_Exercise_ST + 
##     Num_Major_Vessels + Thalassemia + Diagnosis + Age_a) - Diagnosis - 
##     Age
## 
##                           Df Deviance    AIC
## - Resting_ECG              2   125.83 163.83
## - Slope_Peak_Exercise_ST   2   126.08 164.08
## - Fasting_Blood_Sugar      1   126.13 166.13
## - Resting_Blood_Pressure   1   126.45 166.45
## - Max_Heart_Rate_Achieved  1   127.17 167.17
## - ST_Depression_Exercise   1   127.37 167.37
## &lt;none&gt;                         125.62 167.62
## - Exercise_Induced_Angina  1   127.87 167.87
## - Sex                      1   128.82 168.82
## - Chest_Pain_Type          3   133.09 169.09
## - Age_a                    2   136.65 174.65
## - Num_Major_Vessels        3   142.69 178.69
## - Thalassemia              2   145.64 183.64
## 
## Step:  AIC=163.83
## diag_hd ~ Sex + Chest_Pain_Type + Resting_Blood_Pressure + Fasting_Blood_Sugar + 
##     Max_Heart_Rate_Achieved + Exercise_Induced_Angina + ST_Depression_Exercise + 
##     Slope_Peak_Exercise_ST + Num_Major_Vessels + Thalassemia + 
##     Age_a
## 
##                           Df Deviance    AIC
## - Slope_Peak_Exercise_ST   2   126.20 160.21
## - Fasting_Blood_Sugar      1   126.29 162.29
## - Resting_Blood_Pressure   1   126.66 162.66
## - Max_Heart_Rate_Achieved  1   127.45 163.45
## - ST_Depression_Exercise   1   127.69 163.69
## &lt;none&gt;                         125.83 163.83
## - Exercise_Induced_Angina  1   128.12 164.12
## - Sex                      1   128.92 164.92
## - Chest_Pain_Type          3   133.20 165.20
## - Age_a                    2   136.66 170.66
## - Num_Major_Vessels        3   143.35 175.35
## - Thalassemia              2   145.85 179.85
## 
## Step:  AIC=160.2
## diag_hd ~ Sex + Chest_Pain_Type + Resting_Blood_Pressure + Fasting_Blood_Sugar + 
##     Max_Heart_Rate_Achieved + Exercise_Induced_Angina + ST_Depression_Exercise + 
##     Num_Major_Vessels + Thalassemia + Age_a
## 
##                           Df Deviance    AIC
## - Fasting_Blood_Sugar      1   126.68 158.68
## - Resting_Blood_Pressure   1   127.02 159.01
## - Max_Heart_Rate_Achieved  1   127.86 159.86
## &lt;none&gt;                         126.20 160.21
## - Exercise_Induced_Angina  1   128.28 160.28
## - ST_Depression_Exercise   1   128.36 160.36
## - Sex                      1   129.24 161.24
## - Chest_Pain_Type          3   134.03 162.03
## - Age_a                    2   136.95 166.95
## - Num_Major_Vessels        3   144.63 172.63
## - Thalassemia              2   147.36 177.36
## 
## Step:  AIC=158.68
## diag_hd ~ Sex + Chest_Pain_Type + Resting_Blood_Pressure + Max_Heart_Rate_Achieved + 
##     Exercise_Induced_Angina + ST_Depression_Exercise + Num_Major_Vessels + 
##     Thalassemia + Age_a
## 
##                           Df Deviance    AIC
## - Resting_Blood_Pressure   1   127.42 157.42
## - Max_Heart_Rate_Achieved  1   128.22 158.22
## - Exercise_Induced_Angina  1   128.46 158.46
## &lt;none&gt;                         126.68 158.68
## - ST_Depression_Exercise   1   128.90 158.90
## - Sex                      1   129.69 159.69
## - Chest_Pain_Type          3   134.19 160.19
## - Age_a                    2   137.93 165.93
## - Num_Major_Vessels        3   145.51 171.51
## - Thalassemia              2   148.84 176.84
## 
## Step:  AIC=157.42
## diag_hd ~ Sex + Chest_Pain_Type + Max_Heart_Rate_Achieved + Exercise_Induced_Angina + 
##     ST_Depression_Exercise + Num_Major_Vessels + Thalassemia + 
##     Age_a
## 
##                           Df Deviance    AIC
## - Max_Heart_Rate_Achieved  1   128.66 156.66
## - Exercise_Induced_Angina  1   129.07 157.07
## &lt;none&gt;                         127.42 157.42
## - ST_Depression_Exercise   1   129.50 157.50
## - Sex                      1   130.34 158.34
## - Chest_Pain_Type          3   134.55 158.55
## - Age_a                    2   138.12 164.12
## - Num_Major_Vessels        3   145.81 169.81
## - Thalassemia              2   148.84 174.84
## 
## Step:  AIC=156.66
## diag_hd ~ Sex + Chest_Pain_Type + Exercise_Induced_Angina + ST_Depression_Exercise + 
##     Num_Major_Vessels + Thalassemia + Age_a
## 
##                           Df Deviance    AIC
## - Exercise_Induced_Angina  1   130.36 156.36
## - Chest_Pain_Type          3   134.56 156.56
## &lt;none&gt;                         128.66 156.66
## - ST_Depression_Exercise   1   131.40 157.40
## - Sex                      1   132.12 158.12
## - Age_a                    2   138.50 162.50
## - Num_Major_Vessels        3   146.26 168.26
## - Thalassemia              2   149.38 173.38
## 
## Step:  AIC=156.36
## diag_hd ~ Sex + Chest_Pain_Type + ST_Depression_Exercise + Num_Major_Vessels + 
##     Thalassemia + Age_a
## 
##                          Df Deviance    AIC
## &lt;none&gt;                        130.36 156.36
## - Sex                     1   133.26 157.26
## - Chest_Pain_Type         3   137.61 157.61
## - ST_Depression_Exercise  1   134.38 158.38
## - Age_a                   2   141.09 163.09
## - Num_Major_Vessels       3   149.45 169.45
## - Thalassemia             2   153.13 175.13</code></pre>
</div>
<div id="eu1-3" class="section level3">
<h3>EU1</h3>
<pre class="r"><code>HD$EU1$diag_hd = relevel(factor(HD$EU1$diag_hd), ref = 1) #likelihood of having hd as reference 

lm_EU1&lt;- glm(diag_hd~ . -Diagnosis , data=HD$EU1, family = binomial(link = &quot;logit&quot;))
summary(lm_EU1)</code></pre>
<pre><code>## 
## Call:
## glm(formula = diag_hd ~ . - Diagnosis, family = binomial(link = &quot;logit&quot;), 
##     data = HD$EU1)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.4067  -0.2885  -0.0663   0.1314   2.4787  
## 
## Coefficients:
##                           Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)              -5.236728   3.684075  -1.421  0.15519    
## Age                      -0.012177   0.037084  -0.328  0.74263    
## Sex1                      1.575734   0.613147   2.570  0.01017 *  
## Chest_Pain_Type2         -2.902501   1.110826  -2.613  0.00898 ** 
## Chest_Pain_Type3         -1.235115   1.076021  -1.148  0.25103    
## Chest_Pain_Type4         -0.276072   1.033471  -0.267  0.78937    
## Resting_Blood_Pressure   -0.001465   0.015058  -0.097  0.92247    
## Fasting_Blood_Sugar1      1.189227   1.073343   1.108  0.26788    
## Resting_ECG1             -0.725912   0.642932  -1.129  0.25887    
## Resting_ECG2             -1.310094   4.695659  -0.279  0.78024    
## Max_Heart_Rate_Achieved   0.005800   0.013005   0.446  0.65559    
## Exercise_Induced_Angina1  1.379117   0.618130   2.231  0.02567 *  
## ST_Depression_Exercise    1.083567   0.351036   3.087  0.00202 ** 
## Slope_Peak_Exercise_ST2   1.975288   0.602724   3.277  0.00105 ** 
## Slope_Peak_Exercise_ST3   3.898442   1.455555   2.678  0.00740 ** 
## Num_Major_Vessels1        2.153710   0.675175   3.190  0.00142 ** 
## Num_Major_Vessels2        1.900744   0.732566   2.595  0.00947 ** 
## Num_Major_Vessels3        3.386836   1.210840   2.797  0.00516 ** 
## Thalassemia6              2.260728   0.833977   2.711  0.00671 ** 
## Thalassemia7              2.506118   0.545701   4.592 4.38e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 384.39  on 293  degrees of freedom
## Residual deviance: 126.65  on 274  degrees of freedom
## AIC: 166.65
## 
## Number of Fisher Scoring iterations: 7</code></pre>
<pre class="r"><code>round(exp(cbind(Odds_ratio = coef(lm_EU1), confint(lm_EU1,level = 0.95))), 3)</code></pre>
<pre><code>##                          Odds_ratio 2.5 %  97.5 %
## (Intercept)                   0.005 0.000   6.704
## Age                           0.988 0.917   1.062
## Sex1                          4.834 1.541  17.448
## Chest_Pain_Type2              0.055 0.006   0.490
## Chest_Pain_Type3              0.291 0.035   2.532
## Chest_Pain_Type4              0.759 0.102   6.227
## Resting_Blood_Pressure        0.999 0.969   1.028
## Fasting_Blood_Sugar1          3.285 0.423  27.918
## Resting_ECG1                  0.484 0.129   1.648
## Resting_ECG2                  0.270 0.000  42.996
## Max_Heart_Rate_Achieved       1.006 0.981   1.033
## Exercise_Induced_Angina1      3.971 1.193  13.764
## ST_Depression_Exercise        2.955 1.509   6.053
## Slope_Peak_Exercise_ST2       7.209 2.344  25.563
## Slope_Peak_Exercise_ST3      49.326 2.147 804.766
## Num_Major_Vessels1            8.617 2.402  34.823
## Num_Major_Vessels2            6.691 1.658  30.190
## Num_Major_Vessels3           29.572 3.600 477.140
## Thalassemia6                  9.590 1.958  52.871
## Thalassemia7                 12.257 4.418  38.258</code></pre>
<pre class="r"><code>HD$EU1$Age_a = NULL
HD$EU1$Age_a [HD$EU1$Age &lt;45] = &quot;mid_40s&quot;
HD$EU1$Age_a [HD$EU1$Age &gt;=45 &amp; HD$EU1$Age &lt;= 59] = &quot;late _40-50&quot;
HD$EU1$Age_a [HD$EU1$Age &gt; 59] = &quot;elderly&quot;
HD$EU1$Age_a = factor(HD$EU1$Age_a)
HD$EU1$Age_a  = relevel(factor(HD$EU1$Age_a), ref = &quot;mid_40s&quot;)

table(HD$EU1$Age_a )</code></pre>
<pre><code>## 
##     mid_40s     elderly late _40-50 
##          96          11         187</code></pre>
<pre class="r"><code>lm2_EU1&lt;- glm(diag_hd~ . -Diagnosis -Age  , data=HD$EU1, family = binomial(link = &quot;logit&quot;))
summary(lm2_EU1)</code></pre>
<pre><code>## 
## Call:
## glm(formula = diag_hd ~ . - Diagnosis - Age, family = binomial(link = &quot;logit&quot;), 
##     data = HD$EU1)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -2.34068  -0.26932  -0.06086   0.12049   2.47463  
## 
## Coefficients:
##                           Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)              -6.418430   3.237360  -1.983 0.047411 *  
## Sex1                      1.714967   0.638016   2.688 0.007189 ** 
## Chest_Pain_Type2         -2.869944   1.150518  -2.494 0.012614 *  
## Chest_Pain_Type3         -1.314227   1.132976  -1.160 0.246058    
## Chest_Pain_Type4         -0.222955   1.079852  -0.206 0.836425    
## Resting_Blood_Pressure   -0.006033   0.015376  -0.392 0.694787    
## Fasting_Blood_Sugar1      1.139936   1.113721   1.024 0.306053    
## Resting_ECG1             -0.716091   0.643625  -1.113 0.265885    
## Resting_ECG2             -1.119824   6.077027  -0.184 0.853800    
## Max_Heart_Rate_Achieved   0.010344   0.013437   0.770 0.441429    
## Exercise_Induced_Angina1  1.334852   0.613518   2.176 0.029575 *  
## ST_Depression_Exercise    1.143392   0.364355   3.138 0.001700 ** 
## Slope_Peak_Exercise_ST2   2.076946   0.623864   3.329 0.000871 ***
## Slope_Peak_Exercise_ST3   4.088639   1.465509   2.790 0.005272 ** 
## Num_Major_Vessels1        2.241175   0.696881   3.216 0.001300 ** 
## Num_Major_Vessels2        1.995245   0.759175   2.628 0.008584 ** 
## Num_Major_Vessels3        3.477139   1.200058   2.897 0.003762 ** 
## Thalassemia6              2.287661   0.855910   2.673 0.007522 ** 
## Thalassemia7              2.676854   0.572353   4.677 2.91e-06 ***
## Age_aelderly             -1.410450   1.319564  -1.069 0.285126    
## Age_alate _40-50          0.456913   0.606623   0.753 0.451326    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 384.39  on 293  degrees of freedom
## Residual deviance: 124.25  on 273  degrees of freedom
## AIC: 166.25
## 
## Number of Fisher Scoring iterations: 7</code></pre>
<pre class="r"><code>fit_backward = step(lm2_EU1, direction = &quot;backward&quot;)</code></pre>
<pre><code>## Start:  AIC=166.25
## diag_hd ~ (Age + Sex + Chest_Pain_Type + Resting_Blood_Pressure + 
##     Fasting_Blood_Sugar + Resting_ECG + Max_Heart_Rate_Achieved + 
##     Exercise_Induced_Angina + ST_Depression_Exercise + Slope_Peak_Exercise_ST + 
##     Num_Major_Vessels + Thalassemia + Diagnosis + Age_a) - Diagnosis - 
##     Age
## 
##                           Df Deviance    AIC
## - Resting_ECG              2   125.56 163.56
## - Resting_Blood_Pressure   1   124.41 164.41
## - Age_a                    2   126.76 164.76
## - Max_Heart_Rate_Achieved  1   124.86 164.86
## - Fasting_Blood_Sugar      1   125.33 165.33
## &lt;none&gt;                         124.25 166.25
## - Exercise_Induced_Angina  1   129.07 169.07
## - Sex                      1   132.67 172.67
## - ST_Depression_Exercise   1   134.95 174.95
## - Slope_Peak_Exercise_ST   2   140.60 178.60
## - Chest_Pain_Type          3   145.18 181.18
## - Num_Major_Vessels        3   147.81 183.81
## - Thalassemia              2   153.90 191.90
## 
## Step:  AIC=163.56
## diag_hd ~ Sex + Chest_Pain_Type + Resting_Blood_Pressure + Fasting_Blood_Sugar + 
##     Max_Heart_Rate_Achieved + Exercise_Induced_Angina + ST_Depression_Exercise + 
##     Slope_Peak_Exercise_ST + Num_Major_Vessels + Thalassemia + 
##     Age_a
## 
##                           Df Deviance    AIC
## - Resting_Blood_Pressure   1   125.73 161.73
## - Max_Heart_Rate_Achieved  1   126.22 162.22
## - Age_a                    2   128.35 162.35
## - Fasting_Blood_Sugar      1   126.39 162.39
## &lt;none&gt;                         125.56 163.56
## - Exercise_Induced_Angina  1   130.04 166.04
## - Sex                      1   135.15 171.15
## - ST_Depression_Exercise   1   136.36 172.36
## - Slope_Peak_Exercise_ST   2   140.84 174.84
## - Chest_Pain_Type          3   146.42 178.42
## - Num_Major_Vessels        3   149.22 181.22
## - Thalassemia              2   155.16 189.16
## 
## Step:  AIC=161.73
## diag_hd ~ Sex + Chest_Pain_Type + Fasting_Blood_Sugar + Max_Heart_Rate_Achieved + 
##     Exercise_Induced_Angina + ST_Depression_Exercise + Slope_Peak_Exercise_ST + 
##     Num_Major_Vessels + Thalassemia + Age_a
## 
##                           Df Deviance    AIC
## - Age_a                    2   128.38 160.38
## - Max_Heart_Rate_Achieved  1   126.44 160.44
## - Fasting_Blood_Sugar      1   126.53 160.53
## &lt;none&gt;                         125.73 161.73
## - Exercise_Induced_Angina  1   130.11 164.11
## - Sex                      1   135.38 169.38
## - ST_Depression_Exercise   1   136.56 170.56
## - Slope_Peak_Exercise_ST   2   140.85 172.85
## - Chest_Pain_Type          3   147.69 177.69
## - Num_Major_Vessels        3   149.22 179.22
## - Thalassemia              2   155.51 187.51
## 
## Step:  AIC=160.38
## diag_hd ~ Sex + Chest_Pain_Type + Fasting_Blood_Sugar + Max_Heart_Rate_Achieved + 
##     Exercise_Induced_Angina + ST_Depression_Exercise + Slope_Peak_Exercise_ST + 
##     Num_Major_Vessels + Thalassemia
## 
##                           Df Deviance    AIC
## - Max_Heart_Rate_Achieved  1   128.98 158.98
## - Fasting_Blood_Sugar      1   129.32 159.32
## &lt;none&gt;                         128.38 160.38
## - Exercise_Induced_Angina  1   133.09 163.09
## - Sex                      1   137.60 167.60
## - ST_Depression_Exercise   1   138.53 168.53
## - Slope_Peak_Exercise_ST   2   143.15 171.15
## - Chest_Pain_Type          3   150.08 176.08
## - Num_Major_Vessels        3   150.92 176.92
## - Thalassemia              2   156.44 184.44
## 
## Step:  AIC=158.98
## diag_hd ~ Sex + Chest_Pain_Type + Fasting_Blood_Sugar + Exercise_Induced_Angina + 
##     ST_Depression_Exercise + Slope_Peak_Exercise_ST + Num_Major_Vessels + 
##     Thalassemia
## 
##                           Df Deviance    AIC
## - Fasting_Blood_Sugar      1   129.79 157.79
## &lt;none&gt;                         128.98 158.98
## - Exercise_Induced_Angina  1   133.14 161.14
## - Sex                      1   138.12 166.12
## - ST_Depression_Exercise   1   138.74 166.74
## - Slope_Peak_Exercise_ST   2   143.57 169.57
## - Chest_Pain_Type          3   150.08 174.08
## - Num_Major_Vessels        3   151.12 175.12
## - Thalassemia              2   156.45 182.45
## 
## Step:  AIC=157.79
## diag_hd ~ Sex + Chest_Pain_Type + Exercise_Induced_Angina + ST_Depression_Exercise + 
##     Slope_Peak_Exercise_ST + Num_Major_Vessels + Thalassemia
## 
##                           Df Deviance    AIC
## &lt;none&gt;                         129.79 157.79
## - Exercise_Induced_Angina  1   134.26 160.26
## - Sex                      1   138.96 164.96
## - ST_Depression_Exercise   1   139.54 165.54
## - Slope_Peak_Exercise_ST   2   143.97 167.97
## - Chest_Pain_Type          3   151.29 173.29
## - Num_Major_Vessels        3   155.32 177.32
## - Thalassemia              2   158.44 182.44</code></pre>
</div>
<div id="eu2-3" class="section level3">
<h3>EU2</h3>
<pre class="r"><code>HD$EU2$diag_hd = relevel(factor(HD$EU2$diag_hd), ref = 1) #likelihood of having hd as reference 

lm_EU2&lt;- glm(diag_hd~ . -Diagnosis , data=HD$EU2, family = binomial(link = &quot;logit&quot;))
summary(lm_EU2)</code></pre>
<pre><code>## 
## Call:
## glm(formula = diag_hd ~ . - Diagnosis, family = binomial(link = &quot;logit&quot;), 
##     data = HD$EU2)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -2.37218   0.00000   0.00481   0.09388   1.48694  
## 
## Coefficients:
##                            Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)               3.567e+01  1.436e+04   0.002   0.9980  
## Age                       9.012e-02  1.720e-01   0.524   0.6003  
## Sex1                     -2.090e+01  6.808e+03  -0.003   0.9976  
## Chest_Pain_Type2         -2.266e+01  1.264e+04  -0.002   0.9986  
## Chest_Pain_Type3         -2.181e+01  1.264e+04  -0.002   0.9986  
## Chest_Pain_Type4         -1.808e+01  1.264e+04  -0.001   0.9989  
## Resting_Blood_Pressure   -2.904e-02  5.529e-02  -0.525   0.5994  
## Fasting_Blood_Sugar1      1.738e+01  5.532e+03   0.003   0.9975  
## Resting_ECG1              2.568e+00  2.925e+00   0.878   0.3801  
## Resting_ECG2             -3.622e+00  2.882e+00  -1.257   0.2088  
## Max_Heart_Rate_Achieved   2.098e-02  4.013e-02   0.523   0.6011  
## Exercise_Induced_Angina1  3.995e+00  2.886e+00   1.384   0.1663  
## ST_Depression_Exercise   -1.466e-01  9.555e-01  -0.153   0.8780  
## Slope_Peak_Exercise_ST2   3.288e+00  1.815e+00   1.812   0.0701 .
## Slope_Peak_Exercise_ST3  -4.681e+00  3.661e+00  -1.279   0.2010  
## Num_Major_Vessels1        2.607e+00  2.343e+00   1.113   0.2658  
## Num_Major_Vessels2        1.189e+00  2.258e+00   0.527   0.5984  
## Num_Major_Vessels3        1.491e+01  6.229e+03   0.002   0.9981  
## Thalassemia6              1.876e+01  5.107e+03   0.004   0.9971  
## Thalassemia7              1.631e+00  2.116e+00   0.771   0.4409  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 59.192  on 122  degrees of freedom
## Residual deviance: 24.371  on 103  degrees of freedom
## AIC: 64.371
## 
## Number of Fisher Scoring iterations: 20</code></pre>
<pre class="r"><code>round(exp(cbind(Odds_ratio = coef(lm_EU1), confint(lm_EU2,level = 0.95))), 3)</code></pre>
<pre><code>##                          Odds_ratio 2.5 %        97.5 %
## (Intercept)                   0.005 0.000            NA
## Age                           0.988 0.763  1.622000e+00
## Sex1                          4.834    NA 4.746041e+157
## Chest_Pain_Type2              0.055    NA           Inf
## Chest_Pain_Type3              0.291    NA           Inf
## Chest_Pain_Type4              0.759    NA           Inf
## Resting_Blood_Pressure        0.999 0.860  1.084000e+00
## Fasting_Blood_Sugar1          3.285 0.000            NA
## Resting_ECG1                  0.484 0.151  1.506424e+04
## Resting_ECG2                  0.270 0.000  5.211000e+00
## Max_Heart_Rate_Achieved       1.006 0.948  1.121000e+00
## Exercise_Induced_Angina1      3.971 0.495  7.874464e+04
## ST_Depression_Exercise        2.955 0.134  7.532000e+00
## Slope_Peak_Exercise_ST2       7.209 1.405  3.632473e+03
## Slope_Peak_Exercise_ST3      49.326 0.000  3.755000e+00
## Num_Major_Vessels1            8.617 0.311  5.601721e+03
## Num_Major_Vessels2            6.691 0.085  2.897232e+03
## Num_Major_Vessels3           29.572 0.000            NA
## Thalassemia6                  9.590 0.000            NA
## Thalassemia7                 12.257 0.128  8.676270e+02</code></pre>
<pre class="r"><code>HD$EU2$Age_a = NULL
HD$EU2$Age_a [HD$EU2$Age &lt;45] = &quot;mid_40s&quot;
HD$EU2$Age_a [HD$EU2$Age &gt;=45 &amp; HD$EU2$Age &lt;= 59] = &quot;late _40-50&quot;
HD$EU2$Age_a [HD$EU2$Age &gt; 59] = &quot;elderly&quot;
HD$EU2$Age_a = factor(HD$EU2$Age_a)
HD$EU2$Age_a  = relevel(factor(HD$EU2$Age_a), ref = &quot;mid_40s&quot;)

table(HD$EU2$Age_a )</code></pre>
<pre><code>## 
##     mid_40s     elderly late _40-50 
##          17          46          60</code></pre>
<pre class="r"><code>lm2_EU2&lt;- glm(diag_hd~ . -Diagnosis -Age  , data=HD$EU2, family = binomial(link = &quot;logit&quot;))
summary(lm2_EU2)</code></pre>
<pre><code>## 
## Call:
## glm(formula = diag_hd ~ . - Diagnosis - Age, family = binomial(link = &quot;logit&quot;), 
##     data = HD$EU2)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -2.26295   0.00000   0.00205   0.08197   1.31665  
## 
## Coefficients:
##                            Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)               3.389e+01  1.393e+04   0.002   0.9981  
## Sex1                     -2.124e+01  6.435e+03  -0.003   0.9974  
## Chest_Pain_Type2         -2.270e+01  1.236e+04  -0.002   0.9985  
## Chest_Pain_Type3         -2.169e+01  1.236e+04  -0.002   0.9986  
## Chest_Pain_Type4         -1.798e+01  1.236e+04  -0.001   0.9988  
## Resting_Blood_Pressure   -2.581e-02  6.485e-02  -0.398   0.6906  
## Fasting_Blood_Sugar1      1.738e+01  4.906e+03   0.004   0.9972  
## Resting_ECG1              3.380e+00  3.403e+00   0.993   0.3207  
## Resting_ECG2             -4.660e+00  3.542e+00  -1.316   0.1882  
## Max_Heart_Rate_Achieved   4.266e-02  4.469e-02   0.954   0.3399  
## Exercise_Induced_Angina1  4.747e+00  2.786e+00   1.704   0.0884 .
## ST_Depression_Exercise   -5.355e-01  8.759e-01  -0.611   0.5410  
## Slope_Peak_Exercise_ST2   4.626e+00  2.515e+00   1.839   0.0659 .
## Slope_Peak_Exercise_ST3  -4.117e+00  3.465e+00  -1.188   0.2348  
## Num_Major_Vessels1        3.564e+00  2.767e+00   1.288   0.1977  
## Num_Major_Vessels2        1.210e+00  2.599e+00   0.465   0.6416  
## Num_Major_Vessels3        1.551e+01  5.373e+03   0.003   0.9977  
## Thalassemia6              1.939e+01  4.761e+03   0.004   0.9967  
## Thalassemia7              1.867e+00  1.979e+00   0.943   0.3456  
## Age_aelderly              5.010e+00  4.460e+00   1.123   0.2613  
## Age_alate _40-50          2.435e+00  2.662e+00   0.915   0.3603  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 59.192  on 122  degrees of freedom
## Residual deviance: 23.239  on 102  degrees of freedom
## AIC: 65.239
## 
## Number of Fisher Scoring iterations: 20</code></pre>
<pre class="r"><code>fit_backward = step(lm2_EU2, direction = &quot;backward&quot;)</code></pre>
<pre><code>## Start:  AIC=65.24
## diag_hd ~ (Age + Sex + Chest_Pain_Type + Resting_Blood_Pressure + 
##     Fasting_Blood_Sugar + Resting_ECG + Max_Heart_Rate_Achieved + 
##     Exercise_Induced_Angina + ST_Depression_Exercise + Slope_Peak_Exercise_ST + 
##     Num_Major_Vessels + Thalassemia + Diagnosis + Age_a) - Diagnosis - 
##     Age
## 
##                           Df Deviance    AIC
## - Num_Major_Vessels        3   25.679 61.679
## - Age_a                    2   24.647 62.647
## - Resting_Blood_Pressure   1   23.403 63.403
## - Fasting_Blood_Sugar      1   23.581 63.581
## - ST_Depression_Exercise   1   23.603 63.603
## - Thalassemia              2   25.736 63.736
## - Max_Heart_Rate_Achieved  1   24.261 64.261
## - Resting_ECG              2   26.781 64.781
## &lt;none&gt;                         23.239 65.239
## - Sex                      1   25.380 65.380
## - Exercise_Induced_Angina  1   27.688 67.688
## - Chest_Pain_Type          3   32.123 68.123
## - Slope_Peak_Exercise_ST   2   31.436 69.436
## 
## Step:  AIC=61.68
## diag_hd ~ Sex + Chest_Pain_Type + Resting_Blood_Pressure + Fasting_Blood_Sugar + 
##     Resting_ECG + Max_Heart_Rate_Achieved + Exercise_Induced_Angina + 
##     ST_Depression_Exercise + Slope_Peak_Exercise_ST + Thalassemia + 
##     Age_a
## 
##                           Df Deviance    AIC
## - Age_a                    2   26.316 58.316
## - Thalassemia              2   27.541 59.541
## - Resting_ECG              2   27.830 59.830
## - ST_Depression_Exercise   1   25.902 59.902
## - Max_Heart_Rate_Achieved  1   26.115 60.115
## - Resting_Blood_Pressure   1   26.484 60.484
## &lt;none&gt;                         25.679 61.679
## - Fasting_Blood_Sugar      1   27.968 61.968
## - Sex                      1   28.810 62.810
## - Exercise_Induced_Angina  1   29.476 63.476
## - Slope_Peak_Exercise_ST   2   33.639 65.639
## - Chest_Pain_Type          3   39.605 69.605
## 
## Step:  AIC=58.32
## diag_hd ~ Sex + Chest_Pain_Type + Resting_Blood_Pressure + Fasting_Blood_Sugar + 
##     Resting_ECG + Max_Heart_Rate_Achieved + Exercise_Induced_Angina + 
##     ST_Depression_Exercise + Slope_Peak_Exercise_ST + Thalassemia
## 
##                           Df Deviance    AIC
## - Resting_ECG              2   27.852 55.852
## - ST_Depression_Exercise   1   26.321 56.321
## - Max_Heart_Rate_Achieved  1   26.370 56.370
## - Thalassemia              2   28.476 56.476
## - Resting_Blood_Pressure   1   26.630 56.630
## &lt;none&gt;                         26.316 58.316
## - Fasting_Blood_Sugar      1   28.415 58.415
## - Sex                      1   29.128 59.128
## - Exercise_Induced_Angina  1   29.600 59.600
## - Slope_Peak_Exercise_ST   2   34.354 62.354
## - Chest_Pain_Type          3   40.269 66.269
## 
## Step:  AIC=55.85
## diag_hd ~ Sex + Chest_Pain_Type + Resting_Blood_Pressure + Fasting_Blood_Sugar + 
##     Max_Heart_Rate_Achieved + Exercise_Induced_Angina + ST_Depression_Exercise + 
##     Slope_Peak_Exercise_ST + Thalassemia
## 
##                           Df Deviance    AIC
## - Max_Heart_Rate_Achieved  1   27.857 53.857
## - ST_Depression_Exercise   1   27.862 53.862
## - Thalassemia              2   30.322 54.322
## - Resting_Blood_Pressure   1   28.590 54.590
## &lt;none&gt;                         27.852 55.852
## - Fasting_Blood_Sugar      1   30.661 56.661
## - Exercise_Induced_Angina  1   30.690 56.690
## - Sex                      1   31.472 57.472
## - Slope_Peak_Exercise_ST   2   34.976 58.976
## - Chest_Pain_Type          3   40.919 62.919
## 
## Step:  AIC=53.86
## diag_hd ~ Sex + Chest_Pain_Type + Resting_Blood_Pressure + Fasting_Blood_Sugar + 
##     Exercise_Induced_Angina + ST_Depression_Exercise + Slope_Peak_Exercise_ST + 
##     Thalassemia
## 
##                           Df Deviance    AIC
## - ST_Depression_Exercise   1   27.877 51.877
## - Thalassemia              2   30.551 52.551
## - Resting_Blood_Pressure   1   28.631 52.631
## &lt;none&gt;                         27.857 53.857
## - Fasting_Blood_Sugar      1   31.006 55.006
## - Exercise_Induced_Angina  1   31.707 55.707
## - Sex                      1   31.876 55.876
## - Slope_Peak_Exercise_ST   2   36.541 58.541
## - Chest_Pain_Type          3   40.920 60.920
## 
## Step:  AIC=51.88
## diag_hd ~ Sex + Chest_Pain_Type + Resting_Blood_Pressure + Fasting_Blood_Sugar + 
##     Exercise_Induced_Angina + Slope_Peak_Exercise_ST + Thalassemia
## 
##                           Df Deviance    AIC
## - Thalassemia              2   30.558 50.558
## - Resting_Blood_Pressure   1   28.768 50.768
## &lt;none&gt;                         27.877 51.877
## - Fasting_Blood_Sugar      1   31.027 53.027
## - Exercise_Induced_Angina  1   31.839 53.839
## - Sex                      1   32.030 54.030
## - Slope_Peak_Exercise_ST   2   36.870 56.870
## - Chest_Pain_Type          3   40.920 58.920
## 
## Step:  AIC=50.56
## diag_hd ~ Sex + Chest_Pain_Type + Resting_Blood_Pressure + Fasting_Blood_Sugar + 
##     Exercise_Induced_Angina + Slope_Peak_Exercise_ST
## 
##                           Df Deviance    AIC
## - Resting_Blood_Pressure   1   31.067 49.067
## &lt;none&gt;                         30.558 50.558
## - Fasting_Blood_Sugar      1   33.479 51.479
## - Exercise_Induced_Angina  1   34.303 52.303
## - Sex                      1   34.780 52.780
## - Slope_Peak_Exercise_ST   2   39.347 55.347
## - Chest_Pain_Type          3   43.692 57.692
## 
## Step:  AIC=49.07
## diag_hd ~ Sex + Chest_Pain_Type + Fasting_Blood_Sugar + Exercise_Induced_Angina + 
##     Slope_Peak_Exercise_ST
## 
##                           Df Deviance    AIC
## &lt;none&gt;                         31.067 49.067
## - Fasting_Blood_Sugar      1   33.497 49.497
## - Exercise_Induced_Angina  1   34.328 50.328
## - Sex                      1   34.862 50.862
## - Slope_Peak_Exercise_ST   2   39.635 53.635
## - Chest_Pain_Type          3   43.928 55.928</code></pre>
</div>
<div id="all-dichotomized-1" class="section level3">
<h3>All, dichotomized</h3>
<pre class="r"><code>HD_all$diag_hd = relevel(factor(HD_all$diag_hd), ref = 1) #likelihood of having hd as reference 

lm_all&lt;- glm(diag_hd~ . -Diagnosis , data=HD_all, family = binomial(link = &quot;logit&quot;))
summary(lm_all) </code></pre>
<pre><code>## 
## Call:
## glm(formula = diag_hd ~ . - Diagnosis, family = binomial(link = &quot;logit&quot;), 
##     data = HD_all)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.1616  -0.4387   0.1332   0.4572   2.5495  
## 
## Coefficients:
##                           Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)              -4.921151   1.381024  -3.563 0.000366 ***
## Age                       0.027442   0.012601   2.178 0.029425 *  
## Sex1                      1.105464   0.268228   4.121 3.77e-05 ***
## Chest_Pain_Type2         -0.924617   0.466899  -1.980 0.047666 *  
## Chest_Pain_Type3         -0.276010   0.422291  -0.654 0.513369    
## Chest_Pain_Type4          1.156489   0.405881   2.849 0.004381 ** 
## Resting_Blood_Pressure    0.001398   0.005512   0.254 0.799755    
## Fasting_Blood_Sugar1      0.023621   0.298147   0.079 0.936853    
## Resting_ECG1              0.143527   0.280922   0.511 0.609412    
## Resting_ECG2             -0.000943   0.276860  -0.003 0.997282    
## Max_Heart_Rate_Achieved  -0.003681   0.004693  -0.784 0.432848    
## Exercise_Induced_Angina1  0.855495   0.241057   3.549 0.000387 ***
## ST_Depression_Exercise    0.414445   0.114320   3.625 0.000289 ***
## Slope_Peak_Exercise_ST2   0.837877   0.235792   3.553 0.000380 ***
## Slope_Peak_Exercise_ST3   0.421659   0.382807   1.101 0.270682    
## Num_Major_Vessels1        1.959361   0.272137   7.200 6.03e-13 ***
## Num_Major_Vessels2        1.961557   0.354341   5.536 3.10e-08 ***
## Num_Major_Vessels3        1.988366   0.458157   4.340 1.43e-05 ***
## Thalassemia6              1.164450   0.366262   3.179 0.001476 ** 
## Thalassemia7              1.689525   0.226230   7.468 8.13e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1264.93  on 919  degrees of freedom
## Residual deviance:  605.12  on 900  degrees of freedom
## AIC: 645.12
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<pre class="r"><code>round(exp(cbind(Odds_ratio = coef(lm_all), confint(lm_all,level = 0.95))), 3) %&gt;% 
  kable(caption = &#39;Odds ratio of varameter in All hospital (dicotomized)&#39;)%&gt;%
  kable_styling(full_width = F, fixed_thead = T)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Odds ratio of varameter in All hospital (dicotomized)
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Odds_ratio
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.007
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.107
</td>
</tr>
<tr>
<td style="text-align:left;">
Age
</td>
<td style="text-align:right;">
1.028
</td>
<td style="text-align:right;">
1.003
</td>
<td style="text-align:right;">
1.054
</td>
</tr>
<tr>
<td style="text-align:left;">
Sex1
</td>
<td style="text-align:right;">
3.021
</td>
<td style="text-align:right;">
1.798
</td>
<td style="text-align:right;">
5.156
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type2
</td>
<td style="text-align:right;">
0.397
</td>
<td style="text-align:right;">
0.158
</td>
<td style="text-align:right;">
0.988
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type3
</td>
<td style="text-align:right;">
0.759
</td>
<td style="text-align:right;">
0.331
</td>
<td style="text-align:right;">
1.742
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type4
</td>
<td style="text-align:right;">
3.179
</td>
<td style="text-align:right;">
1.438
</td>
<td style="text-align:right;">
7.098
</td>
</tr>
<tr>
<td style="text-align:left;">
Resting_Blood_Pressure
</td>
<td style="text-align:right;">
1.001
</td>
<td style="text-align:right;">
0.991
</td>
<td style="text-align:right;">
1.012
</td>
</tr>
<tr>
<td style="text-align:left;">
Fasting_Blood_Sugar1
</td>
<td style="text-align:right;">
1.024
</td>
<td style="text-align:right;">
0.571
</td>
<td style="text-align:right;">
1.842
</td>
</tr>
<tr>
<td style="text-align:left;">
Resting_ECG1
</td>
<td style="text-align:right;">
1.154
</td>
<td style="text-align:right;">
0.666
</td>
<td style="text-align:right;">
2.007
</td>
</tr>
<tr>
<td style="text-align:left;">
Resting_ECG2
</td>
<td style="text-align:right;">
0.999
</td>
<td style="text-align:right;">
0.580
</td>
<td style="text-align:right;">
1.722
</td>
</tr>
<tr>
<td style="text-align:left;">
Max_Heart_Rate_Achieved
</td>
<td style="text-align:right;">
0.996
</td>
<td style="text-align:right;">
0.987
</td>
<td style="text-align:right;">
1.006
</td>
</tr>
<tr>
<td style="text-align:left;">
Exercise_Induced_Angina1
</td>
<td style="text-align:right;">
2.353
</td>
<td style="text-align:right;">
1.468
</td>
<td style="text-align:right;">
3.784
</td>
</tr>
<tr>
<td style="text-align:left;">
ST_Depression_Exercise
</td>
<td style="text-align:right;">
1.514
</td>
<td style="text-align:right;">
1.212
</td>
<td style="text-align:right;">
1.899
</td>
</tr>
<tr>
<td style="text-align:left;">
Slope_Peak_Exercise_ST2
</td>
<td style="text-align:right;">
2.311
</td>
<td style="text-align:right;">
1.459
</td>
<td style="text-align:right;">
3.682
</td>
</tr>
<tr>
<td style="text-align:left;">
Slope_Peak_Exercise_ST3
</td>
<td style="text-align:right;">
1.524
</td>
<td style="text-align:right;">
0.723
</td>
<td style="text-align:right;">
3.252
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels1
</td>
<td style="text-align:right;">
7.095
</td>
<td style="text-align:right;">
4.209
</td>
<td style="text-align:right;">
12.256
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels2
</td>
<td style="text-align:right;">
7.110
</td>
<td style="text-align:right;">
3.631
</td>
<td style="text-align:right;">
14.619
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels3
</td>
<td style="text-align:right;">
7.304
</td>
<td style="text-align:right;">
3.110
</td>
<td style="text-align:right;">
18.963
</td>
</tr>
<tr>
<td style="text-align:left;">
Thalassemia6
</td>
<td style="text-align:right;">
3.204
</td>
<td style="text-align:right;">
1.583
</td>
<td style="text-align:right;">
6.678
</td>
</tr>
<tr>
<td style="text-align:left;">
Thalassemia7
</td>
<td style="text-align:right;">
5.417
</td>
<td style="text-align:right;">
3.494
</td>
<td style="text-align:right;">
8.494
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>HD_all$Age_a = NULL
HD_all$Age_a [HD_all$Age &lt;45] = &quot;mid_40s&quot;
HD_all$Age_a [HD_all$Age &gt;=45 &amp; HD_all$Age &lt;= 59] = &quot;late _40-50&quot;
HD_all$Age_a [HD_all$Age &gt; 59] = &quot;elderly&quot;
HD_all$Age_a = factor(HD_all$Age_a)
HD_all$Age_a  = relevel(factor(HD_all$Age_a), ref = &quot;mid_40s&quot;)

table(HD_all$Age_a )</code></pre>
<pre><code>## 
##     mid_40s     elderly late _40-50 
##         178         253         489</code></pre>
<pre class="r"><code>lm_all_2&lt;- glm(diag_hd~ . -Diagnosis -Age  , data=HD_all, family = binomial(link = &quot;logit&quot;))
summary(lm_all_2)</code></pre>
<pre><code>## 
## Call:
## glm(formula = diag_hd ~ . - Diagnosis - Age, family = binomial(link = &quot;logit&quot;), 
##     data = HD_all)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.0978  -0.4342   0.1318   0.4583   2.5047  
## 
## Coefficients:
##                           Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)              -4.001558   1.192790  -3.355 0.000794 ***
## Sex1                      1.130684   0.269731   4.192 2.77e-05 ***
## Chest_Pain_Type2         -0.886519   0.470962  -1.882 0.059788 .  
## Chest_Pain_Type3         -0.244435   0.425435  -0.575 0.565593    
## Chest_Pain_Type4          1.184736   0.409421   2.894 0.003807 ** 
## Resting_Blood_Pressure    0.001787   0.005500   0.325 0.745260    
## Fasting_Blood_Sugar1      0.004316   0.298011   0.014 0.988444    
## Resting_ECG1              0.142885   0.280838   0.509 0.610906    
## Resting_ECG2              0.010129   0.275380   0.037 0.970659    
## Max_Heart_Rate_Achieved  -0.003503   0.004701  -0.745 0.456185    
## Exercise_Induced_Angina1  0.853535   0.241542   3.534 0.000410 ***
## ST_Depression_Exercise    0.412933   0.114013   3.622 0.000293 ***
## Slope_Peak_Exercise_ST2   0.828843   0.236677   3.502 0.000462 ***
## Slope_Peak_Exercise_ST3   0.430726   0.384396   1.121 0.262490    
## Num_Major_Vessels1        1.983356   0.273158   7.261 3.85e-13 ***
## Num_Major_Vessels2        1.930488   0.355563   5.429 5.65e-08 ***
## Num_Major_Vessels3        1.997406   0.459308   4.349 1.37e-05 ***
## Thalassemia6              1.190080   0.366041   3.251 0.001149 ** 
## Thalassemia7              1.703097   0.227156   7.497 6.51e-14 ***
## Age_aelderly              0.834542   0.351688   2.373 0.017646 *  
## Age_alate _40-50          0.362398   0.291360   1.244 0.213567    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1264.93  on 919  degrees of freedom
## Residual deviance:  603.93  on 899  degrees of freedom
## AIC: 645.93
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<pre class="r"><code>fit_backward = step(lm_all_2, direction = &quot;backward&quot;)</code></pre>
<pre><code>## Start:  AIC=645.93
## diag_hd ~ (Age + Sex + Chest_Pain_Type + Resting_Blood_Pressure + 
##     Fasting_Blood_Sugar + Resting_ECG + Max_Heart_Rate_Achieved + 
##     Exercise_Induced_Angina + ST_Depression_Exercise + Slope_Peak_Exercise_ST + 
##     Num_Major_Vessels + Thalassemia + Diagnosis + Age_a) - Diagnosis - 
##     Age
## 
##                           Df Deviance    AIC
## - Resting_ECG              2   604.20 642.20
## - Fasting_Blood_Sugar      1   603.93 643.93
## - Resting_Blood_Pressure   1   604.03 644.03
## - Max_Heart_Rate_Achieved  1   604.48 644.48
## &lt;none&gt;                         603.93 645.93
## - Age_a                    2   609.91 647.91
## - Slope_Peak_Exercise_ST   2   616.46 654.46
## - Exercise_Induced_Angina  1   616.48 656.48
## - ST_Depression_Exercise   1   617.49 657.49
## - Sex                      1   622.40 662.40
## - Chest_Pain_Type          3   664.16 700.16
## - Thalassemia              2   664.70 702.70
## - Num_Major_Vessels        3   691.97 727.97
## 
## Step:  AIC=642.2
## diag_hd ~ Sex + Chest_Pain_Type + Resting_Blood_Pressure + Fasting_Blood_Sugar + 
##     Max_Heart_Rate_Achieved + Exercise_Induced_Angina + ST_Depression_Exercise + 
##     Slope_Peak_Exercise_ST + Num_Major_Vessels + Thalassemia + 
##     Age_a
## 
##                           Df Deviance    AIC
## - Fasting_Blood_Sugar      1   604.20 640.20
## - Resting_Blood_Pressure   1   604.32 640.32
## - Max_Heart_Rate_Achieved  1   604.88 640.88
## &lt;none&gt;                         604.20 642.20
## - Age_a                    2   610.46 644.46
## - Slope_Peak_Exercise_ST   2   616.86 650.86
## - Exercise_Induced_Angina  1   616.81 652.81
## - ST_Depression_Exercise   1   617.69 653.69
## - Sex                      1   622.72 658.72
## - Chest_Pain_Type          3   664.50 696.50
## - Thalassemia              2   664.80 698.80
## - Num_Major_Vessels        3   692.04 724.04
## 
## Step:  AIC=640.2
## diag_hd ~ Sex + Chest_Pain_Type + Resting_Blood_Pressure + Max_Heart_Rate_Achieved + 
##     Exercise_Induced_Angina + ST_Depression_Exercise + Slope_Peak_Exercise_ST + 
##     Num_Major_Vessels + Thalassemia + Age_a
## 
##                           Df Deviance    AIC
## - Resting_Blood_Pressure   1   604.34 638.34
## - Max_Heart_Rate_Achieved  1   604.89 638.89
## &lt;none&gt;                         604.20 640.20
## - Age_a                    2   610.70 642.70
## - Slope_Peak_Exercise_ST   2   616.86 648.86
## - Exercise_Induced_Angina  1   616.81 650.81
## - ST_Depression_Exercise   1   617.73 651.73
## - Sex                      1   622.89 656.89
## - Chest_Pain_Type          3   664.56 694.56
## - Thalassemia              2   665.25 697.25
## - Num_Major_Vessels        3   692.63 722.63
## 
## Step:  AIC=638.34
## diag_hd ~ Sex + Chest_Pain_Type + Max_Heart_Rate_Achieved + Exercise_Induced_Angina + 
##     ST_Depression_Exercise + Slope_Peak_Exercise_ST + Num_Major_Vessels + 
##     Thalassemia + Age_a
## 
##                           Df Deviance    AIC
## - Max_Heart_Rate_Achieved  1   605.01 637.01
## &lt;none&gt;                         604.34 638.34
## - Age_a                    2   611.20 641.20
## - Slope_Peak_Exercise_ST   2   617.07 647.07
## - Exercise_Induced_Angina  1   617.18 649.18
## - ST_Depression_Exercise   1   618.17 650.17
## - Sex                      1   622.93 654.93
## - Chest_Pain_Type          3   664.58 692.58
## - Thalassemia              2   665.37 695.37
## - Num_Major_Vessels        3   692.95 720.95
## 
## Step:  AIC=637.01
## diag_hd ~ Sex + Chest_Pain_Type + Exercise_Induced_Angina + ST_Depression_Exercise + 
##     Slope_Peak_Exercise_ST + Num_Major_Vessels + Thalassemia + 
##     Age_a
## 
##                           Df Deviance    AIC
## &lt;none&gt;                         605.01 637.01
## - Age_a                    2   614.19 642.19
## - Slope_Peak_Exercise_ST   2   619.65 647.65
## - ST_Depression_Exercise   1   618.31 648.31
## - Exercise_Induced_Angina  1   619.37 649.37
## - Sex                      1   624.55 654.55
## - Thalassemia              2   667.38 695.38
## - Chest_Pain_Type          3   670.76 696.76
## - Num_Major_Vessels        3   698.10 724.10</code></pre>
</div>
<div id="all-not-dichotomized-1" class="section level3">
<h3>All not dichotomized</h3>
<pre class="r"><code>lm_all_d&lt;- glm(Diagnosis~ . -diag_hd , data=HD_all, family = binomial(link = &quot;logit&quot;))
summary(lm_all_d)</code></pre>
<pre><code>## 
## Call:
## glm(formula = Diagnosis ~ . - diag_hd, family = binomial(link = &quot;logit&quot;), 
##     data = HD_all)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.1061  -0.4319   0.1317   0.4590   2.5099  
## 
## Coefficients:
##                           Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)              -4.112202   1.566215  -2.626 0.008650 ** 
## Age                       0.002892   0.026513   0.109 0.913146    
## Sex1                      1.129581   0.269855   4.186 2.84e-05 ***
## Chest_Pain_Type2         -0.887314   0.470858  -1.884 0.059503 .  
## Chest_Pain_Type3         -0.245936   0.425544  -0.578 0.563310    
## Chest_Pain_Type4          1.184613   0.409259   2.895 0.003797 ** 
## Resting_Blood_Pressure    0.001725   0.005530   0.312 0.755053    
## Fasting_Blood_Sugar1      0.004113   0.298117   0.014 0.988993    
## Resting_ECG1              0.142006   0.280996   0.505 0.613302    
## Resting_ECG2              0.006554   0.277314   0.024 0.981146    
## Max_Heart_Rate_Achieved  -0.003457   0.004720  -0.732 0.464014    
## Exercise_Induced_Angina1  0.854121   0.241585   3.535 0.000407 ***
## ST_Depression_Exercise    0.412210   0.114223   3.609 0.000308 ***
## Slope_Peak_Exercise_ST2   0.829376   0.236736   3.503 0.000459 ***
## Slope_Peak_Exercise_ST3   0.427922   0.385274   1.111 0.266699    
## Num_Major_Vessels1        1.981954   0.273484   7.247 4.26e-13 ***
## Num_Major_Vessels2        1.931531   0.355682   5.431 5.62e-08 ***
## Num_Major_Vessels3        1.997121   0.459400   4.347 1.38e-05 ***
## Thalassemia6              1.188545   0.366426   3.244 0.001180 ** 
## Thalassemia7              1.702229   0.227271   7.490 6.89e-14 ***
## Age_aelderly              0.763765   0.737922   1.035 0.300659    
## Age_alate _40-50          0.325855   0.443953   0.734 0.462958    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1264.93  on 919  degrees of freedom
## Residual deviance:  603.92  on 898  degrees of freedom
## AIC: 647.92
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<pre class="r"><code>round(exp(cbind(Odds_ratio = coef(lm_all_d), confint(lm_all_d,level = 0.95))), 3) %&gt;% 
  kable(caption = &#39;Odds ratio of varameter in All hospital (dicotomized)&#39;)%&gt;%
  kable_styling(full_width = F, fixed_thead = T)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Odds ratio of varameter in All hospital (dicotomized)
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Odds_ratio
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.016
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
0.346
</td>
</tr>
<tr>
<td style="text-align:left;">
Age
</td>
<td style="text-align:right;">
1.003
</td>
<td style="text-align:right;">
0.952
</td>
<td style="text-align:right;">
1.057
</td>
</tr>
<tr>
<td style="text-align:left;">
Sex1
</td>
<td style="text-align:right;">
3.094
</td>
<td style="text-align:right;">
1.837
</td>
<td style="text-align:right;">
5.300
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type2
</td>
<td style="text-align:right;">
0.412
</td>
<td style="text-align:right;">
0.162
</td>
<td style="text-align:right;">
1.034
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type3
</td>
<td style="text-align:right;">
0.782
</td>
<td style="text-align:right;">
0.339
</td>
<td style="text-align:right;">
1.806
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type4
</td>
<td style="text-align:right;">
3.269
</td>
<td style="text-align:right;">
1.470
</td>
<td style="text-align:right;">
7.349
</td>
</tr>
<tr>
<td style="text-align:left;">
Resting_Blood_Pressure
</td>
<td style="text-align:right;">
1.002
</td>
<td style="text-align:right;">
0.991
</td>
<td style="text-align:right;">
1.013
</td>
</tr>
<tr>
<td style="text-align:left;">
Fasting_Blood_Sugar1
</td>
<td style="text-align:right;">
1.004
</td>
<td style="text-align:right;">
0.560
</td>
<td style="text-align:right;">
1.807
</td>
</tr>
<tr>
<td style="text-align:left;">
Resting_ECG1
</td>
<td style="text-align:right;">
1.153
</td>
<td style="text-align:right;">
0.665
</td>
<td style="text-align:right;">
2.004
</td>
</tr>
<tr>
<td style="text-align:left;">
Resting_ECG2
</td>
<td style="text-align:right;">
1.007
</td>
<td style="text-align:right;">
0.584
</td>
<td style="text-align:right;">
1.736
</td>
</tr>
<tr>
<td style="text-align:left;">
Max_Heart_Rate_Achieved
</td>
<td style="text-align:right;">
0.997
</td>
<td style="text-align:right;">
0.987
</td>
<td style="text-align:right;">
1.006
</td>
</tr>
<tr>
<td style="text-align:left;">
Exercise_Induced_Angina1
</td>
<td style="text-align:right;">
2.349
</td>
<td style="text-align:right;">
1.465
</td>
<td style="text-align:right;">
3.783
</td>
</tr>
<tr>
<td style="text-align:left;">
ST_Depression_Exercise
</td>
<td style="text-align:right;">
1.510
</td>
<td style="text-align:right;">
1.210
</td>
<td style="text-align:right;">
1.895
</td>
</tr>
<tr>
<td style="text-align:left;">
Slope_Peak_Exercise_ST2
</td>
<td style="text-align:right;">
2.292
</td>
<td style="text-align:right;">
1.444
</td>
<td style="text-align:right;">
3.657
</td>
</tr>
<tr>
<td style="text-align:left;">
Slope_Peak_Exercise_ST3
</td>
<td style="text-align:right;">
1.534
</td>
<td style="text-align:right;">
0.724
</td>
<td style="text-align:right;">
3.287
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels1
</td>
<td style="text-align:right;">
7.257
</td>
<td style="text-align:right;">
4.295
</td>
<td style="text-align:right;">
12.571
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels2
</td>
<td style="text-align:right;">
6.900
</td>
<td style="text-align:right;">
3.513
</td>
<td style="text-align:right;">
14.222
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels3
</td>
<td style="text-align:right;">
7.368
</td>
<td style="text-align:right;">
3.131
</td>
<td style="text-align:right;">
19.190
</td>
</tr>
<tr>
<td style="text-align:left;">
Thalassemia6
</td>
<td style="text-align:right;">
3.282
</td>
<td style="text-align:right;">
1.620
</td>
<td style="text-align:right;">
6.842
</td>
</tr>
<tr>
<td style="text-align:left;">
Thalassemia7
</td>
<td style="text-align:right;">
5.486
</td>
<td style="text-align:right;">
3.532
</td>
<td style="text-align:right;">
8.622
</td>
</tr>
<tr>
<td style="text-align:left;">
Age_aelderly
</td>
<td style="text-align:right;">
2.146
</td>
<td style="text-align:right;">
0.507
</td>
<td style="text-align:right;">
9.183
</td>
</tr>
<tr>
<td style="text-align:left;">
Age_alate _40-50
</td>
<td style="text-align:right;">
1.385
</td>
<td style="text-align:right;">
0.581
</td>
<td style="text-align:right;">
3.318
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>fit_backward = step(lm_all_d, direction = &quot;backward&quot;)</code></pre>
<pre><code>## Start:  AIC=647.92
## Diagnosis ~ (Age + Sex + Chest_Pain_Type + Resting_Blood_Pressure + 
##     Fasting_Blood_Sugar + Resting_ECG + Max_Heart_Rate_Achieved + 
##     Exercise_Induced_Angina + ST_Depression_Exercise + Slope_Peak_Exercise_ST + 
##     Num_Major_Vessels + Thalassemia + diag_hd + Age_a) - diag_hd
## 
##                           Df Deviance    AIC
## - Resting_ECG              2   604.18 644.18
## - Age_a                    2   605.12 645.12
## - Fasting_Blood_Sugar      1   603.92 645.92
## - Age                      1   603.93 645.93
## - Resting_Blood_Pressure   1   604.01 646.01
## - Max_Heart_Rate_Achieved  1   604.45 646.45
## &lt;none&gt;                         603.92 647.92
## - Slope_Peak_Exercise_ST   2   616.46 656.46
## - Exercise_Induced_Angina  1   616.48 658.48
## - ST_Depression_Exercise   1   617.36 659.36
## - Sex                      1   622.34 664.34
## - Chest_Pain_Type          3   664.13 702.13
## - Thalassemia              2   664.55 704.55
## - Num_Major_Vessels        3   691.85 729.85
## 
## Step:  AIC=644.18
## Diagnosis ~ Age + Sex + Chest_Pain_Type + Resting_Blood_Pressure + 
##     Fasting_Blood_Sugar + Max_Heart_Rate_Achieved + Exercise_Induced_Angina + 
##     ST_Depression_Exercise + Slope_Peak_Exercise_ST + Num_Major_Vessels + 
##     Thalassemia + Age_a
## 
##                           Df Deviance    AIC
## - Age_a                    2   605.41 641.41
## - Fasting_Blood_Sugar      1   604.19 642.19
## - Age                      1   604.20 642.20
## - Resting_Blood_Pressure   1   604.30 642.30
## - Max_Heart_Rate_Achieved  1   604.85 642.85
## &lt;none&gt;                         604.18 644.18
## - Slope_Peak_Exercise_ST   2   616.86 652.86
## - Exercise_Induced_Angina  1   616.81 654.81
## - ST_Depression_Exercise   1   617.56 655.56
## - Sex                      1   622.67 660.67
## - Chest_Pain_Type          3   664.48 698.48
## - Thalassemia              2   664.66 700.66
## - Num_Major_Vessels        3   691.91 725.91
## 
## Step:  AIC=641.41
## Diagnosis ~ Age + Sex + Chest_Pain_Type + Resting_Blood_Pressure + 
##     Fasting_Blood_Sugar + Max_Heart_Rate_Achieved + Exercise_Induced_Angina + 
##     ST_Depression_Exercise + Slope_Peak_Exercise_ST + Num_Major_Vessels + 
##     Thalassemia
## 
##                           Df Deviance    AIC
## - Fasting_Blood_Sugar      1   605.43 639.43
## - Resting_Blood_Pressure   1   605.49 639.49
## - Max_Heart_Rate_Achieved  1   606.17 640.17
## &lt;none&gt;                         605.41 641.41
## - Age                      1   610.46 644.46
## - Slope_Peak_Exercise_ST   2   618.45 650.45
## - Exercise_Induced_Angina  1   618.13 652.13
## - ST_Depression_Exercise   1   618.89 652.89
## - Sex                      1   623.29 657.29
## - Chest_Pain_Type          3   666.23 696.23
## - Thalassemia              2   665.29 697.29
## - Num_Major_Vessels        3   692.97 722.97
## 
## Step:  AIC=639.43
## Diagnosis ~ Age + Sex + Chest_Pain_Type + Resting_Blood_Pressure + 
##     Max_Heart_Rate_Achieved + Exercise_Induced_Angina + ST_Depression_Exercise + 
##     Slope_Peak_Exercise_ST + Num_Major_Vessels + Thalassemia
## 
##                           Df Deviance    AIC
## - Resting_Blood_Pressure   1   605.52 637.52
## - Max_Heart_Rate_Achieved  1   606.19 638.19
## &lt;none&gt;                         605.43 639.43
## - Age                      1   610.70 642.70
## - Slope_Peak_Exercise_ST   2   618.46 648.46
## - Exercise_Induced_Angina  1   618.13 650.13
## - ST_Depression_Exercise   1   618.95 650.95
## - Sex                      1   623.48 655.48
## - Chest_Pain_Type          3   666.26 694.26
## - Thalassemia              2   665.78 695.78
## - Num_Major_Vessels        3   693.51 721.51
## 
## Step:  AIC=637.52
## Diagnosis ~ Age + Sex + Chest_Pain_Type + Max_Heart_Rate_Achieved + 
##     Exercise_Induced_Angina + ST_Depression_Exercise + Slope_Peak_Exercise_ST + 
##     Num_Major_Vessels + Thalassemia
## 
##                           Df Deviance    AIC
## - Max_Heart_Rate_Achieved  1   606.28 636.28
## &lt;none&gt;                         605.52 637.52
## - Age                      1   611.20 641.20
## - Slope_Peak_Exercise_ST   2   618.60 646.60
## - Exercise_Induced_Angina  1   618.44 648.44
## - ST_Depression_Exercise   1   619.24 649.24
## - Sex                      1   623.51 653.51
## - Chest_Pain_Type          3   666.30 692.30
## - Thalassemia              2   665.85 693.85
## - Num_Major_Vessels        3   693.75 719.75
## 
## Step:  AIC=636.28
## Diagnosis ~ Age + Sex + Chest_Pain_Type + Exercise_Induced_Angina + 
##     ST_Depression_Exercise + Slope_Peak_Exercise_ST + Num_Major_Vessels + 
##     Thalassemia
## 
##                           Df Deviance    AIC
## &lt;none&gt;                         606.28 636.28
## - Age                      1   614.19 642.19
## - ST_Depression_Exercise   1   619.39 647.39
## - Slope_Peak_Exercise_ST   2   621.40 647.40
## - Exercise_Induced_Angina  1   620.85 648.85
## - Sex                      1   625.18 653.18
## - Thalassemia              2   667.84 693.84
## - Chest_Pain_Type          3   672.76 696.76
## - Num_Major_Vessels        3   698.83 722.83</code></pre>
</div>
</div>
<div id="final-generalized-regression-model" class="section level2 tabset">
<h2>Final Generalized Regression Model</h2>
<p>Similarity among all these model of having positive HD:- Male with age above 40 have higher chance of HD.<br />
Most common chest pain- asymptomatic in HD patients.<br />
Resting blood pressure , ST_Depression_Exercise , Slope_Peak_Exercise_ST2 =flat Num_Major_Vessels,Thalassemia6 =‘fixed defect’,Thalassemia7=‘reversible defect’ are significant test.</p>
<div id="us1-4" class="section level3">
<h3>US1</h3>
<p>Signiﬁcant predictors are -[Male, Chest_Pain_Type4=asymptomatic, Resting_Blood_Pressure, Slope_Peak_Exercise_ST2 = flat,Num_Major_Vessels= 1,2,3 , Thalassemia7=‘reversible defect’] for having p-value &lt;0.05, nd for not having 1.0 inside confidence interval. And there odds ratio is closer to higher than 1.0. There are in favour of having heart disease. So being a male, and having asymptomatic- chest pain, having high blood pressure, having flat slope in ST segment excercise test, have colured major blood vessel by flourosopy and having result -reversible defect in Thalassemia test favoures in having heart disease.</p>
<pre class="r"><code>lm_us1_final= glm(diag_hd ~ Sex + Chest_Pain_Type + Resting_Blood_Pressure + Exercise_Induced_Angina + 
    ST_Depression_Exercise + Slope_Peak_Exercise_ST + Num_Major_Vessels + 
    Thalassemia, data=HD$US1, family = binomial(link = &quot;logit&quot;))
summary(lm_us1_final)</code></pre>
<pre><code>## 
## Call:
## glm(formula = diag_hd ~ Sex + Chest_Pain_Type + Resting_Blood_Pressure + 
##     Exercise_Induced_Angina + ST_Depression_Exercise + Slope_Peak_Exercise_ST + 
##     Num_Major_Vessels + Thalassemia, family = binomial(link = &quot;logit&quot;), 
##     data = HD$US1)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.9024  -0.4816  -0.1205   0.3521   2.9877  
## 
## Coefficients:
##                          Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)              -8.76991    1.90306  -4.608 4.06e-06 ***
## Sex1                      1.42484    0.50593   2.816 0.004858 ** 
## Chest_Pain_Type2          1.32502    0.78296   1.692 0.090587 .  
## Chest_Pain_Type3          0.29909    0.68545   0.436 0.662589    
## Chest_Pain_Type4          2.52633    0.68824   3.671 0.000242 ***
## Resting_Blood_Pressure    0.02402    0.01078   2.229 0.025825 *  
## Exercise_Induced_Angina1  0.77365    0.42977   1.800 0.071837 .  
## ST_Depression_Exercise    0.47454    0.22794   2.082 0.037355 *  
## Slope_Peak_Exercise_ST2   1.42737    0.45445   3.141 0.001684 ** 
## Slope_Peak_Exercise_ST3   0.58767    0.89201   0.659 0.510012    
## Num_Major_Vessels1        2.27490    0.48464   4.694 2.68e-06 ***
## Num_Major_Vessels2        2.91035    0.72787   3.998 6.38e-05 ***
## Num_Major_Vessels3        2.22431    0.88501   2.513 0.011960 *  
## Thalassemia6             -0.06729    0.74958  -0.090 0.928468    
## Thalassemia7              1.37023    0.42279   3.241 0.001192 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 417.98  on 302  degrees of freedom
## Residual deviance: 192.10  on 288  degrees of freedom
## AIC: 222.1
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<pre class="r"><code>round(exp(cbind(Odds_ratio = coef(lm_us1_final), confint(lm_us1_final,level = 0.95))), 3)%&gt;% 
  
  kable(caption = &#39;Odds ratio in US1 hospital (final dicotomized)&#39;)%&gt;%
  kable_styling(full_width = F, fixed_thead = T)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Odds ratio in US1 hospital (final dicotomized)
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Odds_ratio
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.005
</td>
</tr>
<tr>
<td style="text-align:left;">
Sex1
</td>
<td style="text-align:right;">
4.157
</td>
<td style="text-align:right;">
1.584
</td>
<td style="text-align:right;">
11.657
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type2
</td>
<td style="text-align:right;">
3.762
</td>
<td style="text-align:right;">
0.826
</td>
<td style="text-align:right;">
18.260
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type3
</td>
<td style="text-align:right;">
1.349
</td>
<td style="text-align:right;">
0.357
</td>
<td style="text-align:right;">
5.367
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type4
</td>
<td style="text-align:right;">
12.507
</td>
<td style="text-align:right;">
3.434
</td>
<td style="text-align:right;">
52.071
</td>
</tr>
<tr>
<td style="text-align:left;">
Resting_Blood_Pressure
</td>
<td style="text-align:right;">
1.024
</td>
<td style="text-align:right;">
1.003
</td>
<td style="text-align:right;">
1.047
</td>
</tr>
<tr>
<td style="text-align:left;">
Exercise_Induced_Angina1
</td>
<td style="text-align:right;">
2.168
</td>
<td style="text-align:right;">
0.930
</td>
<td style="text-align:right;">
5.058
</td>
</tr>
<tr>
<td style="text-align:left;">
ST_Depression_Exercise
</td>
<td style="text-align:right;">
1.607
</td>
<td style="text-align:right;">
1.041
</td>
<td style="text-align:right;">
2.558
</td>
</tr>
<tr>
<td style="text-align:left;">
Slope_Peak_Exercise_ST2
</td>
<td style="text-align:right;">
4.168
</td>
<td style="text-align:right;">
1.743
</td>
<td style="text-align:right;">
10.457
</td>
</tr>
<tr>
<td style="text-align:left;">
Slope_Peak_Exercise_ST3
</td>
<td style="text-align:right;">
1.800
</td>
<td style="text-align:right;">
0.295
</td>
<td style="text-align:right;">
9.927
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels1
</td>
<td style="text-align:right;">
9.727
</td>
<td style="text-align:right;">
3.881
</td>
<td style="text-align:right;">
26.217
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels2
</td>
<td style="text-align:right;">
18.363
</td>
<td style="text-align:right;">
4.710
</td>
<td style="text-align:right;">
82.349
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels3
</td>
<td style="text-align:right;">
9.247
</td>
<td style="text-align:right;">
1.937
</td>
<td style="text-align:right;">
65.571
</td>
</tr>
<tr>
<td style="text-align:left;">
Thalassemia6
</td>
<td style="text-align:right;">
0.935
</td>
<td style="text-align:right;">
0.217
</td>
<td style="text-align:right;">
4.243
</td>
</tr>
<tr>
<td style="text-align:left;">
Thalassemia7
</td>
<td style="text-align:right;">
3.936
</td>
<td style="text-align:right;">
1.737
</td>
<td style="text-align:right;">
9.194
</td>
</tr>
</tbody>
</table>
</div>
<div id="us2-4" class="section level3">
<h3>US2</h3>
<pre class="r"><code>lm_us2_final= glm(diag_hd ~ Sex + Chest_Pain_Type + ST_Depression_Exercise + Num_Major_Vessels +  Thalassemia + Age_a, data=HD$US2, family = binomial(link = &quot;logit&quot;))
summary(lm_us2_final)</code></pre>
<pre><code>## 
## Call:
## glm(formula = diag_hd ~ Sex + Chest_Pain_Type + ST_Depression_Exercise + 
##     Num_Major_Vessels + Thalassemia + Age_a, family = binomial(link = &quot;logit&quot;), 
##     data = HD$US2)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.9666  -0.1572   0.2349   0.4867   1.7610  
## 
## Coefficients:
##                        Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)             -6.8106     2.0258  -3.362 0.000774 ***
## Sex1                     2.0124     1.1596   1.735 0.082656 .  
## Chest_Pain_Type2        -0.8306     1.2235  -0.679 0.497192    
## Chest_Pain_Type3         0.2885     1.0084   0.286 0.774767    
## Chest_Pain_Type4         1.1516     0.9741   1.182 0.237111    
## ST_Depression_Exercise   0.4493     0.2289   1.963 0.049645 *  
## Num_Major_Vessels1       2.5537     0.7469   3.419 0.000628 ***
## Num_Major_Vessels2       1.3481     0.8433   1.598 0.109943    
## Num_Major_Vessels3       1.4983     0.7547   1.985 0.047117 *  
## Thalassemia6             1.0806     0.7474   1.446 0.148233    
## Thalassemia7             2.3345     0.5317   4.391 1.13e-05 ***
## Age_aelderly             3.3364     1.1532   2.893 0.003813 ** 
## Age_alate _40-50         2.6971     1.1197   2.409 0.016009 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 227.10  on 199  degrees of freedom
## Residual deviance: 130.36  on 187  degrees of freedom
## AIC: 156.36
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<pre class="r"><code>round(exp(cbind(Odds_ratio = coef(lm_us2_final), confint(lm_us2_final,level = 0.95))), 3)%&gt;% 
  
  kable(caption = &#39;Odds ratio in US2 hospital (final dicotomized)&#39;)%&gt;%
  kable_styling(full_width = F, fixed_thead = T)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Odds ratio in US2 hospital (final dicotomized)
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Odds_ratio
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.050
</td>
</tr>
<tr>
<td style="text-align:left;">
Sex1
</td>
<td style="text-align:right;">
7.481
</td>
<td style="text-align:right;">
0.729
</td>
<td style="text-align:right;">
77.450
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type2
</td>
<td style="text-align:right;">
0.436
</td>
<td style="text-align:right;">
0.035
</td>
<td style="text-align:right;">
4.506
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type3
</td>
<td style="text-align:right;">
1.334
</td>
<td style="text-align:right;">
0.171
</td>
<td style="text-align:right;">
9.417
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type4
</td>
<td style="text-align:right;">
3.163
</td>
<td style="text-align:right;">
0.433
</td>
<td style="text-align:right;">
20.950
</td>
</tr>
<tr>
<td style="text-align:left;">
ST_Depression_Exercise
</td>
<td style="text-align:right;">
1.567
</td>
<td style="text-align:right;">
1.010
</td>
<td style="text-align:right;">
2.498
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels1
</td>
<td style="text-align:right;">
12.855
</td>
<td style="text-align:right;">
3.422
</td>
<td style="text-align:right;">
68.822
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels2
</td>
<td style="text-align:right;">
3.850
</td>
<td style="text-align:right;">
0.867
</td>
<td style="text-align:right;">
27.576
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels3
</td>
<td style="text-align:right;">
4.474
</td>
<td style="text-align:right;">
1.103
</td>
<td style="text-align:right;">
22.220
</td>
</tr>
<tr>
<td style="text-align:left;">
Thalassemia6
</td>
<td style="text-align:right;">
2.946
</td>
<td style="text-align:right;">
0.704
</td>
<td style="text-align:right;">
13.785
</td>
</tr>
<tr>
<td style="text-align:left;">
Thalassemia7
</td>
<td style="text-align:right;">
10.324
</td>
<td style="text-align:right;">
3.811
</td>
<td style="text-align:right;">
31.266
</td>
</tr>
<tr>
<td style="text-align:left;">
Age_aelderly
</td>
<td style="text-align:right;">
28.117
</td>
<td style="text-align:right;">
3.458
</td>
<td style="text-align:right;">
330.863
</td>
</tr>
<tr>
<td style="text-align:left;">
Age_alate _40-50
</td>
<td style="text-align:right;">
14.836
</td>
<td style="text-align:right;">
1.904
</td>
<td style="text-align:right;">
160.351
</td>
</tr>
</tbody>
</table>
</div>
<div id="eu1-4" class="section level3">
<h3>EU1</h3>
<pre class="r"><code>lm_EU1_final= glm(diag_hd ~ Sex + Chest_Pain_Type + Exercise_Induced_Angina + ST_Depression_Exercise + 
    Slope_Peak_Exercise_ST + Num_Major_Vessels + Thalassemia
, data=HD$EU1, family = binomial(link = &quot;logit&quot;))
summary(lm_EU1_final)</code></pre>
<pre><code>## 
## Call:
## glm(formula = diag_hd ~ Sex + Chest_Pain_Type + Exercise_Induced_Angina + 
##     ST_Depression_Exercise + Slope_Peak_Exercise_ST + Num_Major_Vessels + 
##     Thalassemia, family = binomial(link = &quot;logit&quot;), data = HD$EU1)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -2.65210  -0.28901  -0.07722   0.14955   2.43480  
## 
## Coefficients:
##                          Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)               -5.1447     1.2317  -4.177 2.96e-05 ***
## Sex1                       1.6333     0.5800   2.816 0.004862 ** 
## Chest_Pain_Type2          -2.8510     1.1300  -2.523 0.011638 *  
## Chest_Pain_Type3          -1.1752     1.0872  -1.081 0.279722    
## Chest_Pain_Type4          -0.2646     1.0538  -0.251 0.801764    
## Exercise_Induced_Angina1   1.2530     0.5986   2.093 0.036326 *  
## ST_Depression_Exercise     1.0749     0.3549   3.029 0.002453 ** 
## Slope_Peak_Exercise_ST2    1.7754     0.5698   3.116 0.001835 ** 
## Slope_Peak_Exercise_ST3    3.7641     1.3929   2.702 0.006886 ** 
## Num_Major_Vessels1         2.2545     0.6471   3.484 0.000494 ***
## Num_Major_Vessels2         1.7551     0.7094   2.474 0.013356 *  
## Num_Major_Vessels3         3.6247     1.1852   3.058 0.002225 ** 
## Thalassemia6               2.1280     0.8128   2.618 0.008847 ** 
## Thalassemia7               2.4790     0.5270   4.704 2.55e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 384.39  on 293  degrees of freedom
## Residual deviance: 129.79  on 280  degrees of freedom
## AIC: 157.79
## 
## Number of Fisher Scoring iterations: 7</code></pre>
<pre class="r"><code>round(exp(cbind(Odds_ratio = coef(lm_EU1_final), confint(lm_EU1_final,level = 0.95))), 3)%&gt;% 
  
  kable(caption = &#39;Odds ratio in EU1 hospital (final dicotomized)&#39;)%&gt;%
  kable_styling(full_width = F, fixed_thead = T)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Odds ratio in EU1 hospital (final dicotomized)
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Odds_ratio
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.006
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.054
</td>
</tr>
<tr>
<td style="text-align:left;">
Sex1
</td>
<td style="text-align:right;">
5.121
</td>
<td style="text-align:right;">
1.739
</td>
<td style="text-align:right;">
17.223
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type2
</td>
<td style="text-align:right;">
0.058
</td>
<td style="text-align:right;">
0.006
</td>
<td style="text-align:right;">
0.526
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type3
</td>
<td style="text-align:right;">
0.309
</td>
<td style="text-align:right;">
0.037
</td>
<td style="text-align:right;">
2.727
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type4
</td>
<td style="text-align:right;">
0.768
</td>
<td style="text-align:right;">
0.100
</td>
<td style="text-align:right;">
6.428
</td>
</tr>
<tr>
<td style="text-align:left;">
Exercise_Induced_Angina1
</td>
<td style="text-align:right;">
3.501
</td>
<td style="text-align:right;">
1.095
</td>
<td style="text-align:right;">
11.649
</td>
</tr>
<tr>
<td style="text-align:left;">
ST_Depression_Exercise
</td>
<td style="text-align:right;">
2.930
</td>
<td style="text-align:right;">
1.484
</td>
<td style="text-align:right;">
6.028
</td>
</tr>
<tr>
<td style="text-align:left;">
Slope_Peak_Exercise_ST2
</td>
<td style="text-align:right;">
5.903
</td>
<td style="text-align:right;">
2.022
</td>
<td style="text-align:right;">
19.305
</td>
</tr>
<tr>
<td style="text-align:left;">
Slope_Peak_Exercise_ST3
</td>
<td style="text-align:right;">
43.126
</td>
<td style="text-align:right;">
2.002
</td>
<td style="text-align:right;">
615.915
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels1
</td>
<td style="text-align:right;">
9.530
</td>
<td style="text-align:right;">
2.823
</td>
<td style="text-align:right;">
36.561
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels2
</td>
<td style="text-align:right;">
5.784
</td>
<td style="text-align:right;">
1.494
</td>
<td style="text-align:right;">
24.792
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels3
</td>
<td style="text-align:right;">
37.515
</td>
<td style="text-align:right;">
4.808
</td>
<td style="text-align:right;">
567.269
</td>
</tr>
<tr>
<td style="text-align:left;">
Thalassemia6
</td>
<td style="text-align:right;">
8.398
</td>
<td style="text-align:right;">
1.802
</td>
<td style="text-align:right;">
44.600
</td>
</tr>
<tr>
<td style="text-align:left;">
Thalassemia7
</td>
<td style="text-align:right;">
11.930
</td>
<td style="text-align:right;">
4.440
</td>
<td style="text-align:right;">
35.672
</td>
</tr>
</tbody>
</table>
</div>
<div id="eu2-4" class="section level3">
<h3>EU2</h3>
<pre class="r"><code>lm_EU2_final= glm(diag_hd ~ Sex + Chest_Pain_Type + Fasting_Blood_Sugar + Exercise_Induced_Angina +  Slope_Peak_Exercise_ST
, data=HD$EU2, family = binomial(link = &quot;logit&quot;))
summary(lm_EU2_final)</code></pre>
<pre><code>## 
## Call:
## glm(formula = diag_hd ~ Sex + Chest_Pain_Type + Fasting_Blood_Sugar + 
##     Exercise_Induced_Angina + Slope_Peak_Exercise_ST, family = binomial(link = &quot;logit&quot;), 
##     data = HD$EU2)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -2.42169   0.00009   0.10943   0.24903   1.54234  
## 
## Coefficients:
##                          Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)                38.574   9297.622   0.004   0.9967  
## Sex1                      -19.367   4717.635  -0.004   0.9967  
## Chest_Pain_Type2          -19.125   8011.847  -0.002   0.9981  
## Chest_Pain_Type3          -20.034   8011.847  -0.003   0.9980  
## Chest_Pain_Type4          -16.330   8011.847  -0.002   0.9984  
## Fasting_Blood_Sugar1       18.367   3901.735   0.005   0.9962  
## Exercise_Induced_Angina1    2.238      1.414   1.582   0.1136  
## Slope_Peak_Exercise_ST2     2.047      1.183   1.730   0.0836 .
## Slope_Peak_Exercise_ST3    -2.745      1.634  -1.680   0.0930 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 59.192  on 122  degrees of freedom
## Residual deviance: 31.067  on 114  degrees of freedom
## AIC: 49.067
## 
## Number of Fisher Scoring iterations: 19</code></pre>
<pre class="r"><code>round(exp(cbind(Odds_ratio = coef(lm_EU2_final), confint(lm_EU2_final,level = 0.95))), 3)%&gt;% 
  
  kable(caption = &#39;Odds ratio in EU2 hospital (final dicotomized)&#39;)%&gt;%
  kable_styling(full_width = F, fixed_thead = T)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Odds ratio in EU2 hospital (final dicotomized)
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Odds_ratio
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
5.654021e+16
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Sex1
</td>
<td style="text-align:right;">
0.000000e+00
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
2.382084e+169
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type2
</td>
<td style="text-align:right;">
0.000000e+00
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
Inf
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type3
</td>
<td style="text-align:right;">
0.000000e+00
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
Inf
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type4
</td>
<td style="text-align:right;">
0.000000e+00
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
6.933183e+294
</td>
</tr>
<tr>
<td style="text-align:left;">
Fasting_Blood_Sugar1
</td>
<td style="text-align:right;">
9.476726e+07
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Exercise_Induced_Angina1
</td>
<td style="text-align:right;">
9.370000e+00
</td>
<td style="text-align:right;">
0.840
</td>
<td style="text-align:right;">
3.234840e+02
</td>
</tr>
<tr>
<td style="text-align:left;">
Slope_Peak_Exercise_ST2
</td>
<td style="text-align:right;">
7.743000e+00
</td>
<td style="text-align:right;">
0.911
</td>
<td style="text-align:right;">
1.151510e+02
</td>
</tr>
<tr>
<td style="text-align:left;">
Slope_Peak_Exercise_ST3
</td>
<td style="text-align:right;">
6.400000e-02
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
1.352000e+00
</td>
</tr>
</tbody>
</table>
</div>
<div id="all-dichotomized-2" class="section level3">
<h3>All, dichotomized</h3>
<pre class="r"><code>lm_all_final= glm(diag_hd ~ Sex + Chest_Pain_Type + Exercise_Induced_Angina + ST_Depression_Exercise +  Slope_Peak_Exercise_ST + Num_Major_Vessels + Thalassemia + 
    Age_a
, data=HD_all, family = binomial(link = &quot;logit&quot;))
summary(lm_all_final)</code></pre>
<pre><code>## 
## Call:
## glm(formula = diag_hd ~ Sex + Chest_Pain_Type + Exercise_Induced_Angina + 
##     ST_Depression_Exercise + Slope_Peak_Exercise_ST + Num_Major_Vessels + 
##     Thalassemia + Age_a, family = binomial(link = &quot;logit&quot;), data = HD_all)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.0955  -0.4409   0.1328   0.4581   2.4804  
## 
## Coefficients:
##                          Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)               -4.3869     0.5487  -7.995 1.29e-15 ***
## Sex1                       1.1530     0.2678   4.305 1.67e-05 ***
## Chest_Pain_Type2          -0.8779     0.4665  -1.882 0.059867 .  
## Chest_Pain_Type3          -0.2398     0.4237  -0.566 0.571428    
## Chest_Pain_Type4           1.2192     0.4040   3.018 0.002545 ** 
## Exercise_Induced_Angina1   0.8937     0.2369   3.773 0.000161 ***
## ST_Depression_Exercise     0.4031     0.1123   3.591 0.000330 ***
## Slope_Peak_Exercise_ST2    0.8767     0.2310   3.796 0.000147 ***
## Slope_Peak_Exercise_ST3    0.4906     0.3774   1.300 0.193589    
## Num_Major_Vessels1         2.0111     0.2707   7.430 1.08e-13 ***
## Num_Major_Vessels2         1.9445     0.3533   5.504 3.72e-08 ***
## Num_Major_Vessels3         2.0332     0.4537   4.482 7.41e-06 ***
## Thalassemia6               1.2261     0.3629   3.379 0.000728 ***
## Thalassemia7               1.7096     0.2257   7.575 3.58e-14 ***
## Age_aelderly               0.9528     0.3202   2.975 0.002926 ** 
## Age_alate _40-50           0.4446     0.2748   1.618 0.105676    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1264.93  on 919  degrees of freedom
## Residual deviance:  605.01  on 904  degrees of freedom
## AIC: 637.01
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<pre class="r"><code>round(exp(cbind(Odds_ratio = coef(lm_all_final), confint(lm_all_final,level = 0.95))), 3)%&gt;% 
  
  kable(caption = &#39;Odds ratio in All hospital combined (final dicotomized)&#39;)%&gt;%
  kable_styling(full_width = F, fixed_thead = T)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Odds ratio in All hospital combined (final dicotomized)
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Odds_ratio
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.012
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
0.035
</td>
</tr>
<tr>
<td style="text-align:left;">
Sex1
</td>
<td style="text-align:right;">
3.168
</td>
<td style="text-align:right;">
1.888
</td>
<td style="text-align:right;">
5.404
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type2
</td>
<td style="text-align:right;">
0.416
</td>
<td style="text-align:right;">
0.165
</td>
<td style="text-align:right;">
1.034
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type3
</td>
<td style="text-align:right;">
0.787
</td>
<td style="text-align:right;">
0.342
</td>
<td style="text-align:right;">
1.809
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type4
</td>
<td style="text-align:right;">
3.384
</td>
<td style="text-align:right;">
1.534
</td>
<td style="text-align:right;">
7.517
</td>
</tr>
<tr>
<td style="text-align:left;">
Exercise_Induced_Angina1
</td>
<td style="text-align:right;">
2.444
</td>
<td style="text-align:right;">
1.539
</td>
<td style="text-align:right;">
3.901
</td>
</tr>
<tr>
<td style="text-align:left;">
ST_Depression_Exercise
</td>
<td style="text-align:right;">
1.496
</td>
<td style="text-align:right;">
1.203
</td>
<td style="text-align:right;">
1.870
</td>
</tr>
<tr>
<td style="text-align:left;">
Slope_Peak_Exercise_ST2
</td>
<td style="text-align:right;">
2.403
</td>
<td style="text-align:right;">
1.531
</td>
<td style="text-align:right;">
3.792
</td>
</tr>
<tr>
<td style="text-align:left;">
Slope_Peak_Exercise_ST3
</td>
<td style="text-align:right;">
1.633
</td>
<td style="text-align:right;">
0.783
</td>
<td style="text-align:right;">
3.449
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels1
</td>
<td style="text-align:right;">
7.471
</td>
<td style="text-align:right;">
4.447
</td>
<td style="text-align:right;">
12.873
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels2
</td>
<td style="text-align:right;">
6.990
</td>
<td style="text-align:right;">
3.576
</td>
<td style="text-align:right;">
14.343
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels3
</td>
<td style="text-align:right;">
7.638
</td>
<td style="text-align:right;">
3.284
</td>
<td style="text-align:right;">
19.678
</td>
</tr>
<tr>
<td style="text-align:left;">
Thalassemia6
</td>
<td style="text-align:right;">
3.408
</td>
<td style="text-align:right;">
1.695
</td>
<td style="text-align:right;">
7.058
</td>
</tr>
<tr>
<td style="text-align:left;">
Thalassemia7
</td>
<td style="text-align:right;">
5.527
</td>
<td style="text-align:right;">
3.569
</td>
<td style="text-align:right;">
8.658
</td>
</tr>
<tr>
<td style="text-align:left;">
Age_aelderly
</td>
<td style="text-align:right;">
2.593
</td>
<td style="text-align:right;">
1.391
</td>
<td style="text-align:right;">
4.890
</td>
</tr>
<tr>
<td style="text-align:left;">
Age_alate _40-50
</td>
<td style="text-align:right;">
1.560
</td>
<td style="text-align:right;">
0.912
</td>
<td style="text-align:right;">
2.684
</td>
</tr>
</tbody>
</table>
</div>
<div id="all-not-dichotomized-2" class="section level3">
<h3>All, not dichotomized</h3>
<pre class="r"><code>lm_all_final_d= glm(Diagnosis ~ Sex + Chest_Pain_Type + Exercise_Induced_Angina + 
    ST_Depression_Exercise + Slope_Peak_Exercise_ST + Num_Major_Vessels + 
    Thalassemia + Age_a
, data=HD_all, family = binomial(link = &quot;logit&quot;))
summary(lm_all_final_d)</code></pre>
<pre><code>## 
## Call:
## glm(formula = Diagnosis ~ Sex + Chest_Pain_Type + Exercise_Induced_Angina + 
##     ST_Depression_Exercise + Slope_Peak_Exercise_ST + Num_Major_Vessels + 
##     Thalassemia + Age_a, family = binomial(link = &quot;logit&quot;), data = HD_all)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.0955  -0.4409   0.1328   0.4581   2.4804  
## 
## Coefficients:
##                          Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)               -4.3869     0.5487  -7.995 1.29e-15 ***
## Sex1                       1.1530     0.2678   4.305 1.67e-05 ***
## Chest_Pain_Type2          -0.8779     0.4665  -1.882 0.059867 .  
## Chest_Pain_Type3          -0.2398     0.4237  -0.566 0.571428    
## Chest_Pain_Type4           1.2192     0.4040   3.018 0.002545 ** 
## Exercise_Induced_Angina1   0.8937     0.2369   3.773 0.000161 ***
## ST_Depression_Exercise     0.4031     0.1123   3.591 0.000330 ***
## Slope_Peak_Exercise_ST2    0.8767     0.2310   3.796 0.000147 ***
## Slope_Peak_Exercise_ST3    0.4906     0.3774   1.300 0.193589    
## Num_Major_Vessels1         2.0111     0.2707   7.430 1.08e-13 ***
## Num_Major_Vessels2         1.9445     0.3533   5.504 3.72e-08 ***
## Num_Major_Vessels3         2.0332     0.4537   4.482 7.41e-06 ***
## Thalassemia6               1.2261     0.3629   3.379 0.000728 ***
## Thalassemia7               1.7096     0.2257   7.575 3.58e-14 ***
## Age_aelderly               0.9528     0.3202   2.975 0.002926 ** 
## Age_alate _40-50           0.4446     0.2748   1.618 0.105676    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1264.93  on 919  degrees of freedom
## Residual deviance:  605.01  on 904  degrees of freedom
## AIC: 637.01
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<pre class="r"><code>round(exp(cbind(Odds_ratio = coef(lm_all_final_d), confint(lm_all_final_d,level = 0.95))), 3)%&gt;% 
  
  kable(caption = &#39;Odds ratio in US2 hospital (final not dicotomized)&#39;)%&gt;%
  kable_styling(full_width = F, fixed_thead = T)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Odds ratio in US2 hospital (final not dicotomized)
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Odds_ratio
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.012
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
0.035
</td>
</tr>
<tr>
<td style="text-align:left;">
Sex1
</td>
<td style="text-align:right;">
3.168
</td>
<td style="text-align:right;">
1.888
</td>
<td style="text-align:right;">
5.404
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type2
</td>
<td style="text-align:right;">
0.416
</td>
<td style="text-align:right;">
0.165
</td>
<td style="text-align:right;">
1.034
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type3
</td>
<td style="text-align:right;">
0.787
</td>
<td style="text-align:right;">
0.342
</td>
<td style="text-align:right;">
1.809
</td>
</tr>
<tr>
<td style="text-align:left;">
Chest_Pain_Type4
</td>
<td style="text-align:right;">
3.384
</td>
<td style="text-align:right;">
1.534
</td>
<td style="text-align:right;">
7.517
</td>
</tr>
<tr>
<td style="text-align:left;">
Exercise_Induced_Angina1
</td>
<td style="text-align:right;">
2.444
</td>
<td style="text-align:right;">
1.539
</td>
<td style="text-align:right;">
3.901
</td>
</tr>
<tr>
<td style="text-align:left;">
ST_Depression_Exercise
</td>
<td style="text-align:right;">
1.496
</td>
<td style="text-align:right;">
1.203
</td>
<td style="text-align:right;">
1.870
</td>
</tr>
<tr>
<td style="text-align:left;">
Slope_Peak_Exercise_ST2
</td>
<td style="text-align:right;">
2.403
</td>
<td style="text-align:right;">
1.531
</td>
<td style="text-align:right;">
3.792
</td>
</tr>
<tr>
<td style="text-align:left;">
Slope_Peak_Exercise_ST3
</td>
<td style="text-align:right;">
1.633
</td>
<td style="text-align:right;">
0.783
</td>
<td style="text-align:right;">
3.449
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels1
</td>
<td style="text-align:right;">
7.471
</td>
<td style="text-align:right;">
4.447
</td>
<td style="text-align:right;">
12.873
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels2
</td>
<td style="text-align:right;">
6.990
</td>
<td style="text-align:right;">
3.576
</td>
<td style="text-align:right;">
14.343
</td>
</tr>
<tr>
<td style="text-align:left;">
Num_Major_Vessels3
</td>
<td style="text-align:right;">
7.638
</td>
<td style="text-align:right;">
3.284
</td>
<td style="text-align:right;">
19.678
</td>
</tr>
<tr>
<td style="text-align:left;">
Thalassemia6
</td>
<td style="text-align:right;">
3.408
</td>
<td style="text-align:right;">
1.695
</td>
<td style="text-align:right;">
7.058
</td>
</tr>
<tr>
<td style="text-align:left;">
Thalassemia7
</td>
<td style="text-align:right;">
5.527
</td>
<td style="text-align:right;">
3.569
</td>
<td style="text-align:right;">
8.658
</td>
</tr>
<tr>
<td style="text-align:left;">
Age_aelderly
</td>
<td style="text-align:right;">
2.593
</td>
<td style="text-align:right;">
1.391
</td>
<td style="text-align:right;">
4.890
</td>
</tr>
<tr>
<td style="text-align:left;">
Age_alate _40-50
</td>
<td style="text-align:right;">
1.560
</td>
<td style="text-align:right;">
0.912
</td>
<td style="text-align:right;">
2.684
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="roc-plot" class="section level2 tabset">
<h2>Roc Plot</h2>
<p>Most of the GLM models does do a good job in predicting HD. AUC= 0.89 or closer to 1 meaning it a good measure of separation. It is good in predicting HD with/without. Overall dichotomized full model has 93% chance that model will be able to distinguish between positive case and negative case. Roc curve is left facing with more on the left upper side. Its an good curve. Only US2 has lower value comparatively.</p>
<div id="us1-5" class="section level3">
<h3>US1</h3>
<pre class="r"><code>roc(HD$US1$diag_hd, lm_us1_final$fitted.values)</code></pre>
<pre><code>## 
## Call:
## roc.default(response = HD$US1$diag_hd, predictor = lm_us1_final$fitted.values)
## 
## Data: lm_us1_final$fitted.values in 164 controls (HD$US1$diag_hd 0) &lt; 139 cases (HD$US1$diag_hd 1).
## Area under the curve: 0.9362</code></pre>
<pre class="r"><code>rocplot = function(truth, pred,tit,  ...) {
  predob = prediction(pred, truth)
  perf = performance(predob, &quot;tpr&quot;, &quot;fpr&quot;)
  plot(perf, ...)
  area = auc(truth, pred)
  area = format(round(area, 4), nsmall = 4)
  text(x=0.8, y=0.1, labels = paste(&quot;AUC =&quot;, area))
  title(tit)
  
  # the reference x=y line
  segments(x0=0, y0=0, x1=1, y1=1, col=&quot;gray&quot;, lty=2)
}

rocplot(HD$US1$diag_hd, lm_us1_final$fitted.values, &#39;US1&#39;)</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
<div id="us2-5" class="section level3">
<h3>US2</h3>
<pre class="r"><code>roc(HD$US2$diag_hd, lm_us2_final$fitted.values)</code></pre>
<pre><code>## 
## Call:
## roc.default(response = HD$US2$diag_hd, predictor = lm_us2_final$fitted.values)
## 
## Data: lm_us2_final$fitted.values in 51 controls (HD$US2$diag_hd 0) &lt; 149 cases (HD$US2$diag_hd 1).
## Area under the curve: 0.8981</code></pre>
<pre class="r"><code>rocplot(HD$US2$diag_hd, lm_us2_final$fitted.values, &#39;US2&#39;)</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
</div>
<div id="eu1-5" class="section level3">
<h3>EU1</h3>
<pre class="r"><code>roc(HD$EU1$diag_hd, lm_EU1_final$fitted.values)</code></pre>
<pre><code>## 
## Call:
## roc.default(response = HD$EU1$diag_hd, predictor = lm_EU1_final$fitted.values)
## 
## Data: lm_EU1_final$fitted.values in 188 controls (HD$EU1$diag_hd 0) &lt; 106 cases (HD$EU1$diag_hd 1).
## Area under the curve: 0.9683</code></pre>
<pre class="r"><code>rocplot(HD$EU1$diag_hd, lm_EU1_final$fitted.values, &#39;EU1&#39;)</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
<div id="eu2-5" class="section level3">
<h3>EU2</h3>
<pre class="r"><code>roc(HD$EU2$diag_hd, lm_EU2_final$fitted.values)</code></pre>
<pre><code>## 
## Call:
## roc.default(response = HD$EU2$diag_hd, predictor = lm_EU2_final$fitted.values)
## 
## Data: lm_EU2_final$fitted.values in 8 controls (HD$EU2$diag_hd 0) &lt; 115 cases (HD$EU2$diag_hd 1).
## Area under the curve: 0.9473</code></pre>
<pre class="r"><code>rocplot(HD$EU2$diag_hd, lm_EU2_final$fitted.values, &#39;EU2&#39;)</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
</div>
<div id="all-dichotomize" class="section level3">
<h3>All Dichotomize</h3>
<pre class="r"><code>roc(HD_all$diag_hd, lm_all_final$fitted.values)</code></pre>
<pre><code>## 
## Call:
## roc.default(response = HD_all$diag_hd, predictor = lm_all_final$fitted.values)
## 
## Data: lm_all_final$fitted.values in 411 controls (HD_all$diag_hd 0) &lt; 509 cases (HD_all$diag_hd 1).
## Area under the curve: 0.9322</code></pre>
<pre class="r"><code>rocplot(HD_all$diag_hd, lm_all_final$fitted.values, &#39;ALL&#39;)</code></pre>
<p><img src="heart_disease_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
</div>
<div id="all-not-dichotomize" class="section level3">
<h3>All Not Dichotomize</h3>
<pre class="r"><code>roc(HD_all$Diagnosis, lm_all_final_d$fitted.values)</code></pre>
<pre><code>## 
## Call:
## roc.default(response = HD_all$Diagnosis, predictor = lm_all_final_d$fitted.values)
## 
## Data: lm_all_final_d$fitted.values in 411 controls (HD_all$Diagnosis 0) &lt; 196 cases (HD_all$Diagnosis 1).
## Area under the curve: 0.8864</code></pre>
<pre class="r"><code>#rocplot(HD_all$Diagnosis, lm_all_final_d$fitted.values, &#39;All&#39;)

#(HD_all$Diagnosis, lm_all_final_d$fitted.values)</code></pre>
</div>
</div>
<div id="result" class="section level2 tabset">
<h2>Result</h2>
<p>The similarity found among heart disease patients are:- • Most of them were male.<br />
• Aged between 49 to 60.<br />
• Have asymptomatic chest pain.<br />
• The fasting glucose test was irrelevant.<br />
• Resting ECG test also seemed insignificant.<br />
• Most of them had exercise-induced angina present (absent in non-HD patients ).<br />
• They got ‘Flat’ slope in ST-segment exercises but in a few hospitals, it seemed not significant. (have mixed result of non-HD patient)<br />
• Most of the patients with HD get ‘reversible defect’ in the Thalassemia test.<br />
• Have high blood pressure around (mean)134 bp. Non-HD have lower bp comparatively.<br />
• Their max heart rate achieved on the Thallium stress test is around 127(mean, SD=24.1). It’s usually much lower than non-HD patients. • They have higher results (mean =1.26) in ST depression exercise compared to non-HD patients. It’s usually higher than 1 unit.<br />
• Colored vessel by fluoroscopy test is significant, if the patient has heart disease then 70% of the time it will be found through this. Only 30% of heart disease did not have colored vessels in the test.<br />
• All of the ROC curve and model were significant. • Thal, Thalanch, ST depression ecercise, ST slope peak exercise, Resting blood pressure, color Num_Major_Vessels,Thalassemia test are significant.</p>
<p>Since these are significant there cost can be reduced to reasonable amount.</p>
<pre class="r"><code>Test&lt;- c(&quot;cp&quot;,&quot;trestbps&quot;,&quot;fbs&quot;,&quot;restecg&quot;,&quot;thalach&quot;,&quot;exang&quot;, &quot;oldpeak&quot;,&quot;slope&quot;,&quot;ca&quot;,&quot;thal&quot;)
cost&lt;-c(0,0,5.20, 15.50, 102.90, 87.30, 87.30, 87.30, 100.90, 102.90)


new&lt;- c(0, 0, 5.20, 15.50, 70, 87.3 , 60, 60, 80, 80)
costs&lt;- data.frame(Test,cost, new)
costs</code></pre>
<pre><code>##        Test  cost  new
## 1        cp   0.0  0.0
## 2  trestbps   0.0  0.0
## 3       fbs   5.2  5.2
## 4   restecg  15.5 15.5
## 5   thalach 102.9 70.0
## 6     exang  87.3 87.3
## 7   oldpeak  87.3 60.0
## 8     slope  87.3 60.0
## 9        ca 100.9 80.0
## 10     thal 102.9 80.0</code></pre>
</div>
<div id="conclusion" class="section level2 tabset">
<h2>Conclusion</h2>
<p>Being male and in your late 40 to 60 does increases chance in having cardiovascular disease. Most of the HD patients had a asymptomatic chest pain. Patient with HD have lower max heart rate in Thallium stress test conparatively to non-HD patients. HD patients have higher blood pressure. Except in a few hospitals, the majority of them have shown fasting blood sugar, resting ECG are an insignificant test. Exercise_Induced_Angina gives mixed result hence this test can be avoided as well.<br />
Thalanch, Resting blood pressure , ST Depression Exercise , Slope Peak Exercise ST2 =flat Num_Major_Vessels,Thalassemia6 =‘fixed defect’,Thalassemia7=‘reversible defect’ are significant test. Since these are significant there cost can be reduced to reasonable amount.</p>
</div>
<div id="bibliography" class="section level2 tabset">
<h2>Bibliography</h2>
<ol style="list-style-type: decimal">
<li><p>URL- Notast.netlif, <a href="https://notast.netlify.com/post/explaining-predictions-interpretable-models-logistic-regression/" class="uri">https://notast.netlify.com/post/explaining-predictions-interpretable-models-logistic-regression/</a></p></li>
<li><p>URL- RPubs, <a href="https://rpubs.com/mbbrigitte/heartdisease" class="uri">https://rpubs.com/mbbrigitte/heartdisease</a></p></li>
<li><p>Rai, Sadhana. (2015). Cardiovascular Disease Dataset Exploration Using Hive and R. International Journal of Advanced Research in Computer Science and Software Engineering. Volume 5.</p></li>
</ol>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
