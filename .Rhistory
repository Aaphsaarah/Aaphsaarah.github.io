prob<-  seq(0.4, 0.5, by = 0.01)
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9, sample.type = "one.sample",  approx=FALSE)
y_var<- y_mdd$delta %>% round(3)
x_var<- power.prop.test(p1=0.30, p2=0.35, power = 0.80)
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2)
sample_size <- seq(200, 1000, by = 10)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9, sample.type = "one.sample",  approx=FALSE)
y_var<- y_mdd$delta %>% round(3)
x_var<- power.prop.test(p1=0.30, p2=0.35, power = 0.80)
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment")
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9, sample.type = "one.sample",  approx=FALSE)
y_var<- y_mdd$delta %>% round(3)
x_var<- power.prop.test(p1=0.30, p2=0.35, power = 0.80)
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment")
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,  approx=FALSE)
y_var<- y_mdd$delta %>% round(3)
x_var<- power.prop.test(p1=0.30, p2=0.35, power = 0.80)
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment")
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta %>% round(3)
x_var<- power.prop.test(p1=0.30, p2=0.35, power = 0.80)
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment")
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="two.sample",  approx=FALSE)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta %>% round(3)
x_var<- power.prop.test(p1=0.30, p2=0.35, power = 0.80)
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment")
sample_size <- seq(200, 1000, by = 20)
prob<-  0.35
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta %>% round(3)
x_var<- power.prop.test(p1=0.30, p2=0.35, power = 0.80)
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment")
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta %>% round(3)
x_var<- power.prop.test(p1=0.30, p2=0.35, power = 0.80)
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment")
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta %>% round(3)
x_var<- power.prop.test(p1=0.30, p2=0.35, power = 0.80)
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment", ylim  (0.05, 0.5))
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta %>% round(3)
x_var<- power.prop.test(p1=0.30, p2=0.35, power = 0.80)
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment", ylim(0.05, 0.5))
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
x_var<- power.prop.test(p1=0.30, p2=0.35, power = 0.80)
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment" )
sample_size <- seq(200, 10000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
x_var<- power.prop.test(p1=0.30, p2=0.35, power = 0.80)
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment" )
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
x_var<- power.prop.test(p1=0.30, p2=0.35, power = 0.80)
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment" )
sample_size <- seq(200, 1000, by = 20)
prob<-  0.5
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
x_var<- power.prop.test(p1=0.30, p2=0.35, power = 0.80)
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment" )
line()
sample_size <- seq(200, 1000, by = 20)
prob<-  0.5
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment" )
line(y_var85,  type = "h", lwd=2, col="orange)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.5
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment" )
line(y_var85,  type = "h", lwd=2, col="orange")
sample_size <- seq(200, 1000, by = 20)
prob<-  0.5
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment" )
line(sample_size,y_var85,  type = "h", lwd=2, col="orange")
sample_size <- seq(200, 1000, by = 20)
prob<-  0.5
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
ggplot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment" )+
geom_density(sample_size,y_var85,  type = "h", lwd=2, col="orange")
sample_size <- seq(200, 1000, by = 20)
prob<-  0.5
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
ggplot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment" )
sample_size <- seq(200, 1000, by = 20)
prob<-  0.5
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment" )
curve(sample_size,y_var85,  type = "h", lwd=2, col="orange")
sample_size <- seq(200, 1000, by = 20)
prob<-  0.5
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment" )
curve(sample_size,y_var85,  type = "h", lwd=2, col="orange")
sample_size <- seq(200, 1000, by = 20)
prob<-  0.5
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment" )
plot(sample_size, y_var85, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment" )
sample_size <- seq(200, 1000, by = 20)
prob<-  0.5
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment" )
curve(y_var85, add=TRUE, col=2, lwd=2, from=0, to=6)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment" )
lines(sample_size, y_var85, type='s', col=3, lwd=2)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
y_80 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.80,sample.type="one.sample",  approx=FALSE)
y_var80<- y_80$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment" )
lines(sample_size, y_var85, type='s', col=3, lwd=2)
lines(sample_size, y_var80, type='s', col=5, lwd=2)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
y_80 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.80,sample.type="one.sample",  approx=FALSE)
y_var80<- y_80$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment" )
lines(sample_size, y_var85, type='s', col=3, lwd=2)
lines(sample_size, y_var80, type='s', col=5, lwd=5)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
y_80 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.80,sample.type="one.sample",  approx=FALSE)
y_var80<- y_80$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=2, main = "Plot of minimum detectable response rate for the new treatment" )
lines(sample_size, y_var85, type='s', col=3, lwd=2)
lines(sample_size, y_var80, type='s', col=5, lwd=4)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
y_80 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.80,sample.type="one.sample",  approx=FALSE)
y_var80<- y_80$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=4,col=1, main = "Plot of minimum detectable response rate for the new treatment" )
lines(sample_size, y_var85, type='s', col=3, lwd=4)
lines(sample_size, y_var80, type='s', col=5, lwd=4)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
y_80 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.80,sample.type="one.sample",  approx=FALSE)
y_var80<- y_80$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=4,col= 11, main = "Plot of minimum detectable response rate for the new treatment" )
lines(sample_size, y_var85, type='s', col=3, lwd=4)
lines(sample_size, y_var80, type='s', col=5, lwd=4)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
y_80 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.80,sample.type="one.sample",  approx=FALSE)
y_var80<- y_80$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=4,col= 8, main = "Plot of minimum detectable response rate for the new treatment" )
lines(sample_size, y_var85, type='s', col=3, lwd=4)
lines(sample_size, y_var80, type='s', col=5, lwd=4)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
y_80 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.80,sample.type="one.sample",  approx=FALSE)
y_var80<- y_80$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=4,col= 7, main = "Plot of minimum detectable response rate for the new treatment" )
lines(sample_size, y_var85, type='s', col=3, lwd=4)
lines(sample_size, y_var80, type='s', col=5, lwd=4)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
y_80 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.80,sample.type="one.sample",  approx=FALSE)
y_var80<- y_80$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=4,col= 8, main = "Plot of minimum detectable response rate for the new treatment" )
lines(sample_size, y_var85, type='s', col=3, lwd=4)
lines(sample_size, y_var80, type='s', col=5, lwd=4)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
y_80 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.80,sample.type="one.sample",  approx=FALSE)
y_var80<- y_80$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=4,col= 9, main = "Plot of minimum detectable response rate for the new treatment" )
lines(sample_size, y_var85, type='s', col=3, lwd=4)
lines(sample_size, y_var80, type='s', col=5, lwd=4)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
y_80 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.80,sample.type="one.sample",  approx=FALSE)
y_var80<- y_80$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=4,col= 33, main = "Plot of minimum detectable response rate for the new treatment" )
lines(sample_size, y_var85, type='s', col=3, lwd=4)
lines(sample_size, y_var80, type='s', col=5, lwd=4)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
y_80 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.80,sample.type="one.sample",  approx=FALSE)
y_var80<- y_80$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=4,col= 0, main = "Plot of minimum detectable response rate for the new treatment" )
lines(sample_size, y_var85, type='s', col=3, lwd=4)
lines(sample_size, y_var80, type='s', col=5, lwd=4)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
y_80 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.80,sample.type="one.sample",  approx=FALSE)
y_var80<- y_80$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=4,col= 2, main = "Plot of minimum detectable response rate for the new treatment" )
lines(sample_size, y_var85, type='s', col=3, lwd=4)
lines(sample_size, y_var80, type='s', col=5, lwd=4)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
y_80 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.80,sample.type="one.sample",  approx=FALSE)
y_var80<- y_80$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=4,col= 2, main = "Plot of minimum detectable response rate for the new treatment" )
lines(sample_size, y_var85, type='s', col=3, lwd=4)
lines(sample_size, y_var80, type='s', col=5, lwd=4)
legend("topright", paste0("power = ", c(90%,85%,80%)), lwd=2, col=c(2,3,5)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
y_80 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.80,sample.type="one.sample",  approx=FALSE)
y_var80<- y_80$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=4,col= 2, main = "Plot of minimum detectable response rate for the new treatment" )
lines(sample_size, y_var85, type='s', col=3, lwd=4)
lines(sample_size, y_var80, type='s', col=5, lwd=4)
legend("topright", paste0("power = ", c(90,85,80)), lwd=2, col=c(2,3,5)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
y_80 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.80,sample.type="one.sample",  approx=FALSE)
y_var80<- y_80$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=4,col= 2, main = "Plot of minimum detectable response rate for the new treatment" )
lines(sample_size, y_var85, type='s', col=3, lwd=4)
lines(sample_size, y_var80, type='s', col=5, lwd=4)
legend("topleft", paste0("power = ", c(90,85,80)), lwd=2, col=c(2,3,5)
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
y_80 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.80,sample.type="one.sample",  approx=FALSE)
y_var80<- y_80$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=4,col= 2, main = "Plot of minimum detectable response rate for the new treatment" )
lines(sample_size, y_var85, type='s', col=3, lwd=4)
lines(sample_size, y_var80, type='s', col=5, lwd=4)
legend("topleft", paste0("power = ", c(90,85,80)), lwd=2, col=c(2,3,5))
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
y_80 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.80,sample.type="one.sample",  approx=FALSE)
y_var80<- y_80$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=4,col= 2, main = "Plot of minimum detectable response rate for the new treatment" )
lines(sample_size, y_var85, type='s', col=3, lwd=4)
lines(sample_size, y_var80, type='s', col=5, lwd=4)
legend("topright", paste0("power = ", c(90,85,80)), lwd=2, col=c(2,3,5))
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
library(tidyverse)
library(ggplot2)
library(vcd)
library(devtools)
library(ggmosaic)
library(EnvStats )
#devtools::install_github("haleyjeppson/ggmosaic")
anemia <- read.csv("~/cornell courses/BIOSTATS I/anemia.csv")
#View(anemia)
anemai_df<-  table(anemia)
anemai_df
anemia_p<-  prop.test(x=c(86,89),n=c(215,294),correct=FALSE)
anemia_p
anemia_p$p.value %>% round(3)
#the p-value is 0.022
anemia_p2<-   prop.test(x=c(86,89),n=c(215,294),correct=FALSE, conf.level = 0.99)
anemia_p2
anemia_p2$conf.int %>% round(3)
#confidence interval for 99% is -0.013 , 0.208
power_90<- power.prop.test(p1=0.30, p2=0.40, power = 0.90)
power_90
# The total sample size of 2*476=  952 is required for the trial.
power_80<- power.prop.test(p1=0.30, p2=0.40, power = 0.80)
power_80
# The total sample size of 2*356 = 712 is required to achieve 80% power in the trial.
power_80_new<- power.prop.test(p1=0.30, p2=0.35, power = 0.80)
power_80_new
# The total sample size of 2*1376.3 = 2753 is required for the trial.
sample_size <- seq(200, 1000, by = 20)
prob<-  0.4
y_mdd <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.9,sample.type="one.sample",  approx=FALSE)
y_var<- y_mdd$delta
y_85 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.85,sample.type="one.sample",  approx=FALSE)
y_var85<- y_85$delta
y_80 <- propTestMdd(sample_size, prob, alpha = 0.05, power = 0.80,sample.type="one.sample",  approx=FALSE)
y_var80<- y_80$delta
plot(sample_size, y_var, type='s', ylab="Minimum detectable response rate", xlab="Sample size", lwd=4,col= 2, main = "Plot of minimum detectable response rate for the new treatment" )
lines(sample_size, y_var85, type='s', col=3, lwd=4)
lines(sample_size, y_var80, type='s', col=5, lwd=4)
legend("topright", paste0("power = ", c(90,85,80)), lwd=2, col=c(2,3,5))
hist(propDiffDist, col="lemonchiffon",freq=FALSE, xlab="difference in sample proportions", ylab="density", main="Distribution of Sample Difference in Proportions")
hist(xtest, col="lemonchiffon",freq=FALSE, xlab="difference in sample proportions", ylab="density", main="Distribution of Sample Difference in Proportions")
hist(propDiffDist, col="lemonchiffon",freq=FALSE, xlab="difference in sample proportions", ylab="density", main="Distribution of Sample Difference in Proportions")
hist(propDiffDist, col="lemonchiffon",freq=FALSE, xlab="difference in sample proportions", ylab="density", main="Distribution of Sample Difference in Proportions")
lines(density(propDiffDist), col="midnightblue",lwd=4)
na <- 13
nb <- 10
piA <- 0.30
piB <- 0.7
reps <- 5000
propDiffDist <- replicate(reps, rbinom(1,na,piA)/na - rbinom(1,nb,piB)/nb)
rbinom(n=13,size=1, 0.3)
a <- rbinom(n=10, 1,0.3)
xtest<- replicate(reps, (sum(a)- 3))^2 / 3  )
na <- 13
nb <- 10
piA <- 0.30
piB <- 0.7
reps <- 5000
propDiffDist <- replicate(reps, rbinom(1,na,piA)/na - rbinom(1,nb,piB)/nb)
rbinom(n=13,size=1, 0.3)
a <- rbinom(n=10, 1,0.3)
xtest<- replicate(reps, (sum(a)- 3))^2 / 3)  )
na <- 13
nb <- 10
piA <- 0.30
piB <- 0.7
reps <- 5000
propDiffDist <- replicate(reps, rbinom(1,na,piA)/na - rbinom(1,nb,piB)/nb)
rbinom(n=13,size=1, 0.3)
a <- rbinom(n=10, 1,0.3)
xtest<- replicate(reps, (sum(a)- 3)^2 / 3  )
xtest
na <- 13
nb <- 10
piA <- 0.30
piB <- 0.7
reps <- 5000
propDiffDist <- replicate(reps, rbinom(1,na,piA)/na - rbinom(1,nb,piB)/nb)
rbinom(n=13,size=1, 0.3)
a <- rbinom(n=10, 1,0.3)
xtest<- replicate(reps, (sum(a)- 3)^2 / 3  )
na <- 13
nb <- 10
piA <- 0.30
piB <- 0.7
reps <- 5000
propDiffDist <- replicate(reps, rbinom(1,na,piA)/na - rbinom(1,nb,piB)/nb)
b<- rbinom(n=13,size=1, 0.3)
a <- rbinom(n=10, 1,0.3)
xtest<- replicate(reps, (sum(a)- 3)^2 / 3  )
hist(xtest, col="lemonchiffon",freq=FALSE, xlab="difference in sample proportions", ylab="density", main="Distribution of Sample Difference in Proportions")
lines(density(propDiffDist), col="midnightblue",lwd=4)
hist(propDiffDist, col="lemonchiffon",freq=FALSE, xlab="difference in sample proportions", ylab="density", main="Distribution of Sample Difference in Proportions")
lines(density(propDiffDist), col="midnightblue",lwd=4)
hist(propDiffDist, col="lemonchiffon",freq=FALSE, xlab="difference in sample proportions", ylab="density", main="Distribution of Sample Difference in Proportions")
lines(density(propDiffDist), col="midnightblue",lwd=4)
lines(density(xtest), col="midnightblue",lwd=4)
chisq.test(xtest)
table(xtest)
chisq.test(xtest)
t<- table(xtest)
chisq.test(t)
t<- table(propDiffDist)
chisq.test(t)
fisher.test(t)
t<- table(propDiffDist)
chisq.test(t)
fisher.test(t)
fisher.test(t)
fisher.test(t)
fisher.test(propDiffDist)
fisher.test(t)
apqol <- read.csv("~/cornell courses/BIOSTATS I/apqol.csv")
View(apqol)
apqol_matrix<- table(apqol)
apqol_matrix
apqol_chi <- chisq.test(apqol_matrix)
apqol_chi
# The chi-square statistics value is 18.754 for the apqol data
apqol_chi$statistic %>% round(3)
apqol_chi$p.value  %>% round(3)
## p-value is 0.027
apqol_new <- apqol%>%
rename(Country= "ï..country")
apqol_matrix2<- table(apqol_new)
apqol_df<- data.frame(apqol_matrix2)
apqol_df
mosaicplot(apqol_matrix, shade=TRUE, main="Association between country and T-stage",  xlab= 'Country')
ggplot(data=apqol_df)+
geom_mosaic(aes( weight=Freq, x=product(Country),col=Freq, fill=Tstage)) +
labs(title ="Association between Country and Tumor stage", x = "Country")
apqol_new <- apqol%>%
rename(Country= "ï..country")
apqol_matrix2<- table(apqol_new)
apqol_df<- data.frame(apqol_matrix2)
apqol_df
mosaicplot(apqol_matrix, shade=TRUE, main="Association between country and T-stage",  xlab= 'Country')
ggplot(data=apqol_df)+
geom_mosaic(aes( weight=Freq, x=product(Country),col=Freq, fill=Tstage)) +
labs(title ="Mosaic plot to show the Association between Country and Tumor stage", x = "Country")
apqol_new <- apqol%>%
rename(Country= "ï..country")
apqol_matrix2<- table(apqol_new)
apqol_df<- data.frame(apqol_matrix2)
apqol_df
mosaicplot(apqol_matrix, shade=TRUE, main="Association between country and T-stage",  xlab= 'Country')
ggplot(data=apqol_df)+
geom_mosaic(aes( weight=Freq, x=product(Country),col=Freq, fill=Tstage)) +
labs(title ="Mosaic plot to show the association between Country and Tumor stage", x = "Country")
